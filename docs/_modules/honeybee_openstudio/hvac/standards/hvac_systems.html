<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>honeybee_openstudio.hvac.standards.hvac_systems &#8212; honeybee-openstudio  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=e6365d57" />
    <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<link rel="icon" type="image/x-icon" href="https://github.com/ladybug-tools/artwork/raw/refs/heads/master/icons_bugs/ico/honeybee.ico">
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../index.html">
          honeybee-openstudio</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cli/index.html">CLI Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../cli/index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../cli/index.html#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../cli/translate.html">translate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../cli/translate.html#honeybee-openstudio-translate">honeybee-openstudio translate</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../cli/translate.html#honeybee-openstudio-translate-append-to-osm">append-to-osm</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../cli/translate.html#honeybee-openstudio-translate-model-to-osm">model-to-osm</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../cli/translate.html#honeybee-openstudio-translate-osm-to-idf">osm-to-idf</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../honeybee_openstudio.html">honeybee_openstudio package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../honeybee_openstudio.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.cli.html">honeybee_openstudio.cli package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.cli.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../honeybee_openstudio.cli.translate.html">honeybee_openstudio.cli.translate module</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.cli.translate.html#honeybee_openstudio.cli.translate.append_to_osm"><code class="docutils literal notranslate"><span class="pre">append_to_osm()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.cli.translate.html#honeybee_openstudio.cli.translate.model_to_osm"><code class="docutils literal notranslate"><span class="pre">model_to_osm()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.cli.translate.html#honeybee_openstudio.cli.translate.osm_to_idf"><code class="docutils literal notranslate"><span class="pre">osm_to_idf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.cli.html#module-honeybee_openstudio.cli">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.html">honeybee_openstudio.hvac package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.html#subpackages">Subpackages</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.html">honeybee_openstudio.hvac.standards package</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.html#subpackages">Subpackages</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.data.html">honeybee_openstudio.hvac.standards.data package</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.data.html#module-honeybee_openstudio.hvac.standards.data">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.html#submodules">Submodules</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.air_conditioner_variable_refrigerant_flow.html">honeybee_openstudio.hvac.standards.air_conditioner_variable_refrigerant_flow module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.air_conditioner_variable_refrigerant_flow.html#honeybee_openstudio.hvac.standards.air_conditioner_variable_refrigerant_flow.create_air_conditioner_variable_refrigerant_flow"><code class="docutils literal notranslate"><span class="pre">create_air_conditioner_variable_refrigerant_flow()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.boiler_hot_water.html">honeybee_openstudio.hvac.standards.boiler_hot_water module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.boiler_hot_water.html#honeybee_openstudio.hvac.standards.boiler_hot_water.create_boiler_hot_water"><code class="docutils literal notranslate"><span class="pre">create_boiler_hot_water()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.central_air_source_heat_pump.html">honeybee_openstudio.hvac.standards.central_air_source_heat_pump module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.central_air_source_heat_pump.html#honeybee_openstudio.hvac.standards.central_air_source_heat_pump.create_central_air_source_heat_pump"><code class="docutils literal notranslate"><span class="pre">create_central_air_source_heat_pump()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_cooling.html">honeybee_openstudio.hvac.standards.coil_cooling module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_cooling.html#honeybee_openstudio.hvac.standards.coil_cooling.create_coil_cooling_dx_single_speed"><code class="docutils literal notranslate"><span class="pre">create_coil_cooling_dx_single_speed()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_cooling.html#honeybee_openstudio.hvac.standards.coil_cooling.create_coil_cooling_dx_two_speed"><code class="docutils literal notranslate"><span class="pre">create_coil_cooling_dx_two_speed()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_cooling.html#honeybee_openstudio.hvac.standards.coil_cooling.create_coil_cooling_water"><code class="docutils literal notranslate"><span class="pre">create_coil_cooling_water()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_cooling.html#honeybee_openstudio.hvac.standards.coil_cooling.create_coil_cooling_water_to_air_heat_pump_equation_fit"><code class="docutils literal notranslate"><span class="pre">create_coil_cooling_water_to_air_heat_pump_equation_fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_heating.html">honeybee_openstudio.hvac.standards.coil_heating module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_heating.html#honeybee_openstudio.hvac.standards.coil_heating.create_coil_heating_dx_single_speed"><code class="docutils literal notranslate"><span class="pre">create_coil_heating_dx_single_speed()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_heating.html#honeybee_openstudio.hvac.standards.coil_heating.create_coil_heating_electric"><code class="docutils literal notranslate"><span class="pre">create_coil_heating_electric()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_heating.html#honeybee_openstudio.hvac.standards.coil_heating.create_coil_heating_gas"><code class="docutils literal notranslate"><span class="pre">create_coil_heating_gas()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_heating.html#honeybee_openstudio.hvac.standards.coil_heating.create_coil_heating_water"><code class="docutils literal notranslate"><span class="pre">create_coil_heating_water()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.coil_heating.html#honeybee_openstudio.hvac.standards.coil_heating.create_coil_heating_water_to_air_heat_pump_equation_fit"><code class="docutils literal notranslate"><span class="pre">create_coil_heating_water_to_air_heat_pump_equation_fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.cooling_tower.html">honeybee_openstudio.hvac.standards.cooling_tower module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.cooling_tower.html#honeybee_openstudio.hvac.standards.cooling_tower.prototype_apply_condenser_water_temperatures"><code class="docutils literal notranslate"><span class="pre">prototype_apply_condenser_water_temperatures()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.cooling_tower.html#honeybee_openstudio.hvac.standards.cooling_tower.prototype_condenser_water_temperatures"><code class="docutils literal notranslate"><span class="pre">prototype_condenser_water_temperatures()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html">honeybee_openstudio.hvac.standards.fan module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.create_fan_by_name"><code class="docutils literal notranslate"><span class="pre">create_fan_by_name()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.create_fan_constant_volume_from_json"><code class="docutils literal notranslate"><span class="pre">create_fan_constant_volume_from_json()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.create_fan_on_off_from_json"><code class="docutils literal notranslate"><span class="pre">create_fan_on_off_from_json()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.create_fan_variable_volume_from_json"><code class="docutils literal notranslate"><span class="pre">create_fan_variable_volume_from_json()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.create_fan_zone_exhaust_from_json"><code class="docutils literal notranslate"><span class="pre">create_fan_zone_exhaust_from_json()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.fan_baseline_impeller_efficiency"><code class="docutils literal notranslate"><span class="pre">fan_baseline_impeller_efficiency()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.fan_change_impeller_efficiency"><code class="docutils literal notranslate"><span class="pre">fan_change_impeller_efficiency()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.fan.html#honeybee_openstudio.hvac.standards.fan.is_small_fan"><code class="docutils literal notranslate"><span class="pre">is_small_fan()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.heat_recovery.html">honeybee_openstudio.hvac.standards.heat_recovery module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.heat_recovery.html#honeybee_openstudio.hvac.standards.heat_recovery.create_hx_air_to_air_sensible_and_latent"><code class="docutils literal notranslate"><span class="pre">create_hx_air_to_air_sensible_and_latent()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html">honeybee_openstudio.hvac.standards.hvac_systems module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_baseboard"><code class="docutils literal notranslate"><span class="pre">model_add_baseboard()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_central_air_source_heat_pump"><code class="docutils literal notranslate"><span class="pre">model_add_central_air_source_heat_pump()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_chw_loop"><code class="docutils literal notranslate"><span class="pre">model_add_chw_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_cw_loop"><code class="docutils literal notranslate"><span class="pre">model_add_cw_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_district_ambient_loop"><code class="docutils literal notranslate"><span class="pre">model_add_district_ambient_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_doas"><code class="docutils literal notranslate"><span class="pre">model_add_doas()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_doas_cold_supply"><code class="docutils literal notranslate"><span class="pre">model_add_doas_cold_supply()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_evap_cooler"><code class="docutils literal notranslate"><span class="pre">model_add_evap_cooler()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_four_pipe_fan_coil"><code class="docutils literal notranslate"><span class="pre">model_add_four_pipe_fan_coil()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_furnace_central_ac"><code class="docutils literal notranslate"><span class="pre">model_add_furnace_central_ac()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_ground_hx_loop"><code class="docutils literal notranslate"><span class="pre">model_add_ground_hx_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_high_temp_radiant"><code class="docutils literal notranslate"><span class="pre">model_add_high_temp_radiant()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_hp_loop"><code class="docutils literal notranslate"><span class="pre">model_add_hp_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_hvac_system"><code class="docutils literal notranslate"><span class="pre">model_add_hvac_system()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_hw_loop"><code class="docutils literal notranslate"><span class="pre">model_add_hw_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_low_temp_radiant"><code class="docutils literal notranslate"><span class="pre">model_add_low_temp_radiant()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_minisplit_hp"><code class="docutils literal notranslate"><span class="pre">model_add_minisplit_hp()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_plant_supply_water_temperature_control"><code class="docutils literal notranslate"><span class="pre">model_add_plant_supply_water_temperature_control()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_psz_ac"><code class="docutils literal notranslate"><span class="pre">model_add_psz_ac()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_psz_vav"><code class="docutils literal notranslate"><span class="pre">model_add_psz_vav()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_ptac"><code class="docutils literal notranslate"><span class="pre">model_add_ptac()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_pthp"><code class="docutils literal notranslate"><span class="pre">model_add_pthp()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_pvav"><code class="docutils literal notranslate"><span class="pre">model_add_pvav()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_pvav_pfp_boxes"><code class="docutils literal notranslate"><span class="pre">model_add_pvav_pfp_boxes()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_residential_erv"><code class="docutils literal notranslate"><span class="pre">model_add_residential_erv()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_residential_ventilator"><code class="docutils literal notranslate"><span class="pre">model_add_residential_ventilator()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_unitheater"><code class="docutils literal notranslate"><span class="pre">model_add_unitheater()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vav_pfp_boxes"><code class="docutils literal notranslate"><span class="pre">model_add_vav_pfp_boxes()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vav_reheat"><code class="docutils literal notranslate"><span class="pre">model_add_vav_reheat()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vrf"><code class="docutils literal notranslate"><span class="pre">model_add_vrf()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vsd_twr_fan_curve"><code class="docutils literal notranslate"><span class="pre">model_add_vsd_twr_fan_curve()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_water_source_hp"><code class="docutils literal notranslate"><span class="pre">model_add_water_source_hp()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_waterside_economizer"><code class="docutils literal notranslate"><span class="pre">model_add_waterside_economizer()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_window_ac"><code class="docutils literal notranslate"><span class="pre">model_add_window_ac()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_zone_erv"><code class="docutils literal notranslate"><span class="pre">model_add_zone_erv()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_zone_heat_cool_request_count_program"><code class="docutils literal notranslate"><span class="pre">model_add_zone_heat_cool_request_count_program()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_ambient_water_loop"><code class="docutils literal notranslate"><span class="pre">model_get_or_add_ambient_water_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_chilled_water_loop"><code class="docutils literal notranslate"><span class="pre">model_get_or_add_chilled_water_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_ground_hx_loop"><code class="docutils literal notranslate"><span class="pre">model_get_or_add_ground_hx_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_heat_pump_loop"><code class="docutils literal notranslate"><span class="pre">model_get_or_add_heat_pump_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_hot_water_loop"><code class="docutils literal notranslate"><span class="pre">model_get_or_add_hot_water_loop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.standard_design_sizing_temperatures"><code class="docutils literal notranslate"><span class="pre">standard_design_sizing_temperatures()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.plant_loop.html">honeybee_openstudio.hvac.standards.plant_loop module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.plant_loop.html#honeybee_openstudio.hvac.standards.plant_loop.chw_sizing_control"><code class="docutils literal notranslate"><span class="pre">chw_sizing_control()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.plant_loop.html#honeybee_openstudio.hvac.standards.plant_loop.plant_loop_set_chw_pri_sec_configuration"><code class="docutils literal notranslate"><span class="pre">plant_loop_set_chw_pri_sec_configuration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.pump_variable_speed.html">honeybee_openstudio.hvac.standards.pump_variable_speed module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.pump_variable_speed.html#honeybee_openstudio.hvac.standards.pump_variable_speed.pump_variable_speed_set_control_type"><code class="docutils literal notranslate"><span class="pre">pump_variable_speed_set_control_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.radiant_system_controls.html">honeybee_openstudio.hvac.standards.radiant_system_controls module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.radiant_system_controls.html#honeybee_openstudio.hvac.standards.radiant_system_controls.model_add_radiant_basic_controls"><code class="docutils literal notranslate"><span class="pre">model_add_radiant_basic_controls()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.radiant_system_controls.html#honeybee_openstudio.hvac.standards.radiant_system_controls.model_add_radiant_proportional_controls"><code class="docutils literal notranslate"><span class="pre">model_add_radiant_proportional_controls()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.schedule.html">honeybee_openstudio.hvac.standards.schedule module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.schedule.html#honeybee_openstudio.hvac.standards.schedule.create_constant_schedule_ruleset"><code class="docutils literal notranslate"><span class="pre">create_constant_schedule_ruleset()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.schedule.html#honeybee_openstudio.hvac.standards.schedule.create_schedule_type_limits"><code class="docutils literal notranslate"><span class="pre">create_schedule_type_limits()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.schedule.html#honeybee_openstudio.hvac.standards.schedule.model_add_schedule"><code class="docutils literal notranslate"><span class="pre">model_add_schedule()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.sizing_system.html">honeybee_openstudio.hvac.standards.sizing_system module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.sizing_system.html#honeybee_openstudio.hvac.standards.sizing_system.adjust_sizing_system"><code class="docutils literal notranslate"><span class="pre">adjust_sizing_system()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.thermal_zone.html">honeybee_openstudio.hvac.standards.thermal_zone module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.thermal_zone.html#honeybee_openstudio.hvac.standards.thermal_zone.thermal_zone_get_occupancy_schedule"><code class="docutils literal notranslate"><span class="pre">thermal_zone_get_occupancy_schedule()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.thermal_zone.html#honeybee_openstudio.hvac.standards.thermal_zone.thermal_zone_get_outdoor_airflow_rate"><code class="docutils literal notranslate"><span class="pre">thermal_zone_get_outdoor_airflow_rate()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.thermal_zone.html#honeybee_openstudio.hvac.standards.thermal_zone.thermal_zone_get_outdoor_airflow_rate_per_area"><code class="docutils literal notranslate"><span class="pre">thermal_zone_get_outdoor_airflow_rate_per_area()</span></code></a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html">honeybee_openstudio.hvac.standards.utilities module</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.convert_curve_biquadratic"><code class="docutils literal notranslate"><span class="pre">convert_curve_biquadratic()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.create_curve_biquadratic"><code class="docutils literal notranslate"><span class="pre">create_curve_biquadratic()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.create_curve_quadratic"><code class="docutils literal notranslate"><span class="pre">create_curve_quadratic()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.eer_to_cop_no_fan"><code class="docutils literal notranslate"><span class="pre">eer_to_cop_no_fan()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.ems_friendly_name"><code class="docutils literal notranslate"><span class="pre">ems_friendly_name()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.hspf_to_cop_no_fan"><code class="docutils literal notranslate"><span class="pre">hspf_to_cop_no_fan()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.kw_per_ton_to_cop"><code class="docutils literal notranslate"><span class="pre">kw_per_ton_to_cop()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.rename_air_loop_nodes"><code class="docutils literal notranslate"><span class="pre">rename_air_loop_nodes()</span></code></a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.utilities.html#honeybee_openstudio.hvac.standards.utilities.rename_plant_loop_nodes"><code class="docutils literal notranslate"><span class="pre">rename_plant_loop_nodes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.standards.html#module-honeybee_openstudio.hvac.standards">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.idealair.html">honeybee_openstudio.hvac.idealair module</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.idealair.html#honeybee_openstudio.hvac.idealair.ideal_air_system_from_openstudio"><code class="docutils literal notranslate"><span class="pre">ideal_air_system_from_openstudio()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.idealair.html#honeybee_openstudio.hvac.idealair.ideal_air_system_to_openstudio"><code class="docutils literal notranslate"><span class="pre">ideal_air_system_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.template.html">honeybee_openstudio.hvac.template module</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.template.html#honeybee_openstudio.hvac.template.template_hvac_to_openstudio"><code class="docutils literal notranslate"><span class="pre">template_hvac_to_openstudio()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.hvac.html#module-honeybee_openstudio.hvac">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../honeybee_openstudio.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html">honeybee_openstudio.construction module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.air_construction_from_openstudio"><code class="docutils literal notranslate"><span class="pre">air_construction_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.air_construction_to_openstudio"><code class="docutils literal notranslate"><span class="pre">air_construction_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.air_mixing_to_openstudio"><code class="docutils literal notranslate"><span class="pre">air_mixing_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.construction_to_openstudio"><code class="docutils literal notranslate"><span class="pre">construction_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.extract_all_constructions"><code class="docutils literal notranslate"><span class="pre">extract_all_constructions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.opaque_construction_from_openstudio"><code class="docutils literal notranslate"><span class="pre">opaque_construction_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.shade_construction_from_openstudio"><code class="docutils literal notranslate"><span class="pre">shade_construction_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.shade_construction_to_openstudio"><code class="docutils literal notranslate"><span class="pre">shade_construction_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.standard_construction_to_openstudio"><code class="docutils literal notranslate"><span class="pre">standard_construction_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.window_construction_from_openstudio"><code class="docutils literal notranslate"><span class="pre">window_construction_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.window_dynamic_construction_to_openstudio"><code class="docutils literal notranslate"><span class="pre">window_dynamic_construction_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.window_dynamic_ems_program_to_openstudio"><code class="docutils literal notranslate"><span class="pre">window_dynamic_ems_program_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.window_shade_construction_to_openstudio"><code class="docutils literal notranslate"><span class="pre">window_shade_construction_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.construction.html#honeybee_openstudio.construction.window_shading_control_to_openstudio"><code class="docutils literal notranslate"><span class="pre">window_shading_control_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.constructionset.html">honeybee_openstudio.constructionset module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.constructionset.html#honeybee_openstudio.constructionset.construction_set_from_openstudio"><code class="docutils literal notranslate"><span class="pre">construction_set_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.constructionset.html#honeybee_openstudio.constructionset.construction_set_to_openstudio"><code class="docutils literal notranslate"><span class="pre">construction_set_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.generator.html">honeybee_openstudio.generator module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.generator.html#honeybee_openstudio.generator.electric_load_center_to_openstudio"><code class="docutils literal notranslate"><span class="pre">electric_load_center_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.generator.html#honeybee_openstudio.generator.pv_properties_to_openstudio"><code class="docutils literal notranslate"><span class="pre">pv_properties_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.internalmass.html">honeybee_openstudio.internalmass module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.internalmass.html#honeybee_openstudio.internalmass.internal_mass_to_openstudio"><code class="docutils literal notranslate"><span class="pre">internal_mass_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.load.html">honeybee_openstudio.load module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.daylight_from_openstudio"><code class="docutils literal notranslate"><span class="pre">daylight_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.daylight_to_openstudio"><code class="docutils literal notranslate"><span class="pre">daylight_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.electric_equipment_from_openstudio"><code class="docutils literal notranslate"><span class="pre">electric_equipment_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.electric_equipment_to_openstudio"><code class="docutils literal notranslate"><span class="pre">electric_equipment_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.gas_equipment_from_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_equipment_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.gas_equipment_to_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_equipment_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.hot_water_from_openstudio"><code class="docutils literal notranslate"><span class="pre">hot_water_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.hot_water_to_openstudio"><code class="docutils literal notranslate"><span class="pre">hot_water_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.infiltration_from_openstudio"><code class="docutils literal notranslate"><span class="pre">infiltration_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.infiltration_to_openstudio"><code class="docutils literal notranslate"><span class="pre">infiltration_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.lighting_from_openstudio"><code class="docutils literal notranslate"><span class="pre">lighting_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.lighting_to_openstudio"><code class="docutils literal notranslate"><span class="pre">lighting_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.people_from_openstudio"><code class="docutils literal notranslate"><span class="pre">people_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.people_to_openstudio"><code class="docutils literal notranslate"><span class="pre">people_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.process_from_openstudio"><code class="docutils literal notranslate"><span class="pre">process_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.process_to_openstudio"><code class="docutils literal notranslate"><span class="pre">process_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.setpoint_from_openstudio_humidistat"><code class="docutils literal notranslate"><span class="pre">setpoint_from_openstudio_humidistat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.setpoint_from_openstudio_thermostat"><code class="docutils literal notranslate"><span class="pre">setpoint_from_openstudio_thermostat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.setpoint_to_openstudio_humidistat"><code class="docutils literal notranslate"><span class="pre">setpoint_to_openstudio_humidistat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.setpoint_to_openstudio_thermostat"><code class="docutils literal notranslate"><span class="pre">setpoint_to_openstudio_thermostat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.ventilation_from_openstudio"><code class="docutils literal notranslate"><span class="pre">ventilation_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.load.html#honeybee_openstudio.load.ventilation_to_openstudio"><code class="docutils literal notranslate"><span class="pre">ventilation_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.material.html">honeybee_openstudio.material module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.blind_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">blind_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.blind_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">blind_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.extract_all_materials"><code class="docutils literal notranslate"><span class="pre">extract_all_materials()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.frame_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">frame_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.gas_custom_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_custom_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.gas_custom_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_custom_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.gas_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.gas_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.gas_mixture_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_mixture_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.gas_mixture_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">gas_mixture_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.glazing_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">glazing_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.glazing_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">glazing_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.opaque_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">opaque_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.opaque_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">opaque_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.opaque_no_mass_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">opaque_no_mass_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.opaque_no_mass_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">opaque_no_mass_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.shade_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">shade_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.shade_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">shade_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.simple_glazing_sys_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">simple_glazing_sys_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.simple_glazing_sys_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">simple_glazing_sys_material_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.vegetation_material_from_openstudio"><code class="docutils literal notranslate"><span class="pre">vegetation_material_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.material.html#honeybee_openstudio.material.vegetation_material_to_openstudio"><code class="docutils literal notranslate"><span class="pre">vegetation_material_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.openstudio.html">honeybee_openstudio.openstudio module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.openstudio.html#honeybee_openstudio.openstudio.os_create_vector"><code class="docutils literal notranslate"><span class="pre">os_create_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.openstudio.html#honeybee_openstudio.openstudio.os_path"><code class="docutils literal notranslate"><span class="pre">os_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.openstudio.html#honeybee_openstudio.openstudio.os_vector_len"><code class="docutils literal notranslate"><span class="pre">os_vector_len()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.programtype.html">honeybee_openstudio.programtype module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.programtype.html#honeybee_openstudio.programtype.program_type_from_openstudio"><code class="docutils literal notranslate"><span class="pre">program_type_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.programtype.html#honeybee_openstudio.programtype.program_type_to_openstudio"><code class="docutils literal notranslate"><span class="pre">program_type_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html">honeybee_openstudio.reader module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.aperture_from_openstudio"><code class="docutils literal notranslate"><span class="pre">aperture_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.door_from_openstudio"><code class="docutils literal notranslate"><span class="pre">door_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.face_3d_from_openstudio"><code class="docutils literal notranslate"><span class="pre">face_3d_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.face_from_openstudio"><code class="docutils literal notranslate"><span class="pre">face_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.model_from_gbxml_file"><code class="docutils literal notranslate"><span class="pre">model_from_gbxml_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.model_from_idf_file"><code class="docutils literal notranslate"><span class="pre">model_from_idf_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.model_from_openstudio"><code class="docutils literal notranslate"><span class="pre">model_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.model_from_osm"><code class="docutils literal notranslate"><span class="pre">model_from_osm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.model_from_osm_file"><code class="docutils literal notranslate"><span class="pre">model_from_osm_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.room_from_openstudio"><code class="docutils literal notranslate"><span class="pre">room_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.reader.html#honeybee_openstudio.reader.shades_from_openstudio"><code class="docutils literal notranslate"><span class="pre">shades_from_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html">honeybee_openstudio.schedule module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.extract_all_schedules"><code class="docutils literal notranslate"><span class="pre">extract_all_schedules()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_day_from_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_day_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_day_to_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_day_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_fixed_interval_from_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_fixed_interval_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_fixed_interval_to_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_fixed_interval_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_fixed_interval_to_openstudio_file"><code class="docutils literal notranslate"><span class="pre">schedule_fixed_interval_to_openstudio_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_ruleset_from_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_ruleset_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_ruleset_to_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_ruleset_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_to_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_type_limits_from_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_type_limits_from_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.schedule.html#honeybee_openstudio.schedule.schedule_type_limits_to_openstudio"><code class="docutils literal notranslate"><span class="pre">schedule_type_limits_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.shw.html">honeybee_openstudio.shw module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.shw.html#honeybee_openstudio.shw.shw_system_to_openstudio"><code class="docutils literal notranslate"><span class="pre">shw_system_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html">honeybee_openstudio.simulation module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.assign_epw_to_model"><code class="docutils literal notranslate"><span class="pre">assign_epw_to_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.design_day_to_openstudio"><code class="docutils literal notranslate"><span class="pre">design_day_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.run_period_to_openstudio"><code class="docutils literal notranslate"><span class="pre">run_period_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.shadow_calculation_to_openstudio"><code class="docutils literal notranslate"><span class="pre">shadow_calculation_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.simulation_control_to_openstudio"><code class="docutils literal notranslate"><span class="pre">simulation_control_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.simulation_output_to_openstudio"><code class="docutils literal notranslate"><span class="pre">simulation_output_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.simulation_parameter_to_openstudio"><code class="docutils literal notranslate"><span class="pre">simulation_parameter_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.simulation.html#honeybee_openstudio.simulation.sizing_to_openstudio"><code class="docutils literal notranslate"><span class="pre">sizing_to_openstudio()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html">honeybee_openstudio.ventcool module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.afn_crack_to_openstudio"><code class="docutils literal notranslate"><span class="pre">afn_crack_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.outdoor_temperature_sensor"><code class="docutils literal notranslate"><span class="pre">outdoor_temperature_sensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.ventilation_control_program_manager"><code class="docutils literal notranslate"><span class="pre">ventilation_control_program_manager()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.ventilation_control_to_openstudio_afn"><code class="docutils literal notranslate"><span class="pre">ventilation_control_to_openstudio_afn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.ventilation_fan_to_openstudio"><code class="docutils literal notranslate"><span class="pre">ventilation_fan_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.ventilation_opening_to_openstudio"><code class="docutils literal notranslate"><span class="pre">ventilation_opening_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.ventilation_opening_to_openstudio_afn"><code class="docutils literal notranslate"><span class="pre">ventilation_opening_to_openstudio_afn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.ventilation_sim_control_to_openstudio"><code class="docutils literal notranslate"><span class="pre">ventilation_sim_control_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.ventcool.html#honeybee_openstudio.ventcool.zone_temperature_sensor"><code class="docutils literal notranslate"><span class="pre">zone_temperature_sensor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html">honeybee_openstudio.writer module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.aperture_to_openstudio"><code class="docutils literal notranslate"><span class="pre">aperture_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.door_to_openstudio"><code class="docutils literal notranslate"><span class="pre">door_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.face_3d_to_openstudio"><code class="docutils literal notranslate"><span class="pre">face_3d_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.face_to_openstudio"><code class="docutils literal notranslate"><span class="pre">face_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.model_to_gbxml"><code class="docutils literal notranslate"><span class="pre">model_to_gbxml()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.model_to_idf"><code class="docutils literal notranslate"><span class="pre">model_to_idf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.model_to_openstudio"><code class="docutils literal notranslate"><span class="pre">model_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.model_to_osm"><code class="docutils literal notranslate"><span class="pre">model_to_osm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.room_to_openstudio"><code class="docutils literal notranslate"><span class="pre">room_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.shade_mesh_to_openstudio"><code class="docutils literal notranslate"><span class="pre">shade_mesh_to_openstudio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../honeybee_openstudio.writer.html#honeybee_openstudio.writer.shade_to_openstudio"><code class="docutils literal notranslate"><span class="pre">shade_to_openstudio()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../honeybee_openstudio.html#module-honeybee_openstudio">Module contents</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cli/index.html">CLI Docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../honeybee_openstudio.html">honeybee_openstudio package</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-4">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cli/index.html">CLI Docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../honeybee_openstudio.html">honeybee_openstudio package</a></li>
</ul>

        </div>
      </div>
    <div class="body col-md-8 content" role="main">
      
  <h1>Source code for honeybee_openstudio.hvac.standards.hvac_systems</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding=utf-8</span>
<span class="sd">&quot;&quot;&quot;Module taken from OpenStudio-standards.</span>

<span class="sd">https://github.com/NREL/openstudio-standards/blob/master/</span>
<span class="sd">lib/openstudio-standards/prototypes/common/objects/Prototype.hvac_systems.rb</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ladybug.datatype.temperature</span><span class="w"> </span><span class="kn">import</span> <span class="n">Temperature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ladybug.datatype.temperaturedelta</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemperatureDelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ladybug.datatype.pressure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pressure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ladybug.datatype.volumeflowrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">VolumeFlowRate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ladybug.datatype.power</span><span class="w"> </span><span class="kn">import</span> <span class="n">Power</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ladybug.datatype.distance</span><span class="w"> </span><span class="kn">import</span> <span class="n">Distance</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">honeybee_openstudio.openstudio</span><span class="w"> </span><span class="kn">import</span> <span class="n">openstudio</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="p">,</span> \
    <span class="n">os_vector_len</span><span class="p">,</span> <span class="n">os_create_vector</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">kw_per_ton_to_cop</span><span class="p">,</span> <span class="n">eer_to_cop_no_fan</span><span class="p">,</span> <span class="n">hspf_to_cop_no_fan</span><span class="p">,</span> \
    <span class="n">ems_friendly_name</span><span class="p">,</span> <span class="n">rename_plant_loop_nodes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.schedule</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">,</span> <span class="n">model_add_schedule</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.thermal_zone</span><span class="w"> </span><span class="kn">import</span> <span class="n">thermal_zone_get_outdoor_airflow_rate</span><span class="p">,</span> \
    <span class="n">thermal_zone_get_outdoor_airflow_rate_per_area</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.central_air_source_heat_pump</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_central_air_source_heat_pump</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.boiler_hot_water</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_boiler_hot_water</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.plant_loop</span><span class="w"> </span><span class="kn">import</span> <span class="n">chw_sizing_control</span><span class="p">,</span> <span class="n">plant_loop_set_chw_pri_sec_configuration</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.pump_variable_speed</span><span class="w"> </span><span class="kn">import</span> <span class="n">pump_variable_speed_set_control_type</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.cooling_tower</span><span class="w"> </span><span class="kn">import</span> <span class="n">prototype_apply_condenser_water_temperatures</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.fan</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_fan_by_name</span><span class="p">,</span> <span class="n">fan_change_impeller_efficiency</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.coil_heating</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_coil_heating_electric</span><span class="p">,</span> <span class="n">create_coil_heating_gas</span><span class="p">,</span> \
    <span class="n">create_coil_heating_water</span><span class="p">,</span> <span class="n">create_coil_heating_dx_single_speed</span><span class="p">,</span> \
    <span class="n">create_coil_heating_water_to_air_heat_pump_equation_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.coil_cooling</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_coil_cooling_water</span><span class="p">,</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">,</span> \
    <span class="n">create_coil_cooling_water_to_air_heat_pump_equation_fit</span><span class="p">,</span> \
    <span class="n">create_coil_cooling_dx_two_speed</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.heat_recovery</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_hx_air_to_air_sensible_and_latent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.sizing_system</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjust_sizing_system</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.air_conditioner_variable_refrigerant_flow</span><span class="w"> </span><span class="kn">import</span> \
    <span class="n">create_air_conditioner_variable_refrigerant_flow</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.radiant_system_controls</span><span class="w"> </span><span class="kn">import</span> <span class="n">model_add_radiant_proportional_controls</span><span class="p">,</span> \
    <span class="n">model_add_radiant_basic_controls</span>

<span class="n">TEMPERATURE</span> <span class="o">=</span> <span class="n">Temperature</span><span class="p">()</span>
<span class="n">TEMP_DELTA</span> <span class="o">=</span> <span class="n">TemperatureDelta</span><span class="p">()</span>
<span class="n">PRESSURE</span> <span class="o">=</span> <span class="n">Pressure</span><span class="p">()</span>
<span class="n">FLOW_RATE</span> <span class="o">=</span> <span class="n">VolumeFlowRate</span><span class="p">()</span>
<span class="n">POWER</span> <span class="o">=</span> <span class="n">Power</span><span class="p">()</span>
<span class="n">DISTANCE</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">()</span>


<div class="viewcode-block" id="standard_design_sizing_temperatures">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.standard_design_sizing_temperatures">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">standard_design_sizing_temperatures</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a dictionary of design sizing temperatures for lookups.&quot;&quot;&quot;</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;prehtg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">45.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;preclg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">55.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">55.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">55.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">104.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">55.0</span>
    <span class="n">dsgn_temps_c</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dsgn_temps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">dsgn_temps_c</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_c&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])]</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">val</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dsgn_temps_c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dsgn_temps</span></div>



<div class="viewcode-block" id="model_add_hw_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_hw_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_hw_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">boiler_fuel_type</span><span class="p">,</span> <span class="n">ambient_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;Hot Water Loop&#39;</span><span class="p">,</span>
        <span class="n">dsgn_sup_wtr_temp</span><span class="o">=</span><span class="mf">180.0</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_delt</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">pump_spd_ctrl</span><span class="o">=</span><span class="s1">&#39;Variable&#39;</span><span class="p">,</span>
        <span class="n">pump_tot_hd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boiler_draft_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boiler_eff_curve_temp_eval_var</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">boiler_lvg_temp_dsgn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boiler_out_temp_lmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">boiler_max_plr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boiler_sizing_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a hot water loop with a boiler, district heat, or water-to-water heat pump.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object</span>
<span class="sd">        boiler_fuel_type: [String] valid choices are Electricity, NaturalGas,</span>
<span class="sd">            Propane, PropaneGas, FuelOilNo1, FuelOilNo2, DistrictHeating,</span>
<span class="sd">            DistrictHeatingWater, DistrictHeatingSteam, HeatPump</span>
<span class="sd">        ambient_loop: [OpenStudio::Model::PlantLoop] The condenser loop for the</span>
<span class="sd">            heat pump. Only used when boiler_fuel_type is HeatPump.</span>
<span class="sd">        system_name: [String] the name of the system. If None, it will be defaulted.</span>
<span class="sd">        dsgn_sup_wtr_temp: [Double] design supply water temperature in degrees</span>
<span class="sd">            Fahrenheit, default 180F.</span>
<span class="sd">        dsgn_sup_wtr_temp_delt: [Double] design supply-return water temperature</span>
<span class="sd">            difference in degrees Rankine, default 20R.</span>
<span class="sd">        pump_spd_ctrl: [String] pump speed control type, Constant or Variable (default).</span>
<span class="sd">        pump_tot_hd: [Double] pump head in ft H2O.</span>
<span class="sd">        boiler_draft_type: [String] Boiler type Condensing, MechanicalNoncondensing,</span>
<span class="sd">            Natural (default).</span>
<span class="sd">        boiler_eff_curve_temp_eval_var: [String] LeavingBoiler or EnteringBoiler</span>
<span class="sd">            temperature for the boiler efficiency curve.</span>
<span class="sd">        boiler_lvg_temp_dsgn: [Double] boiler leaving design temperature in</span>
<span class="sd">            degrees Fahrenheit.</span>
<span class="sd">        boiler_out_temp_lmt: [Double] boiler outlet temperature limit in</span>
<span class="sd">            degrees Fahrenheit.</span>
<span class="sd">        boiler_max_plr: [Double] boiler maximum part load ratio.</span>
<span class="sd">        boiler_sizing_factor: [Double] boiler oversizing factor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::PlantLoop] the resulting hot water loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create hot water loop</span>
    <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Hot Water Loop&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>

    <span class="c1"># hot water loop sizing and controls</span>
    <span class="n">dsgn_sup_wtr_temp</span> <span class="o">=</span> <span class="mf">180.0</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp</span>
    <span class="n">dsgn_sup_wtr_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_sup_wtr_temp_delt</span> <span class="o">=</span> <span class="mf">20.0</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp_delt</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp_delt</span>
    <span class="n">dsgn_sup_wtr_temp_delt_k</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp_delt</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">sizing_plant</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopType</span><span class="p">(</span><span class="s1">&#39;Heating&#39;</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_delt_k</span><span class="p">)</span>
    <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">setMinimumLoopTemperature</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">hw_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_c</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp</span><span class="p">)),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">hw_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hw_temp_sch</span><span class="p">)</span>
    <span class="n">hw_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Setpoint Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">hw_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create hot water pump</span>
    <span class="k">if</span> <span class="n">pump_spd_ctrl</span> <span class="o">==</span> <span class="s1">&#39;Constant&#39;</span><span class="p">:</span>
        <span class="n">hw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pump_spd_ctrl</span> <span class="o">==</span> <span class="s1">&#39;Variable&#39;</span><span class="p">:</span>
        <span class="n">hw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">hw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">pump_tot_hd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pump_tot_hd_pa</span> <span class="o">=</span> <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pump_tot_hd_pa</span> <span class="o">=</span> <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">pump_tot_hd</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">pump_tot_hd_pa</span><span class="p">)</span>
    <span class="n">hw_pump</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="n">hw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
    <span class="n">hw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># switch statement to handle district heating name change</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.7.0&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boiler_fuel_type</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span> <span class="ow">or</span> \
                <span class="n">boiler_fuel_type</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">:</span>
            <span class="n">boiler_fuel_type</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">boiler_fuel_type</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">:</span>
            <span class="n">boiler_fuel_type</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span>

    <span class="c1"># create boiler and add to loop</span>
    <span class="c1"># District Heating</span>
    <span class="k">if</span> <span class="n">boiler_fuel_type</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">:</span>
        <span class="n">district_heat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeating</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">district_heat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
        <span class="n">district_heat</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">district_heat</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">boiler_fuel_type</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">:</span>
        <span class="n">district_heat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeatingWater</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">district_heat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
        <span class="n">district_heat</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">district_heat</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">boiler_fuel_type</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">:</span>
        <span class="n">district_heat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeatingSteam</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">district_heat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
        <span class="n">district_heat</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">district_heat</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">boiler_fuel_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;HeatPump&#39;</span><span class="p">,</span> <span class="s1">&#39;AmbientLoop&#39;</span><span class="p">):</span>
        <span class="c1"># Ambient Loop</span>
        <span class="n">water_to_water_hp</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">HeatPumpWaterToWaterEquationFitHeating</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">water_to_water_hp</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water to Water Heat Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">water_to_water_hp</span><span class="p">)</span>
        <span class="c1"># Get or add an ambient loop</span>
        <span class="k">if</span> <span class="n">ambient_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ambient_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_ambient_water_loop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">ambient_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">water_to_water_hp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">boiler_fuel_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">,</span> <span class="s1">&#39;ASHP&#39;</span><span class="p">):</span>
        <span class="c1"># Central Air Source Heat Pump</span>
        <span class="n">create_central_air_source_heat_pump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">boiler_fuel_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Propane&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;PropaneGas&#39;</span><span class="p">,</span> <span class="s1">&#39;FuelOilNo1&#39;</span><span class="p">,</span> <span class="s1">&#39;FuelOilNo2&#39;</span><span class="p">):</span>
        <span class="c1"># Boiler</span>
        <span class="n">lvg_temp_dsgn_f</span> <span class="o">=</span> <span class="n">dsgn_sup_wtr_temp</span> <span class="k">if</span> <span class="n">boiler_lvg_temp_dsgn</span> <span class="ow">is</span> <span class="kc">None</span> \
            <span class="k">else</span> <span class="n">boiler_lvg_temp_dsgn</span>
        <span class="n">out_temp_lmt_f</span> <span class="o">=</span> <span class="mf">203.0</span> <span class="k">if</span> <span class="n">boiler_out_temp_lmt</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">boiler_out_temp_lmt</span>
        <span class="n">create_boiler_hot_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">fuel_type</span><span class="o">=</span><span class="n">boiler_fuel_type</span><span class="p">,</span>
            <span class="n">draft_type</span><span class="o">=</span><span class="n">boiler_draft_type</span><span class="p">,</span> <span class="n">nominal_thermal_efficiency</span><span class="o">=</span><span class="mf">0.78</span><span class="p">,</span>
            <span class="n">eff_curve_temp_eval_var</span><span class="o">=</span><span class="n">boiler_eff_curve_temp_eval_var</span><span class="p">,</span>
            <span class="n">lvg_temp_dsgn_f</span><span class="o">=</span><span class="n">lvg_temp_dsgn_f</span><span class="p">,</span> <span class="n">out_temp_lmt_f</span><span class="o">=</span><span class="n">out_temp_lmt_f</span><span class="p">,</span>
            <span class="n">max_plr</span><span class="o">=</span><span class="n">boiler_max_plr</span><span class="p">,</span> <span class="n">sizing_factor</span><span class="o">=</span><span class="n">boiler_sizing_factor</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Boiler fuel type </span><span class="si">{}</span><span class="s1"> is not valid, no boiler will be added.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">boiler_fuel_type</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># add hot water loop pipes</span>
    <span class="n">supply_equipment_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_equipment_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
        <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Equipment Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">supply_equipment_bypass_pipe</span><span class="p">)</span>

    <span class="n">coil_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">coil_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Coil Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">coil_bypass_pipe</span><span class="p">)</span>

    <span class="n">supply_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="n">demand_inlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Inlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">())</span>

    <span class="n">demand_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">demandOutletNode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">hot_water_loop</span></div>



<div class="viewcode-block" id="model_add_chw_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_chw_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_chw_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;Chilled Water Loop&#39;</span><span class="p">,</span> <span class="n">cooling_fuel</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span>
        <span class="n">dsgn_sup_wtr_temp</span><span class="o">=</span><span class="mf">44.0</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_delt</span><span class="o">=</span><span class="mf">10.1</span><span class="p">,</span> <span class="n">chw_pumping_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chiller_cooling_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chiller_condenser_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chiller_compressor_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_chillers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">condenser_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">waterside_economizer</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a chilled water loop and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case</span>
<span class="sd">            it will be defaulted.</span>
<span class="sd">        cooling_fuel: [String] cooling fuel. Valid choices are: Electricity,</span>
<span class="sd">            DistrictCooling.</span>
<span class="sd">        dsgn_sup_wtr_temp: [Double] design supply water temperature in degrees</span>
<span class="sd">            Fahrenheit, default 44F.</span>
<span class="sd">        dsgn_sup_wtr_temp_delt: [Double] design supply-return water temperature</span>
<span class="sd">            difference in degrees Rankine, default 10 dF.</span>
<span class="sd">        chw_pumping_type: [String] valid choices are const_pri, const_pri_var_sec.</span>
<span class="sd">        chiller_cooling_type: [String] valid choices are AirCooled, WaterCooled.</span>
<span class="sd">        chiller_condenser_type: [String] valid choices are WithCondenser,</span>
<span class="sd">            WithoutCondenser, None.</span>
<span class="sd">        chiller_compressor_type: [String] valid choices are Centrifugal,</span>
<span class="sd">            Reciprocating, Rotary Screw, Scroll, None.</span>
<span class="sd">        num_chillers: [Integer] the number of chillers.</span>
<span class="sd">        condenser_water_loop: [OpenStudio::Model::PlantLoop] optional condenser</span>
<span class="sd">            water loop for water-cooled chillers. If None, the chillers will</span>
<span class="sd">            be air cooled.</span>
<span class="sd">        waterside_economizer: [String] Options are none, integrated, non-integrated.</span>
<span class="sd">            If integrated will add a heat exchanger to the supply inlet of the</span>
<span class="sd">            chilled water loop to provide waterside economizing whenever wet</span>
<span class="sd">            bulb temperatures allow. Non-integrated will add a heat exchanger</span>
<span class="sd">            in parallel with the chiller that will operate only when it can</span>
<span class="sd">            meet cooling demand exclusively with the waterside economizing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::PlantLoop] the resulting chilled water loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create chilled water loop</span>
    <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Chilled Water Loop&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">dsgn_sup_wtr_temp</span> <span class="o">=</span> <span class="mi">44</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp</span>

    <span class="c1"># chilled water loop sizing and controls</span>
    <span class="n">chw_sizing_control</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_delt</span><span class="p">)</span>

    <span class="c1"># create chilled water pumps</span>
    <span class="k">if</span> <span class="n">chw_pumping_type</span> <span class="o">==</span> <span class="s1">&#39;const_pri&#39;</span><span class="p">:</span>
        <span class="c1"># primary chilled water pump</span>
        <span class="n">pri_chw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="c1"># flat pump curve makes it behave as a constant speed pump</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setFractionofMotorInefficienciestoFluidStream</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setCoefficient1ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setCoefficient2ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setCoefficient3ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setCoefficient4ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
        <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">chw_pumping_type</span> <span class="o">==</span> <span class="s1">&#39;const_pri_var_sec&#39;</span><span class="p">:</span>
        <span class="n">pri_sec_config</span> <span class="o">=</span> <span class="n">plant_loop_set_chw_pri_sec_configuration</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pri_sec_config</span> <span class="o">==</span> <span class="s1">&#39;common_pipe&#39;</span><span class="p">:</span>
            <span class="c1"># primary chilled water pump</span>
            <span class="n">pri_chw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Primary Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">15</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>
            <span class="c1"># secondary chilled water pump</span>
            <span class="n">sec_chw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Secondary Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">45</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
            <span class="c1"># curve makes it perform like variable speed pump</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setFractionofMotorInefficienciestoFluidStream</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient1ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient2ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mf">0.0205</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient3ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mf">0.4101</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient4ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mf">0.5753</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">())</span>
            <span class="c1"># Change the chilled water loop to have a two-way common pipes</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">setCommonPipeSimulation</span><span class="p">(</span><span class="s1">&#39;CommonPipe&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">pri_sec_config</span> <span class="o">==</span> <span class="s1">&#39;heat_exchanger&#39;</span><span class="p">:</span>
            <span class="c1"># Check number of chillers</span>
            <span class="k">if</span> <span class="n">num_chillers</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;EMS Code for multiple chiller pump has not been written for &#39;</span> \
                    <span class="s1">&#39;greater than 3 chillers. This has </span><span class="si">{}</span><span class="s1"> chillers&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_chillers</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="c1"># NOTE: PRECONDITIONING for `const_pri_var_sec` pump type is only applicable</span>
            <span class="c1"># for PRM routine and only applies to System Type 7 and System Type 8</span>
            <span class="c1"># See: model_add_prm_baseline_system under Model object.</span>
            <span class="c1"># In this scenario, we will need to create a primary and secondary configuration:</span>
            <span class="c1"># chilled_water_loop is the primary loop</span>
            <span class="c1"># Primary: demand: heat exchanger, supply: chillers, name: Chilled Water Loop_Primary</span>
            <span class="c1"># Secondary: demand: Coils, supply: heat exchanger, name: Chilled Water Loop</span>
            <span class="n">secondary_chilled_water_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">secondary_loop_name</span> <span class="o">=</span> <span class="s1">&#39;Chilled Water Loop&#39;</span> <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> \
                <span class="k">else</span> <span class="n">system_name</span>
            <span class="c1"># Reset primary loop name</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Primary&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">secondary_loop_name</span><span class="p">))</span>
            <span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">secondary_loop_name</span><span class="p">)</span>
            <span class="n">chw_sizing_control</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">secondary_chilled_water_loop</span><span class="p">,</span>
                               <span class="n">dsgn_sup_wtr_temp</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_delt</span><span class="p">)</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">additionalProperties</span><span class="o">.</span><span class="n">setFeature</span><span class="p">(</span><span class="s1">&#39;is_primary_loop&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">additionalProperties</span><span class="o">.</span><span class="n">setFeature</span><span class="p">(</span>
                <span class="s1">&#39;secondary_loop_name&#39;</span><span class="p">,</span> <span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
            <span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">additionalProperties</span><span class="o">.</span><span class="n">setFeature</span><span class="p">(</span>
                <span class="s1">&#39;is_secondary_loop&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># primary chilled water pumps are added when adding chillers</span>
            <span class="c1"># Add Constant pump, in plant loop, the number of chiller adjustment</span>
            <span class="c1"># will assign pump to each chiller</span>
            <span class="n">pri_chw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">pump_variable_speed_set_control_type</span><span class="p">(</span>
                <span class="n">pri_chw_pump</span><span class="p">,</span> <span class="n">control_type</span><span class="o">=</span><span class="s1">&#39;Riding Curve&#39;</span><span class="p">)</span>
            <span class="c1"># This pump name is important for function</span>
            <span class="c1"># add_ems_for_multiple_chiller_pumps_w_secondary_plant</span>
            <span class="c1"># If you update it here, you must update the logic there to account for this</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Primary Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
            <span class="c1"># Will need to adjust the pump power after a sizing run</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span>
                <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">15</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">num_chillers</span><span class="p">)</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
            <span class="n">pri_chw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

            <span class="c1"># secondary chilled water pump</span>
            <span class="n">sec_chw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">45</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
            <span class="c1"># curve makes it perform like variable speed pump</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setFractionofMotorInefficienciestoFluidStream</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient1ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient2ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mf">0.0205</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient3ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mf">0.4101</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setCoefficient4ofthePartLoadPerformanceCurve</span><span class="p">(</span><span class="mf">0.5753</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
            <span class="n">sec_chw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">())</span>

            <span class="c1"># Add HX to connect secondary and primary loop</span>
            <span class="n">heat_exchanger</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">HeatExchangerFluidToFluid</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">heat_exchanger</span><span class="p">)</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">heat_exchanger</span><span class="p">)</span>

            <span class="c1"># Clean up connections</span>
            <span class="n">hx_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">hx_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> HX Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
            <span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">hx_bypass_pipe</span><span class="p">)</span>
            <span class="n">outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
            <span class="n">outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">secondary_chilled_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No primary/secondary configuration specified for chilled water loop.&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No pumping type specified for the chilled water loop.&#39;</span><span class="p">)</span>

    <span class="c1"># check for existence of condenser_water_loop if WaterCooled</span>
    <span class="k">if</span> <span class="n">chiller_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;WaterCooled&#39;</span> <span class="ow">and</span> <span class="n">condenser_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Requested chiller is WaterCooled but no condenser loop specified.&#39;</span><span class="p">)</span>

    <span class="c1"># check for non-existence of condenser_water_loop if AirCooled</span>
    <span class="k">if</span> <span class="n">chiller_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;AirCooled&#39;</span> <span class="ow">and</span> <span class="n">condenser_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Requested chiller is AirCooled but condenser loop specified.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cooling_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">:</span>
        <span class="c1"># DistrictCooling</span>
        <span class="n">dist_clg</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictCooling</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">dist_clg</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Purchased Cooling&#39;</span><span class="p">)</span>
        <span class="n">dist_clg</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">dist_clg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># use default efficiency from 90.1-2019</span>
        <span class="c1"># 1.188 kw/ton for a 150 ton AirCooled chiller</span>
        <span class="c1"># 0.66 kw/ton for a 150 ton Water Cooled positive displacement chiller</span>
        <span class="k">if</span> <span class="n">chiller_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;AirCooled&#39;</span><span class="p">:</span>
            <span class="n">default_cop</span> <span class="o">=</span> <span class="n">kw_per_ton_to_cop</span><span class="p">(</span><span class="mf">1.188</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">chiller_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;WaterCooled&#39;</span><span class="p">:</span>
            <span class="n">default_cop</span> <span class="o">=</span> <span class="n">kw_per_ton_to_cop</span><span class="p">(</span><span class="mf">0.66</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_cop</span> <span class="o">=</span> <span class="n">kw_per_ton_to_cop</span><span class="p">(</span><span class="mf">0.66</span><span class="p">)</span>

        <span class="c1"># make the correct type of chiller based these properties</span>
        <span class="n">chiller_sizing_factor</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">num_chillers</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Create chillers and set plant operation scheme</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_chillers</span><span class="p">):</span>
            <span class="n">chiller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ChillerElectricEIR</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cool_t</span> <span class="o">=</span> <span class="n">chiller_cooling_type</span> \
                <span class="k">if</span> <span class="n">chiller_cooling_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;WaterCooled&#39;</span>
            <span class="n">cond_t</span> <span class="o">=</span> <span class="n">chiller_condenser_type</span> <span class="k">if</span> <span class="n">chiller_condenser_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">comp_t</span> <span class="o">=</span> <span class="n">chiller_compressor_type</span> <span class="k">if</span> <span class="n">chiller_compressor_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">ch_name</span> <span class="o">=</span> <span class="s1">&#39;ASHRAE 90.1 </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> Chiller </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cool_t</span><span class="p">,</span> <span class="n">cond_t</span><span class="p">,</span> <span class="n">comp_t</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">ch_name</span><span class="p">)</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">chiller</span><span class="p">)</span>
            <span class="n">dsgn_sup_wtr_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setReferenceLeavingChilledWaterTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_c</span><span class="p">)</span>
            <span class="n">lcw_ltl</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">36.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setLeavingChilledWaterLowerTemperatureLimit</span><span class="p">(</span><span class="n">lcw_ltl</span><span class="p">)</span>
            <span class="n">rec_ft</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">95.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setReferenceEnteringCondenserFluidTemperature</span><span class="p">(</span><span class="n">rec_ft</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setMinimumPartLoadRatio</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setMaximumPartLoadRatio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setOptimumPartLoadRatio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setMinimumUnloadingRatio</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setChillerFlowMode</span><span class="p">(</span><span class="s1">&#39;ConstantFlow&#39;</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setSizingFactor</span><span class="p">(</span><span class="n">chiller_sizing_factor</span><span class="p">)</span>
            <span class="n">chiller</span><span class="o">.</span><span class="n">setReferenceCOP</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">default_cop</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

            <span class="c1"># connect the chiller to the condenser loop if one was supplied</span>
            <span class="k">if</span> <span class="n">condenser_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">chiller</span><span class="o">.</span><span class="n">setCondenserType</span><span class="p">(</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">chiller</span><span class="p">)</span>
                <span class="n">chiller</span><span class="o">.</span><span class="n">setCondenserType</span><span class="p">(</span><span class="s1">&#39;WaterCooled&#39;</span><span class="p">)</span>

    <span class="c1"># enable waterside economizer if requested</span>
    <span class="k">if</span> <span class="n">condenser_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">waterside_economizer</span> <span class="o">==</span> <span class="s1">&#39;integrated&#39;</span><span class="p">:</span>
            <span class="n">model_add_waterside_economizer</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">condenser_water_loop</span><span class="p">,</span> <span class="n">integrated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">waterside_economizer</span> <span class="o">==</span> <span class="s1">&#39;non-integrated&#39;</span><span class="p">:</span>
            <span class="n">model_add_waterside_economizer</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">condenser_water_loop</span><span class="p">,</span> <span class="n">integrated</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># chilled water loop pipes</span>
    <span class="n">chiller_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">chiller_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Chiller Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">chiller_bypass_pipe</span><span class="p">)</span>

    <span class="n">coil_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">coil_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Coil Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">coil_bypass_pipe</span><span class="p">)</span>

    <span class="n">supply_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="n">demand_inlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Inlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">())</span>

    <span class="n">demand_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">demandOutletNode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">chilled_water_loop</span></div>



<div class="viewcode-block" id="model_add_vsd_twr_fan_curve">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vsd_twr_fan_curve">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_vsd_twr_fan_curve</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a curve to be used for cooling tower fans.&quot;&quot;&quot;</span>
    <span class="c1"># check for the existing curve</span>
    <span class="n">exist_curve</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getCurveCubicByName</span><span class="p">(</span><span class="s1">&#39;VSD-TWR-FAN-FPLR&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exist_curve</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">exist_curve</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="c1"># create the curve</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CurveCubic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;VSD-TWR-FAN-FPLR&#39;</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setCoefficient1Constant</span><span class="p">(</span><span class="mf">0.33162901</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setCoefficient2x</span><span class="p">(</span><span class="o">-</span><span class="mf">0.88567609</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setCoefficient3xPOW2</span><span class="p">(</span><span class="mf">0.60556507</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setCoefficient4xPOW3</span><span class="p">(</span><span class="mf">0.9484823</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setMinimumValueofx</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">curve</span><span class="o">.</span><span class="n">setMaximumValueofx</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">curve</span></div>



<div class="viewcode-block" id="model_add_cw_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_cw_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_cw_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;Condenser Water Loop&#39;</span><span class="p">,</span> <span class="n">cooling_tower_type</span><span class="o">=</span><span class="s1">&#39;Open Cooling Tower&#39;</span><span class="p">,</span>
        <span class="n">cooling_tower_fan_type</span><span class="o">=</span><span class="s1">&#39;Propeller or Axial&#39;</span><span class="p">,</span>
        <span class="n">cooling_tower_capacity_control</span><span class="o">=</span><span class="s1">&#39;TwoSpeed Fan&#39;</span><span class="p">,</span>
        <span class="n">number_of_cells_per_tower</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_cooling_towers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">use_90_1_design_sizing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">sup_wtr_temp</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp</span><span class="o">=</span><span class="mf">85.0</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_delt</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
        <span class="n">wet_bulb_approach</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">pump_spd_ctrl</span><span class="o">=</span><span class="s1">&#39;Constant&#39;</span><span class="p">,</span> <span class="n">pump_tot_hd</span><span class="o">=</span><span class="mf">49.7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a condenser water loop and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        cooling_tower_type: [String] valid choices are Open Cooling Tower,</span>
<span class="sd">            Closed Cooling Tower.</span>
<span class="sd">        cooling_tower_fan_type: [String] valid choices are Centrifugal, &quot;Propeller or Axial.&quot;</span>
<span class="sd">        cooling_tower_capacity_control: [String] valid choices are Fluid Bypass,</span>
<span class="sd">            Fan Cycling, TwoSpeed Fan, Variable Speed Fan.</span>
<span class="sd">        number_of_cells_per_tower: [Integer] the number of discrete cells per tower.</span>
<span class="sd">        number_cooling_towers: [Integer] the number of cooling towers to be</span>
<span class="sd">            added (in parallel).</span>
<span class="sd">        use_90_1_design_sizing: [Boolean] will determine the design sizing</span>
<span class="sd">            temperatures based on the 90.1 Appendix G approach. Overrides sup_wtr_temp,</span>
<span class="sd">            dsgn_sup_wtr_temp, dsgn_sup_wtr_temp_delt, and wet_bulb_approach if True.</span>
<span class="sd">        sup_wtr_temp: [Double] supply water temperature in degrees</span>
<span class="sd">            Fahrenheit, default 70F.</span>
<span class="sd">        dsgn_sup_wtr_temp: [Double] design supply water temperature in degrees</span>
<span class="sd">            Fahrenheit, default 85F.</span>
<span class="sd">        dsgn_sup_wtr_temp_delt: [Double] design water range temperature in</span>
<span class="sd">            degrees Rankine (aka. dF), default 10R.</span>
<span class="sd">        wet_bulb_approach: [Double] design wet bulb approach temperature, default 7R.</span>
<span class="sd">        pump_spd_ctrl: [String] pump speed control type, Constant or Variable (default).</span>
<span class="sd">        pump_tot_hd: [Double] pump head in ft H2O.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::PlantLoop] the resulting condenser water plant loop</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create condenser water loop</span>
    <span class="n">condenser_water_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;Condenser Water Loop&#39;</span> <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>

    <span class="c1"># condenser water loop sizing and controls</span>
    <span class="n">sup_wtr_temp</span> <span class="o">=</span> <span class="mf">70.0</span> <span class="k">if</span> <span class="n">sup_wtr_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sup_wtr_temp</span>
    <span class="n">sup_wtr_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sup_wtr_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_sup_wtr_temp</span> <span class="o">=</span> <span class="mf">85.0</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp</span>
    <span class="n">dsgn_sup_wtr_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_sup_wtr_temp_delt</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp_delt</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp_delt</span>
    <span class="n">dsgn_sup_wtr_temp_delt_k</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp_delt</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wet_bulb_approach</span> <span class="o">=</span> <span class="mf">7.0</span> <span class="k">if</span> <span class="n">wet_bulb_approach</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">wet_bulb_approach</span>
    <span class="n">wet_bulb_approach_k</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">wet_bulb_approach</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">setMinimumLoopTemperature</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">setMaximumLoopTemperature</span><span class="p">(</span><span class="mf">80.0</span><span class="p">)</span>
    <span class="n">sizing_plant</span> <span class="o">=</span> <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopType</span><span class="p">(</span><span class="s1">&#39;Condenser&#39;</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_delt_k</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setSizingOption</span><span class="p">(</span><span class="s1">&#39;Coincident&#39;</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setZoneTimestepsinAveragingWindow</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setCoincidentSizingFactorMode</span><span class="p">(</span><span class="s1">&#39;GlobalCoolingSizingFactor&#39;</span><span class="p">)</span>

    <span class="c1"># follow outdoor air wetbulb with given approach temperature</span>
    <span class="n">cw_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerFollowOutdoorAirTemperature</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">s_pt_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Setpoint Manager Follow OATwb with </span><span class="si">{}</span><span class="s1">F Approach&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="n">wet_bulb_approach</span><span class="p">)</span>
    <span class="n">cw_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">s_pt_name</span><span class="p">)</span>
    <span class="n">cw_stpt_manager</span><span class="o">.</span><span class="n">setReferenceTemperatureType</span><span class="p">(</span><span class="s1">&#39;OutdoorAirWetBulb&#39;</span><span class="p">)</span>
    <span class="n">cw_stpt_manager</span><span class="o">.</span><span class="n">setMaximumSetpointTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">cw_stpt_manager</span><span class="o">.</span><span class="n">setMinimumSetpointTemperature</span><span class="p">(</span><span class="n">sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">cw_stpt_manager</span><span class="o">.</span><span class="n">setOffsetTemperatureDifference</span><span class="p">(</span><span class="n">wet_bulb_approach_k</span><span class="p">)</span>
    <span class="n">cw_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create condenser water pump</span>
    <span class="k">if</span> <span class="n">pump_spd_ctrl</span> <span class="o">==</span> <span class="s1">&#39;Constant&#39;</span><span class="p">:</span>
        <span class="n">cw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pump_spd_ctrl</span> <span class="o">==</span> <span class="s1">&#39;Variable&#39;</span><span class="p">:</span>
        <span class="n">cw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pump_spd_ctrl</span> <span class="o">==</span> <span class="s1">&#39;HeaderedVariable&#39;</span><span class="p">:</span>
        <span class="n">cw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">HeaderedPumpsVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">cw_pump</span><span class="o">.</span><span class="n">setNumberofPumpsinBank</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pump_spd_ctrl</span> <span class="o">==</span> <span class="s1">&#39;HeaderedConstant&#39;</span><span class="p">:</span>
        <span class="n">cw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">HeaderedPumpsConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">cw_pump</span><span class="o">.</span><span class="n">setNumberofPumpsinBank</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cw_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">cw_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="n">pump_spd_ctrl</span><span class="p">))</span>
    <span class="n">cw_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>

    <span class="n">pump_tot_hd</span> <span class="o">=</span> <span class="mf">49.7</span> <span class="k">if</span> <span class="n">pump_tot_hd</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pump_tot_hd</span>
    <span class="n">pump_tot_hd_pa</span> <span class="o">=</span> <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">pump_tot_hd</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cw_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">pump_tot_hd_pa</span><span class="p">)</span>
    <span class="n">cw_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># Cooling towers</span>
    <span class="c1"># Per PNNL PRM Reference Manual</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_cooling_towers</span><span class="p">):</span>
        <span class="c1"># Tower object depends on the control type</span>
        <span class="n">cooling_tower</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cooling_tower_capacity_control</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Fluid Bypass&#39;</span><span class="p">,</span> <span class="s1">&#39;Fan Cycling&#39;</span><span class="p">):</span>
            <span class="n">cooling_tower</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoolingTowerSingleSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cooling_tower_capacity_control</span> <span class="o">==</span> <span class="s1">&#39;Fluid Bypass&#39;</span><span class="p">:</span>
                <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setCellControl</span><span class="p">(</span><span class="s1">&#39;FluidBypass&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setCellControl</span><span class="p">(</span><span class="s1">&#39;FanCycling&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cooling_tower_capacity_control</span> <span class="o">==</span> <span class="s1">&#39;TwoSpeed Fan&#39;</span><span class="p">:</span>
            <span class="n">cooling_tower</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoolingTowerTwoSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cooling_tower_capacity_control</span> <span class="o">==</span> <span class="s1">&#39;Variable Speed Fan&#39;</span><span class="p">:</span>
            <span class="n">cooling_tower</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoolingTowerVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setDesignRangeTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_delt_k</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setDesignApproachTemperature</span><span class="p">(</span><span class="n">wet_bulb_approach_k</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setFractionofTowerCapacityinFreeConvectionRegime</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span>
            <span class="n">twr_fan_curve</span> <span class="o">=</span> <span class="n">model_add_vsd_twr_fan_curve</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setFanPowerRatioFunctionofAirFlowRateRatioCurve</span><span class="p">(</span><span class="n">twr_fan_curve</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is not a valid choice of cooling tower capacity control. &#39;</span> \
                <span class="s1">&#39;Valid choices are Fluid Bypass, Fan Cycling, TwoSpeed Fan, Variable &#39;</span> \
                <span class="s1">&#39;Speed Fan.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cooling_tower_capacity_control</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Set the properties that apply to all tower types and attach to the condenser loop.</span>
        <span class="k">if</span> <span class="n">cooling_tower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">twr_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">cooling_tower_fan_type</span><span class="p">,</span> <span class="n">cooling_tower_capacity_control</span><span class="p">,</span>
                <span class="n">cooling_tower_type</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">twr_name</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setSizingFactor</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">number_cooling_towers</span><span class="p">)</span>
            <span class="n">cooling_tower</span><span class="o">.</span><span class="n">setNumberofCells</span><span class="p">(</span><span class="n">number_of_cells_per_tower</span><span class="p">)</span>
            <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_tower</span><span class="p">)</span>

    <span class="c1"># apply 90.1 sizing temperatures</span>
    <span class="k">if</span> <span class="n">use_90_1_design_sizing</span><span class="p">:</span>
        <span class="c1"># use the formulation in 90.1-2010 G3.1.3.11 to set the approach temperature</span>
        <span class="c1"># first, look in the model design day objects for sizing information</span>
        <span class="n">summer_oat_wbs_f</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">getDesignDays</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dd</span><span class="o">.</span><span class="n">dayType</span> <span class="o">!=</span> <span class="s1">&#39;SummerDesignDay&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="s1">&#39;WB=&gt;MDB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">nameString</span><span class="p">():</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.3.0&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">dd</span><span class="o">.</span><span class="n">humidityIndicatingType</span> <span class="o">==</span> <span class="s1">&#39;Wetbulb&#39;</span><span class="p">:</span>
                    <span class="n">summer_oat_wb_c</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">humidityIndicatingConditionsAtMaximumDryBulb</span><span class="p">()</span>
                    <span class="n">summer_oat_wbs_f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">summer_oat_wb_c</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;For </span><span class="si">{}</span><span class="s1">, humidity is specified as </span><span class="si">{}</span><span class="s1">; cannot determine Twb.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">dd</span><span class="o">.</span><span class="n">nameString</span><span class="p">,</span> <span class="n">dd</span><span class="o">.</span><span class="n">humidityIndicatingType</span><span class="p">())</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dd</span><span class="o">.</span><span class="n">humidityConditionType</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Wetbulb&#39;</span> <span class="ow">and</span> \
                        <span class="n">dd</span><span class="o">.</span><span class="n">wetBulbOrDewPointAtMaximumDryBulb</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
                    <span class="n">wb_mdbt</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">wetBulbOrDewPointAtMaximumDryBulb</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                    <span class="n">summer_oat_wbs_f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">wb_mdbt</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;For </span><span class="si">{}</span><span class="s1">, humidity is specified as </span><span class="si">{}</span><span class="s1">; cannot determine Twb.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">dd</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="n">dd</span><span class="o">.</span><span class="n">humidityConditionType</span><span class="p">())</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># if values are still absent, use the CTI rating condition 78F</span>
        <span class="n">design_oat_wb_f</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">summer_oat_wbs_f</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">design_oat_wb_f</span> <span class="o">=</span> <span class="mf">78.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">design_oat_wb_f</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">summer_oat_wbs_f</span><span class="p">)</span>  <span class="c1"># Take worst case condition</span>
        <span class="n">design_oat_wb_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">design_oat_wb_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># call method to apply design sizing to the condenser water loop</span>
        <span class="n">prototype_apply_condenser_water_temperatures</span><span class="p">(</span>
            <span class="n">condenser_water_loop</span><span class="p">,</span> <span class="n">design_wet_bulb_c</span><span class="o">=</span><span class="n">design_oat_wb_c</span><span class="p">)</span>

    <span class="c1"># Condenser water loop pipes</span>
    <span class="n">cooling_tower_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">pipe_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Cooling Tower Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
    <span class="n">cooling_tower_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">pipe_name</span><span class="p">)</span>
    <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_tower_bypass_pipe</span><span class="p">)</span>

    <span class="n">chiller_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">pipe_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Chiller Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
    <span class="n">chiller_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">pipe_name</span><span class="p">)</span>
    <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">chiller_bypass_pipe</span><span class="p">)</span>

    <span class="n">supply_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="n">demand_inlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Inlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">())</span>

    <span class="n">demand_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">demandOutletNode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">condenser_water_loop</span></div>



<div class="viewcode-block" id="model_add_hp_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_hp_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_hp_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">heating_fuel</span><span class="o">=</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="n">cooling_fuel</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span>
        <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;EvaporativeFluidCooler&#39;</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;Heat Pump Loop&#39;</span><span class="p">,</span>
        <span class="n">sup_wtr_high_temp</span><span class="o">=</span><span class="mf">87.0</span><span class="p">,</span> <span class="n">sup_wtr_low_temp</span><span class="o">=</span><span class="mf">67.0</span><span class="p">,</span>
        <span class="n">dsgn_sup_wtr_temp</span><span class="o">=</span><span class="mf">102.2</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_delt</span><span class="o">=</span><span class="mf">19.8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a heat pump loop which has a boiler and fluid cooler.</span>

<span class="sd">    Args:</span>
<span class="sd">        model [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        heating_fuel: [String]</span>
<span class="sd">        cooling_fuel: [String] cooling fuel. Valid options are: Electricity,</span>
<span class="sd">            DistrictCooling.</span>
<span class="sd">        cooling_type: [String] cooling type if not DistrictCooling.</span>
<span class="sd">            Valid options are: CoolingTower, CoolingTowerSingleSpeed,</span>
<span class="sd">            CoolingTowerTwoSpeed, CoolingTowerVariableSpeed, FluidCooler,</span>
<span class="sd">            FluidCoolerSingleSpeed, FluidCoolerTwoSpeed, EvaporativeFluidCooler,</span>
<span class="sd">            EvaporativeFluidCoolerSingleSpeed, EvaporativeFluidCoolerTwoSpeed</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted</span>
<span class="sd">        sup_wtr_high_temp: [Double] target supply water temperature to enable</span>
<span class="sd">            cooling in degrees Fahrenheit, default 65.0F</span>
<span class="sd">        sup_wtr_low_temp: [Double] target supply water temperature to enable</span>
<span class="sd">            heating in degrees Fahrenheit, default 41.0F</span>
<span class="sd">        dsgn_sup_wtr_temp: [Double] design supply water temperature in degrees</span>
<span class="sd">            Fahrenheit, default 102.2F</span>
<span class="sd">        dsgn_sup_wtr_temp_delt: [Double] design supply-return water temperature</span>
<span class="sd">            difference in degrees Rankine, default 19.8R.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::PlantLoop] the resulting plant loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create heat pump loop</span>
    <span class="n">heat_pump_water_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">setLoadDistributionScheme</span><span class="p">(</span><span class="s1">&#39;SequentialLoad&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Heat Pump Loop&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>

    <span class="c1"># hot water loop sizing and controls</span>
    <span class="n">sup_wtr_high_temp</span> <span class="o">=</span> <span class="mf">87.0</span> <span class="k">if</span> <span class="n">sup_wtr_high_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sup_wtr_high_temp</span>
    <span class="n">sup_wtr_high_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sup_wtr_high_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sup_wtr_low_temp</span> <span class="o">=</span> <span class="mf">67.0</span> <span class="k">if</span> <span class="n">sup_wtr_low_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sup_wtr_low_temp</span>
    <span class="n">sup_wtr_low_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sup_wtr_low_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_sup_wtr_temp</span> <span class="o">=</span> <span class="mf">102.2</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp</span>
    <span class="n">dsgn_sup_wtr_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_sup_wtr_temp_delt</span> <span class="o">=</span> <span class="mf">19.8</span> <span class="k">if</span> <span class="n">dsgn_sup_wtr_temp_delt</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">dsgn_sup_wtr_temp_delt</span>
    <span class="n">dsgn_sup_wtr_temp_delt_k</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_sup_wtr_temp_delt</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">sizing_plant</span> <span class="o">=</span> <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopType</span><span class="p">(</span><span class="s1">&#39;Heating&#39;</span><span class="p">)</span>
    <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">setMinimumLoopTemperature</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">setMaximumLoopTemperature</span><span class="p">(</span><span class="mf">35.0</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_delt_k</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
    <span class="n">hp_high_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">sup_wtr_high_temp_c</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> High Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sup_wtr_high_temp</span><span class="p">)),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">hp_low_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">sup_wtr_low_temp_c</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Low Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sup_wtr_low_temp</span><span class="p">)),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">hp_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduledDualSetpoint</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">hp_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">hp_stpt_manager</span><span class="o">.</span><span class="n">setHighSetpointSchedule</span><span class="p">(</span><span class="n">hp_high_temp_sch</span><span class="p">)</span>
    <span class="n">hp_stpt_manager</span><span class="o">.</span><span class="n">setLowSetpointSchedule</span><span class="p">(</span><span class="n">hp_low_temp_sch</span><span class="p">)</span>
    <span class="n">hp_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create pump</span>
    <span class="n">hp_pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">hp_pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">hp_pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">60.0</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">hp_pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
    <span class="n">hp_pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># add setpoint to cooling outlet so correct plant operation scheme is generated</span>
    <span class="n">cooling_equipment_stpt_manager</span> <span class="o">=</span> \
        <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduledDualSetpoint</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setHighSetpointSchedule</span><span class="p">(</span><span class="n">hp_high_temp_sch</span><span class="p">)</span>
    <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setLowSetpointSchedule</span><span class="p">(</span><span class="n">hp_low_temp_sch</span><span class="p">)</span>

    <span class="c1"># create cooling equipment and add to the loop</span>
    <span class="k">if</span> <span class="n">cooling_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">:</span>
        <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictCooling</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Cooling&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
        <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Cooling Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cooling_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;CoolingTower&#39;</span><span class="p">,</span> <span class="s1">&#39;CoolingTowerTwoSpeed&#39;</span><span class="p">):</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoolingTowerTwoSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> CoolingTowerTwoSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Cooling Tower Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;CoolingTowerSingleSpeed&#39;</span><span class="p">:</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoolingTowerSingleSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> CoolingTowerSingleSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Cooling Tower Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;CoolingTowerVariableSpeed&#39;</span><span class="p">:</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoolingTowerVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> CoolingTowerVariableSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Cooling Tower Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;FluidCooler&#39;</span><span class="p">,</span> <span class="s1">&#39;FluidCoolerSingleSpeed&#39;</span><span class="p">):</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">FluidCoolerSingleSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> FluidCoolerSingleSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fluid Cooler Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="c1"># Remove hard coded default values</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setPerformanceInputMethod</span><span class="p">(</span>
                <span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">autosizeDesignWaterFlowRate</span><span class="p">()</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">autosizeDesignAirFlowRate</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;FluidCoolerTwoSpeed&#39;</span><span class="p">:</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">FluidCoolerTwoSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> FluidCoolerTwoSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fluid Cooler Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="c1"># Remove hard coded default values</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setPerformanceInputMethod</span><span class="p">(</span>
                <span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">autosizeDesignWaterFlowRate</span><span class="p">()</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">autosizeHighFanSpeedAirFlowRate</span><span class="p">()</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">autosizeLowFanSpeedAirFlowRate</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;EvaporativeFluidCooler&#39;</span><span class="p">,</span> <span class="s1">&#39;EvaporativeFluidCoolerSingleSpeed&#39;</span><span class="p">):</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EvaporativeFluidCoolerSingleSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> EvaporativeFluidCoolerSingleSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setDesignSprayWaterFlowRate</span><span class="p">(</span><span class="mf">0.002208</span><span class="p">)</span>  <span class="c1"># Based on HighRiseApartment</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setPerformanceInputMethod</span><span class="p">(</span>
                <span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">)</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fluid Cooler Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;EvaporativeFluidCoolerTwoSpeed&#39;</span><span class="p">:</span>
            <span class="n">cooling_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EvaporativeFluidCoolerTwoSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> EvaporativeFluidCoolerTwoSpeed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setDesignSprayWaterFlowRate</span><span class="p">(</span><span class="mf">0.002208</span><span class="p">)</span>  <span class="c1"># Based on HighRiseApartment</span>
            <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">setPerformanceInputMethod</span><span class="p">(</span>
                <span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">)</span>
            <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">cooling_equipment</span><span class="p">)</span>
            <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fluid Cooler Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Cooling fuel type &quot;</span><span class="si">{}</span><span class="s1">&quot; is not a valid option.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cooling_type</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">equip_out_node</span> <span class="o">=</span> <span class="n">cooling_equipment</span><span class="o">.</span><span class="n">outletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">cooling_equipment_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">equip_out_node</span><span class="p">)</span>

    <span class="c1"># add setpoint to heating outlet so correct plant operation scheme is generated</span>
    <span class="n">heating_equipment_stpt_manager</span> <span class="o">=</span> \
        <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduledDualSetpoint</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setHighSetpointSchedule</span><span class="p">(</span><span class="n">hp_high_temp_sch</span><span class="p">)</span>
    <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setLowSetpointSchedule</span><span class="p">(</span><span class="n">hp_low_temp_sch</span><span class="p">)</span>

    <span class="c1"># switch statement to handle district heating name change</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.7.0&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">heating_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span> <span class="ow">or</span> \
                <span class="n">heating_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">:</span>
            <span class="n">heating_fuel</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">heating_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">:</span>
            <span class="n">heating_fuel</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span>

    <span class="c1"># create heating equipment and add to the loop</span>
    <span class="k">if</span> <span class="n">heating_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">:</span>
        <span class="n">heating_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeating</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">heating_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">heating_equipment</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">heating_equipment</span><span class="p">)</span>
        <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">heating_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">:</span>
        <span class="n">heating_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeatingWater</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">heating_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">heating_equipment</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">heating_equipment</span><span class="p">)</span>
        <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">heating_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">:</span>
        <span class="n">heating_equipment</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeatingSteam</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">heating_equipment</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">heating_equipment</span><span class="o">.</span><span class="n">autosizeNominalCapacity</span><span class="p">()</span>
        <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">heating_equipment</span><span class="p">)</span>
        <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> District Heating Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">heating_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">,</span> <span class="s1">&#39;ASHP&#39;</span><span class="p">):</span>
        <span class="n">heating_equipment</span> <span class="o">=</span> <span class="n">create_central_air_source_heat_pump</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">heat_pump_water_loop</span><span class="p">)</span>
        <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ASHP Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">heating_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Propane&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;PropaneGas&#39;</span><span class="p">,</span> <span class="s1">&#39;FuelOilNo1&#39;</span><span class="p">,</span> <span class="s1">&#39;FuelOilNo2&#39;</span><span class="p">):</span>
        <span class="n">heating_equipment</span> <span class="o">=</span> <span class="n">create_boiler_hot_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">heat_pump_water_loop</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supplemental Boiler&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="n">fuel_type</span><span class="o">=</span><span class="n">heating_fuel</span><span class="p">,</span>
            <span class="n">flow_mode</span><span class="o">=</span><span class="s1">&#39;ConstantFlow&#39;</span><span class="p">,</span>
            <span class="n">lvg_temp_dsgn_f</span><span class="o">=</span><span class="mf">86.0</span><span class="p">,</span> <span class="n">min_plr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_plr</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">opt_plr</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Boiler Scheduled Dual Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Boiler fuel type &quot;</span><span class="si">{}</span><span class="s1">&quot; is not valid&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heating_fuel</span><span class="p">))</span>
    <span class="n">equip_out_node</span> <span class="o">=</span> <span class="n">heating_equipment</span><span class="o">.</span><span class="n">outletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">heating_equipment_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">equip_out_node</span><span class="p">)</span>

    <span class="c1"># add heat pump water loop pipes</span>
    <span class="n">supply_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">supply_bypass_pipe</span><span class="p">)</span>

    <span class="n">demand_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">demand_bypass_pipe</span><span class="p">)</span>

    <span class="n">supply_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="n">demand_inlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Inlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">())</span>

    <span class="n">demand_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">heat_pump_water_loop</span><span class="o">.</span><span class="n">demandOutletNode</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">heat_pump_water_loop</span></div>



<div class="viewcode-block" id="model_add_ground_hx_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_ground_hx_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_ground_hx_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;Ground HX Loop&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates loop that roughly mimics a properly sized ground heat exchanger.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case</span>
<span class="sd">            it will be defaulted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::PlantLoop] the resulting plant loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create ground hx loop</span>
    <span class="n">ground_hx_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;Ground HX Loop&#39;</span> <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># ground hx loop sizing and controls</span>
    <span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">setMinimumLoopTemperature</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">setMaximumLoopTemperature</span><span class="p">(</span><span class="mf">80.0</span><span class="p">)</span>
    <span class="c1"># temp change at high and low entering condition</span>
    <span class="n">delta_t_k</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">12.0</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># low entering condition</span>
    <span class="n">min_inlet_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">30.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># high entering condition</span>
    <span class="n">max_inlet_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">90.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># calculate the linear formula that defines outlet temperature</span>
    <span class="c1"># based on inlet temperature of the ground hx</span>
    <span class="n">min_outlet_c</span> <span class="o">=</span> <span class="n">min_inlet_c</span> <span class="o">+</span> <span class="n">delta_t_k</span>
    <span class="n">max_outlet_c</span> <span class="o">=</span> <span class="n">max_inlet_c</span> <span class="o">-</span> <span class="n">delta_t_k</span>
    <span class="n">slope_c_per_c</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_outlet_c</span> <span class="o">-</span> <span class="n">min_outlet_c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_inlet_c</span> <span class="o">-</span> <span class="n">min_inlet_c</span><span class="p">)</span>
    <span class="n">intercept_c</span> <span class="o">=</span> <span class="n">min_outlet_c</span> <span class="o">-</span> <span class="p">(</span><span class="n">slope_c_per_c</span> <span class="o">*</span> <span class="n">min_inlet_c</span><span class="p">)</span>

    <span class="n">sizing_plant</span> <span class="o">=</span> <span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopType</span><span class="p">(</span><span class="s1">&#39;Heating&#39;</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span><span class="n">max_outlet_c</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span><span class="n">delta_t_k</span><span class="p">)</span>

    <span class="c1"># create pump</span>
    <span class="n">pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpConstantSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">60.0</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># use EMS and a PlantComponentTemperatureSource</span>
    <span class="c1"># to mimic the operation of the ground heat exchanger</span>

    <span class="c1"># schedule to actuate ground HX outlet temperature</span>
    <span class="n">hx_temp_sch</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ScheduleConstant</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">hx_temp_sch</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Ground HX Temp Sch&#39;</span><span class="p">)</span>
    <span class="n">hx_temp_sch</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">24.0</span><span class="p">)</span>

    <span class="n">ground_hx</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantComponentTemperatureSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">ground_hx</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Ground HX&#39;</span><span class="p">)</span>
    <span class="n">ground_hx</span><span class="o">.</span><span class="n">setTemperatureSpecificationType</span><span class="p">(</span><span class="s1">&#39;Scheduled&#39;</span><span class="p">)</span>
    <span class="n">ground_hx</span><span class="o">.</span><span class="n">setSourceTemperatureSchedule</span><span class="p">(</span><span class="n">hx_temp_sch</span><span class="p">)</span>
    <span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">ground_hx</span><span class="p">)</span>

    <span class="n">hx_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hx_temp_sch</span><span class="p">)</span>
    <span class="n">hx_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ground_hx</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">hx_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ground_hx</span><span class="o">.</span><span class="n">outletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

    <span class="n">loop_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hx_temp_sch</span><span class="p">)</span>
    <span class="n">loop_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet Setpoint&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">loop_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># edit name to be EMS friendly</span>
    <span class="n">ground_hx_ems_name</span> <span class="o">=</span> <span class="n">ems_friendly_name</span><span class="p">(</span><span class="n">ground_hx</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>

    <span class="c1"># sensor to read supply inlet temperature</span>
    <span class="n">inlet_temp_sensor</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemSensor</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;System Node Temperature&#39;</span><span class="p">)</span>
    <span class="n">inlet_temp_sensor</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Inlet Temp Sensor&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ground_hx_ems_name</span><span class="p">))</span>
    <span class="n">inlet_temp_sensor</span><span class="o">.</span><span class="n">setKeyName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ground_hx_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">()</span><span class="o">.</span><span class="n">handle</span><span class="p">()))</span>

    <span class="c1"># actuator to set supply outlet temperature</span>
    <span class="n">outlet_temp_actuator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
        <span class="n">hx_temp_sch</span><span class="p">,</span> <span class="s1">&#39;Schedule:Constant&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
    <span class="n">outlet_temp_actuator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Outlet Temp Actuator&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ground_hx_ems_name</span><span class="p">))</span>

    <span class="c1"># program to control outlet temperature</span>
    <span class="c1"># adjusts delta-t based on calculation of slope and intercept from control temperatures</span>
    <span class="n">program</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgram</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">program</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Temperature Control&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ground_hx_ems_name</span><span class="p">))</span>
    <span class="n">program_body</span> <span class="o">=</span> \
        <span class="s1">&#39;SET Tin = </span><span class="si">{inlet_temp_sensor_handle}</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;SET Tout = </span><span class="si">{slope_c_per_c}</span><span class="s1"> * Tin + </span><span class="si">{intercept_c}</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;SET </span><span class="si">{outlet_temp_actuator_handle}</span><span class="s1"> = Tout&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">inlet_temp_sensor_handle</span><span class="o">=</span><span class="n">inlet_temp_sensor</span><span class="o">.</span><span class="n">handle</span><span class="p">(),</span>
            <span class="n">slope_c_per_c</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">slope_c_per_c</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">intercept_c</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept_c</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">outlet_temp_actuator_handle</span><span class="o">=</span><span class="n">outlet_temp_actuator</span><span class="o">.</span><span class="n">handle</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="n">program</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">program_body</span><span class="p">)</span>

    <span class="c1"># program calling manager</span>
    <span class="n">pcm</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgramCallingManager</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">pcm</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Calling Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">program</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>
    <span class="n">pcm</span><span class="o">.</span><span class="n">setCallingPoint</span><span class="p">(</span><span class="s1">&#39;InsideHVACSystemIterationLoop&#39;</span><span class="p">)</span>
    <span class="n">pcm</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ground_hx_loop</span></div>



<div class="viewcode-block" id="model_add_district_ambient_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_district_ambient_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_district_ambient_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;Ambient Loop&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds an ambient condenser water loop that represents a district system.</span>

<span class="sd">    It connects buildings as a shared sink/source for heat pumps.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::PlantLoop] the ambient loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create ambient loop</span>
    <span class="n">ambient_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;Ambient Loop&#39;</span> <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">ambient_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># ambient loop sizing and controls</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">setMinimumLoopTemperature</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">setMaximumLoopTemperature</span><span class="p">(</span><span class="mf">80.0</span><span class="p">)</span>

    <span class="n">amb_high_temp_f</span> <span class="o">=</span> <span class="mi">90</span>  <span class="c1"># Supplemental cooling below 65F</span>
    <span class="n">amb_low_temp_f</span> <span class="o">=</span> <span class="mi">41</span>  <span class="c1"># Supplemental heat below 41F</span>
    <span class="n">amb_temp_sizing_f</span> <span class="o">=</span> <span class="mf">102.2</span>  <span class="c1"># CW sized to deliver 102.2F</span>
    <span class="n">amb_delta_t_r</span> <span class="o">=</span> <span class="mf">19.8</span>  <span class="c1"># 19.8F delta-T</span>
    <span class="n">amb_high_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">amb_high_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">amb_low_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">amb_low_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">amb_temp_sizing_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">amb_temp_sizing_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">amb_delta_t_k</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">amb_delta_t_r</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">amb_high_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">amb_high_temp_c</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Ambient Loop High Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amb_high_temp_f</span><span class="p">),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">amb_low_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">amb_low_temp_c</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Ambient Loop Low Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amb_low_temp_f</span><span class="p">),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>

    <span class="n">amb_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduledDualSetpoint</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">amb_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Water Setpoint Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">amb_stpt_manager</span><span class="o">.</span><span class="n">setHighSetpointSchedule</span><span class="p">(</span><span class="n">amb_high_temp_sch</span><span class="p">)</span>
    <span class="n">amb_stpt_manager</span><span class="o">.</span><span class="n">setLowSetpointSchedule</span><span class="p">(</span><span class="n">amb_low_temp_sch</span><span class="p">)</span>
    <span class="n">amb_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ambient_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="n">sizing_plant</span> <span class="o">=</span> <span class="n">ambient_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopType</span><span class="p">(</span><span class="s1">&#39;Heating&#39;</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span><span class="n">amb_temp_sizing_c</span><span class="p">)</span>
    <span class="n">sizing_plant</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span><span class="n">amb_delta_t_k</span><span class="p">)</span>

    <span class="c1"># create pump</span>
    <span class="n">pump</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PumpVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">setRatedPumpHead</span><span class="p">(</span><span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">60.0</span> <span class="o">*</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">setPumpControlType</span><span class="p">(</span><span class="s1">&#39;Intermittent&#39;</span><span class="p">)</span>
    <span class="n">pump</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ambient_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># cooling</span>
    <span class="n">district_cooling</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictCooling</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">district_cooling</span><span class="o">.</span><span class="n">setNominalCapacity</span><span class="p">(</span><span class="mi">1000000000000</span><span class="p">)</span>  <span class="c1"># large number; no autosizing</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">district_cooling</span><span class="p">)</span>

    <span class="c1"># heating</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.7.0&#39;</span><span class="p">):</span>
        <span class="n">district_heating</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeating</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">district_heating</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">DistrictHeatingWater</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">district_heating</span><span class="o">.</span><span class="n">setNominalCapacity</span><span class="p">(</span><span class="mi">1000000000000</span><span class="p">)</span>  <span class="c1"># large number; no autosizing</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">district_heating</span><span class="p">)</span>

    <span class="c1"># add ambient water loop pipes</span>
    <span class="n">supply_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">supply_bypass_pipe</span><span class="p">)</span>

    <span class="n">demand_bypass_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_bypass_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Bypass&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">ambient_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">demand_bypass_pipe</span><span class="p">)</span>

    <span class="n">supply_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">supply_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ambient_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">)</span>

    <span class="n">demand_inlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Inlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">demand_inlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ambient_loop</span><span class="o">.</span><span class="n">demandInletNode</span><span class="p">)</span>

    <span class="n">demand_outlet_pipe</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">PipeAdiabatic</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Demand Outlet&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">demand_outlet_pipe</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">ambient_loop</span><span class="o">.</span><span class="n">demandOutletNode</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ambient_loop</span></div>



<div class="viewcode-block" id="model_add_doas_cold_supply">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_doas_cold_supply">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_doas_cold_supply</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_oa_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_frac_oa_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fan_maximum_flow_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">econo_ctrl_mthd</span><span class="o">=</span><span class="s1">&#39;FixedDryBulb&#39;</span><span class="p">,</span>
        <span class="n">energy_recovery</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clg_dsgn_sup_air_temp</span><span class="o">=</span><span class="mf">55.0</span><span class="p">,</span> <span class="n">htg_dsgn_sup_air_temp</span><span class="o">=</span><span class="mf">60.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a DOAS system with cold supply and terminal units for each zone.</span>

<span class="sd">    This is the default DOAS system for DOE prototype buildings.</span>
<span class="sd">    Use model_add_doas for other DOAS systems.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to connect</span>
<span class="sd">            to heating and zone fan coils.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop to</span>
<span class="sd">            connect to cooling coil.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule, default is always on.</span>
<span class="sd">        min_oa_sch: [String] name of the minimum outdoor air schedule, default</span>
<span class="sd">            is always on.</span>
<span class="sd">        min_frac_oa_sch: [String] name of the minimum fraction of outdoor air</span>
<span class="sd">            schedule, default is always on.</span>
<span class="sd">        fan_maximum_flow_rate: [Double] fan maximum flow rate in cfm, default</span>
<span class="sd">            is autosize.</span>
<span class="sd">        econo_ctrl_mthd: [String] economizer control type, default is Fixed Dry Bulb.</span>
<span class="sd">        energy_recovery: [Boolean] if true, an ERV will be added to the system.</span>
<span class="sd">        clg_dsgn_sup_air_temp: [Double] design cooling supply air temperature</span>
<span class="sd">            in degrees Fahrenheit, default 65F.</span>
<span class="sd">        htg_dsgn_sup_air_temp: [Double] design heating supply air temperature</span>
<span class="sd">            in degrees Fahrenheit, default 75F.</span>

<span class="sd">    Returns:</span>
<span class="sd">        [OpenStudio::Model::AirLoopHVAC] the resulting DOAS air loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check the total OA requirement for all zones on the system</span>
    <span class="n">tot_oa_req</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">tot_oa_req</span> <span class="o">+=</span> <span class="n">thermal_zone_get_outdoor_airflow_rate</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tot_oa_req</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># If the total OA requirement is zero do not add the DOAS system</span>
    <span class="c1"># because the simulations will fail</span>
    <span class="k">if</span> <span class="n">tot_oa_req</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># create a DOAS air loop</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone DOAS&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># set availability schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># DOAS design temperatures</span>
    <span class="n">clg_dsgn_sup_air_temp</span> <span class="o">=</span> <span class="mf">55.0</span> <span class="k">if</span> <span class="n">clg_dsgn_sup_air_temp</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">clg_dsgn_sup_air_temp</span>
    <span class="n">clg_dsgn_sup_air_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">clg_dsgn_sup_air_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">htg_dsgn_sup_air_temp</span> <span class="o">=</span> <span class="mf">60.0</span> <span class="k">if</span> <span class="n">htg_dsgn_sup_air_temp</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">htg_dsgn_sup_air_temp</span>
    <span class="n">htg_dsgn_sup_air_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">htg_dsgn_sup_air_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># modify system sizing properties</span>
    <span class="n">sizing_system</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">sizingSystem</span><span class="p">()</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setTypeofLoadtoSizeOn</span><span class="p">(</span><span class="s1">&#39;VentilationRequirement&#39;</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinCooling</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinHeating</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># set minimum airflow ratio to 1.0 to avoid under-sizing heating coil</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setMinimumSystemAirFlowRatio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralHeatingMaximumSystemAirFlowRatio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setSizingOption</span><span class="p">(</span><span class="s1">&#39;Coincident&#39;</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralCoolingDesignSupplyAirTemperature</span><span class="p">(</span><span class="n">clg_dsgn_sup_air_temp_c</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralHeatingDesignSupplyAirTemperature</span><span class="p">(</span><span class="n">htg_dsgn_sup_air_temp_c</span><span class="p">)</span>

    <span class="c1"># create supply fan</span>
    <span class="n">supply_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Constant_DOAS_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;DOAS Supply Fan&#39;</span><span class="p">,</span>
        <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;DOAS Fans&#39;</span><span class="p">)</span>
    <span class="n">supply_fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">fan_maximum_flow_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fan_max_fr</span> <span class="o">=</span> <span class="n">FLOW_RATE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">fan_maximum_flow_rate</span><span class="p">],</span> <span class="s1">&#39;m3/s&#39;</span><span class="p">,</span> <span class="s1">&#39;cfm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setMaximumFlowRate</span><span class="p">(</span><span class="n">fan_max_fr</span><span class="p">)</span>
    <span class="n">supply_fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create heating coil</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># electric backup heating coil</span>
        <span class="n">create_coil_heating_electric</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="c1"># heat pump coil</span>
        <span class="n">create_coil_heating_dx_single_speed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_heating_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="n">controller_convergence_tolerance</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>

    <span class="c1"># create cooling coil</span>
    <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;OS default&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_cooling_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># minimum outdoor air schedule</span>
    <span class="k">if</span> <span class="n">min_oa_sch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">min_oa_sch</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_oa_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">min_oa_sch</span><span class="p">)</span>

    <span class="c1"># minimum outdoor air fraction schedule</span>
    <span class="k">if</span> <span class="n">min_frac_oa_sch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">min_frac_oa_sch</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_frac_oa_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">min_frac_oa_sch</span><span class="p">)</span>

    <span class="c1"># create controller outdoor air</span>
    <span class="n">controller_oa</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setEconomizerControlType</span><span class="p">(</span><span class="n">econo_ctrl_mthd</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">min_oa_sch</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setMinimumFractionofOutdoorAirSchedule</span><span class="p">(</span><span class="n">min_frac_oa_sch</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetEconomizerMaximumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetEconomizerMaximumLimitEnthalpy</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetMaximumFractionofOutdoorAirSchedule</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setHeatRecoveryBypassControlType</span><span class="p">(</span><span class="s1">&#39;BypassWhenWithinEconomizerLimits&#39;</span><span class="p">)</span>

    <span class="c1"># create outdoor air system</span>
    <span class="n">oa_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">controller_oa</span><span class="p">)</span>
    <span class="n">oa_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create a setpoint manager</span>
    <span class="n">sat_oa_reset</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerOutdoorAirReset</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> SAT Reset&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setControlVariable</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setSetpointatOutdoorLowTemperature</span><span class="p">(</span><span class="n">htg_dsgn_sup_air_temp_c</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setOutdoorLowTemperature</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">60.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setSetpointatOutdoorHighTemperature</span><span class="p">(</span><span class="n">clg_dsgn_sup_air_temp_c</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setOutdoorHighTemperature</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">70.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

    <span class="c1"># add energy recovery if requested</span>
    <span class="k">if</span> <span class="n">energy_recovery</span><span class="p">:</span>
        <span class="c1"># create the ERV and set its properties</span>
        <span class="n">erv</span> <span class="o">=</span> <span class="n">create_hx_air_to_air_sensible_and_latent</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV HX&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Rotary&quot;</span><span class="p">,</span> <span class="n">economizer_lockout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">sensible_heating_100_eff</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">latent_heating_100_eff</span><span class="o">=</span><span class="mf">0.68</span><span class="p">,</span>
            <span class="n">sensible_cooling_100_eff</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">latent_cooling_100_eff</span><span class="o">=</span><span class="mf">0.68</span><span class="p">)</span>
        <span class="n">erv</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">oa_system</span><span class="o">.</span><span class="n">outboardOANode</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="c1"># increase fan static pressure to account for ERV</span>
        <span class="n">erv_pressure_rise</span> <span class="o">=</span> <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">new_pressure_rise</span> <span class="o">=</span> <span class="n">supply_fan</span><span class="o">.</span><span class="n">pressureRise</span><span class="p">()</span> <span class="o">+</span> <span class="n">erv_pressure_rise</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setPressureRise</span><span class="p">(</span><span class="n">new_pressure_rise</span><span class="p">)</span>

    <span class="c1"># add thermal zones to airloop</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="c1"># make an air terminal for the zone</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">air_terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Air Terminal&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>

        <span class="c1"># attach new terminal to the zone and to the airloop</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">air_terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="c1"># DOAS sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setAccountforDedicatedOutdoorAirSystem</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirSystemControlStrategy</span><span class="p">(</span><span class="s1">&#39;ColdSupplyAir&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirLowSetpointTemperatureforDesign</span><span class="p">(</span>
            <span class="n">clg_dsgn_sup_air_temp_c</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirHighSetpointTemperatureforDesign</span><span class="p">(</span>
            <span class="n">htg_dsgn_sup_air_temp_c</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>



<div class="viewcode-block" id="model_add_doas">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_doas">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_doas</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doas_type</span><span class="o">=</span><span class="s1">&#39;DOASCV&#39;</span><span class="p">,</span>
        <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">min_oa_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_frac_oa_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fan_maximum_flow_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">econo_ctrl_mthd</span><span class="o">=</span><span class="s1">&#39;NoEconomizer&#39;</span><span class="p">,</span> <span class="n">include_exhaust_fan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">demand_control_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doas_control_strategy</span><span class="o">=</span><span class="s1">&#39;NeutralSupplyAir&#39;</span><span class="p">,</span>
        <span class="n">clg_dsgn_sup_air_temp</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">htg_dsgn_sup_air_temp</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">energy_recovery</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a DOAS system with terminal units for each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        doas_type: [String] DOASCV or DOASVAV, determines whether the DOAS is</span>
<span class="sd">            operated at scheduled, constant flow rate, or airflow is variable to</span>
<span class="sd">            allow for economizing or demand controlled ventilation.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to connect</span>
<span class="sd">            to heating and zone fan coils.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop to</span>
<span class="sd">            connect to cooling coil.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule, default is</span>
<span class="sd">            always on.</span>
<span class="sd">        min_oa_sch: [String] name of the minimum outdoor air schedule, default is</span>
<span class="sd">            always on.</span>
<span class="sd">        min_frac_oa_sch: [String] name of the minimum fraction of outdoor air</span>
<span class="sd">            schedule, default is always on.</span>
<span class="sd">        fan_maximum_flow_rate: [Double] fan maximum flow rate in cfm, default</span>
<span class="sd">            is autosize.</span>
<span class="sd">        econo_ctrl_mthd: [String] economizer control type, default is Fixed Dry Bulb.</span>
<span class="sd">            If enabled, the DOAS will be sized for twice the ventilation minimum</span>
<span class="sd">            to allow economizing.</span>
<span class="sd">        include_exhaust_fan: [Boolean] if true, include an exhaust fan.</span>
<span class="sd">        demand_control_ventilation: [Boolean] if true, include demand controlled</span>
<span class="sd">            ventilation controls and variable volume fans.</span>
<span class="sd">        doas_control_strategy: [String] DOAS control strategy. Valid options</span>
<span class="sd">            include NeutralSupplyAir and ColdSupplyAir.</span>
<span class="sd">        clg_dsgn_sup_air_temp: [Double] design cooling supply air temperature in</span>
<span class="sd">            degrees Fahrenheit, default 65F.</span>
<span class="sd">        htg_dsgn_sup_air_temp: [Double] design heating supply air temperature in</span>
<span class="sd">            degrees Fahrenheit, default 75F.</span>
<span class="sd">        energy_recovery: [Boolean] if true, an ERV will be added to the system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check the total OA requirement for all zones on the system</span>
    <span class="n">tot_oa_req</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">tot_oa_req</span> <span class="o">+=</span> <span class="n">thermal_zone_get_outdoor_airflow_rate</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tot_oa_req</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># If the total OA requirement is zero do not add the DOAS system</span>
    <span class="c1"># because the simulations will fail</span>
    <span class="k">if</span> <span class="n">tot_oa_req</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># create a DOAS air loop</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone DOAS&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># set availability schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># DOAS design temperatures</span>
    <span class="n">clg_dsgn_sup_air_temp</span> <span class="o">=</span> <span class="mf">60.0</span> <span class="k">if</span> <span class="n">clg_dsgn_sup_air_temp</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">clg_dsgn_sup_air_temp</span>
    <span class="n">clg_dsgn_sup_air_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">clg_dsgn_sup_air_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">htg_dsgn_sup_air_temp</span> <span class="o">=</span> <span class="mf">70.0</span> <span class="k">if</span> <span class="n">htg_dsgn_sup_air_temp</span> <span class="ow">is</span> <span class="kc">None</span> \
        <span class="k">else</span> <span class="n">htg_dsgn_sup_air_temp</span>
    <span class="n">htg_dsgn_sup_air_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">htg_dsgn_sup_air_temp</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># modify system sizing properties</span>
    <span class="n">sizing_system</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">sizingSystem</span><span class="p">()</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setTypeofLoadtoSizeOn</span><span class="p">(</span><span class="s1">&#39;VentilationRequirement&#39;</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinCooling</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinHeating</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># set minimum airflow ratio to 1.0 to avoid under-sizing heating coil</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setMinimumSystemAirFlowRatio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralHeatingMaximumSystemAirFlowRatio</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setSizingOption</span><span class="p">(</span><span class="s1">&#39;Coincident&#39;</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralCoolingDesignSupplyAirTemperature</span><span class="p">(</span><span class="n">clg_dsgn_sup_air_temp_c</span><span class="p">)</span>
    <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralHeatingDesignSupplyAirTemperature</span><span class="p">(</span><span class="n">htg_dsgn_sup_air_temp_c</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">doas_type</span> <span class="o">==</span> <span class="s1">&#39;DOASCV&#39;</span><span class="p">:</span>
        <span class="n">supply_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Constant_DOAS_Fan&#39;</span><span class="p">,</span>
                                        <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;DOAS Supply Fan&#39;</span><span class="p">,</span>
                                        <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;DOAS Fans&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># DOASVAV</span>
        <span class="n">supply_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Variable_DOAS_Fan&#39;</span><span class="p">,</span>
                                        <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;DOAS Supply Fan&#39;</span><span class="p">,</span>
                                        <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;DOAS Fans&#39;</span><span class="p">)</span>

    <span class="n">supply_fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">fan_maximum_flow_rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fan_max_fr</span> <span class="o">=</span> <span class="n">FLOW_RATE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">fan_maximum_flow_rate</span><span class="p">],</span> <span class="s1">&#39;m3/s&#39;</span><span class="p">,</span> <span class="s1">&#39;cfm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setMaximumFlowRate</span><span class="p">(</span><span class="n">fan_max_fr</span><span class="p">)</span>
    <span class="n">supply_fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create heating coil</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># electric backup heating coil</span>
        <span class="n">create_coil_heating_electric</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="c1"># heat pump coil</span>
        <span class="n">create_coil_heating_dx_single_speed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_heating_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="n">controller_convergence_tolerance</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>

    <span class="c1"># create cooling coil</span>
    <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;OS default&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_cooling_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># minimum outdoor air schedule</span>
    <span class="k">if</span> <span class="n">min_oa_sch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">min_oa_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">min_oa_sch</span><span class="p">)</span>

    <span class="c1"># minimum outdoor air fraction schedule</span>
    <span class="k">if</span> <span class="n">min_frac_oa_sch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">min_frac_oa_sch</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_frac_oa_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">min_frac_oa_sch</span><span class="p">)</span>

    <span class="c1"># create controller outdoor air</span>
    <span class="n">controller_oa</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Outdoor Air Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setEconomizerControlType</span><span class="p">(</span><span class="n">econo_ctrl_mthd</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">min_oa_sch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_oa_sch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">controller_oa</span><span class="o">.</span><span class="n">setMinimumFractionofOutdoorAirSchedule</span><span class="p">(</span><span class="n">min_frac_oa_sch</span><span class="p">)</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetEconomizerMaximumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetEconomizerMaximumLimitEnthalpy</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">resetMaximumFractionofOutdoorAirSchedule</span><span class="p">()</span>
    <span class="n">controller_oa</span><span class="o">.</span><span class="n">setHeatRecoveryBypassControlType</span><span class="p">(</span><span class="s1">&#39;BypassWhenWithinEconomizerLimits&#39;</span><span class="p">)</span>
    <span class="n">controller_mech_vent</span> <span class="o">=</span> <span class="n">controller_oa</span><span class="o">.</span><span class="n">controllerMechanicalVentilation</span><span class="p">()</span>
    <span class="n">controller_mech_vent</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Mechanical Ventilation Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">demand_control_ventilation</span><span class="p">:</span>
        <span class="n">controller_mech_vent</span><span class="o">.</span><span class="n">setDemandControlledVentilation</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">controller_mech_vent</span><span class="o">.</span><span class="n">setSystemOutdoorAirMethod</span><span class="p">(</span><span class="s1">&#39;ZoneSum&#39;</span><span class="p">)</span>

    <span class="c1"># create outdoor air system</span>
    <span class="n">oa_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">controller_oa</span><span class="p">)</span>
    <span class="n">oa_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create an exhaust fan</span>
    <span class="k">if</span> <span class="n">include_exhaust_fan</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">doas_type</span> <span class="o">==</span> <span class="s1">&#39;DOASCV&#39;</span><span class="p">:</span>
            <span class="n">exhaust_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Constant_DOAS_Fan&#39;</span><span class="p">,</span>
                                             <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;DOAS Exhaust Fan&#39;</span><span class="p">,</span>
                                             <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;DOAS Fans&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># &#39;DOASVAV&#39;</span>
            <span class="n">exhaust_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Variable_DOAS_Fan&#39;</span><span class="p">,</span>
                                             <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;DOAS Exhaust Fan&#39;</span><span class="p">,</span>
                                             <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;DOAS Fans&#39;</span><span class="p">)</span>
        <span class="c1"># set pressure rise 1.0 inH2O lower than supply fan, 1.0 inH2O minimum</span>
        <span class="n">in_h20</span> <span class="o">=</span> <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">exhaust_fan_pressure_rise</span> <span class="o">=</span> <span class="n">supply_fan</span><span class="o">.</span><span class="n">pressureRise</span><span class="p">()</span> <span class="o">-</span> <span class="n">in_h20</span>
        <span class="k">if</span> <span class="n">exhaust_fan_pressure_rise</span> <span class="o">&lt;</span> <span class="n">in_h20</span><span class="p">:</span>
            <span class="n">exhaust_fan_pressure_rise</span> <span class="o">=</span> <span class="n">in_h20</span>
        <span class="n">exhaust_fan</span><span class="o">.</span><span class="n">setPressureRise</span><span class="p">(</span><span class="n">exhaust_fan_pressure_rise</span><span class="p">)</span>
        <span class="n">exhaust_fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create a setpoint manager</span>
    <span class="n">sat_oa_reset</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerOutdoorAirReset</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> SAT Reset&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setControlVariable</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setSetpointatOutdoorLowTemperature</span><span class="p">(</span><span class="n">htg_dsgn_sup_air_temp_c</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setOutdoorLowTemperature</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">55.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setSetpointatOutdoorHighTemperature</span><span class="p">(</span><span class="n">clg_dsgn_sup_air_temp_c</span><span class="p">)</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">setOutdoorHighTemperature</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">70.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sat_oa_reset</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAnyZoneFansOnly&#39;</span><span class="p">)</span>

    <span class="c1"># add energy recovery if requested</span>
    <span class="k">if</span> <span class="n">energy_recovery</span><span class="p">:</span>
        <span class="c1"># create the ERV and set its properties</span>
        <span class="n">erv</span> <span class="o">=</span> <span class="n">create_hx_air_to_air_sensible_and_latent</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV HX&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Rotary&quot;</span><span class="p">,</span> <span class="n">economizer_lockout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">sensible_heating_100_eff</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">latent_heating_100_eff</span><span class="o">=</span><span class="mf">0.68</span><span class="p">,</span>
            <span class="n">sensible_cooling_100_eff</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">latent_cooling_100_eff</span><span class="o">=</span><span class="mf">0.68</span><span class="p">,)</span>
        <span class="n">erv</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">oa_system</span><span class="o">.</span><span class="n">outboardOANode</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="c1"># increase fan static pressure to account for ERV</span>
        <span class="n">erv_pressure_rise</span> <span class="o">=</span> <span class="n">PRESSURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;inH2O&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">new_pressure_rise</span> <span class="o">=</span> <span class="n">supply_fan</span><span class="o">.</span><span class="n">pressureRise</span><span class="p">()</span> <span class="o">+</span> <span class="n">erv_pressure_rise</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setPressureRise</span><span class="p">(</span><span class="n">new_pressure_rise</span><span class="p">)</span>

    <span class="c1"># add thermal zones to airloop</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="c1"># skip zones with no outdoor air flow rate</span>
        <span class="k">if</span> <span class="n">thermal_zone_get_outdoor_airflow_rate</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># make an air terminal for the zone</span>
        <span class="k">if</span> <span class="n">doas_type</span> <span class="o">==</span> <span class="s1">&#39;DOASCV&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
                <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">doas_type</span> <span class="o">==</span> <span class="s1">&#39;DOASVAVReheat&#39;</span><span class="p">:</span>
            <span class="c1"># Reheat coil</span>
            <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

            <span class="c1"># VAV reheat terminal</span>
            <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctVAVReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">rht_coil</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.0.1&#39;</span><span class="p">):</span>
                <span class="n">air_terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">air_terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowInputMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">demand_control_ventilation</span><span class="p">:</span>
                <span class="n">air_terminal</span><span class="o">.</span><span class="n">setControlForOutdoorAir</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># DOASVAV</span>
            <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctVAVNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.0.1&#39;</span><span class="p">):</span>
                <span class="n">air_terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">air_terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowInputMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="n">air_terminal</span><span class="o">.</span><span class="n">setConstantMinimumAirFlowFraction</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">demand_control_ventilation</span><span class="p">:</span>
                <span class="n">air_terminal</span><span class="o">.</span><span class="n">setControlForOutdoorAir</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">air_terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Air Terminal&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="c1"># attach new terminal to the zone and to the airloop</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">air_terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="c1"># ensure the DOAS takes priority, so ventilation load is included when</span>
        <span class="c1"># treated by other zonal systems</span>
        <span class="n">zone</span><span class="o">.</span><span class="n">setCoolingPriority</span><span class="p">(</span><span class="n">air_terminal</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">zone</span><span class="o">.</span><span class="n">setHeatingPriority</span><span class="p">(</span><span class="n">air_terminal</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># set the cooling and heating fraction to zero so that if DCV is enabled,</span>
        <span class="c1"># the system will lower the ventilation rate rather than trying to meet</span>
        <span class="c1"># the heating or cooling load.</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.8.0&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">demand_control_ventilation</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Unable to add DOAS with DCV to model because the &#39;</span> \
                    <span class="s1">&#39;setSequentialCoolingFraction method is not available in &#39;</span> \
                    <span class="s1">&#39;OpenStudio versions less than 2.8.0.&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">zone</span><span class="o">.</span><span class="n">setSequentialCoolingFraction</span><span class="p">(</span><span class="n">air_terminal</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="n">zone</span><span class="o">.</span><span class="n">setSequentialHeatingFraction</span><span class="p">(</span><span class="n">air_terminal</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="c1"># if economizing, override to meet cooling load first with doas supply</span>
            <span class="k">if</span> <span class="n">econo_ctrl_mthd</span> <span class="o">!=</span> <span class="s1">&#39;NoEconomizer&#39;</span><span class="p">:</span>
                <span class="n">zone</span><span class="o">.</span><span class="n">setSequentialCoolingFraction</span><span class="p">(</span><span class="n">air_terminal</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># DOAS sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setAccountforDedicatedOutdoorAirSystem</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirSystemControlStrategy</span><span class="p">(</span><span class="n">doas_control_strategy</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirLowSetpointTemperatureforDesign</span><span class="p">(</span><span class="n">clg_dsgn_sup_air_temp_c</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirHighSetpointTemperatureforDesign</span><span class="p">(</span><span class="n">htg_dsgn_sup_air_temp_c</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>



<div class="viewcode-block" id="model_add_vav_reheat">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vav_reheat">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_vav_reheat</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_plenum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">reheat_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
        <span class="n">min_sys_airflow_ratio</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">vav_sizing_option</span><span class="o">=</span><span class="s1">&#39;Coincident&#39;</span><span class="p">,</span> <span class="n">econo_ctrl_mthd</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a VAV system and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        return_plenum: [OpenStudio::Model::ThermalZone] the zone to attach as</span>
<span class="sd">            the supply plenum, or None, in which case no return plenum will be used.</span>
<span class="sd">        heating_type: [String] main heating coil fuel type. valid choices are</span>
<span class="sd">            NaturalGas, Gas, Electricity, HeatPump, DistrictHeating,</span>
<span class="sd">            DistrictHeatingWater, DistrictHeatingSteam, or None (defaults to NaturalGas).</span>
<span class="sd">        reheat_type: [String] valid options are NaturalGas, Gas, Electricity</span>
<span class="sd">            Water, None (no heat).</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to connect</span>
<span class="sd">            heating and reheat coils to.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop</span>
<span class="sd">            to connect cooling coil to.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in</span>
<span class="sd">            which case will be defaulted to always on.</span>
<span class="sd">        oa_damper_sch: [String] name of the oa damper schedule, or None in</span>
<span class="sd">            which case will be defaulted to always open.</span>
<span class="sd">        fan_efficiency: [Double] fan total efficiency, including motor and impeller.</span>
<span class="sd">        fan_motor_efficiency: [Double] fan motor efficiency.</span>
<span class="sd">        fan_pressure_rise: [Double] fan pressure rise, inH2O.</span>
<span class="sd">        min_sys_airflow_ratio: [Double] minimum system airflow ratio.</span>
<span class="sd">        vav_sizing_option: [String] air system sizing option, Coincident or NonCoincident.</span>
<span class="sd">        econo_ctrl_mthd: [String] economizer control type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create air handler</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone VAV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># set availability schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># oa damper schedule</span>
    <span class="k">if</span> <span class="n">oa_damper_sch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oa_damper_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="p">)</span>

    <span class="c1"># default design temperatures and settings used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>
    <span class="n">sizing_system</span> <span class="o">=</span> <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_sys_airflow_ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">sizing_system</span><span class="o">.</span><span class="n">setMinimumSystemAirFlowRatio</span><span class="p">(</span><span class="n">min_sys_airflow_ratio</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sizing_system</span><span class="o">.</span><span class="n">setCentralHeatingMaximumSystemAirFlowRatio</span><span class="p">(</span><span class="n">min_sys_airflow_ratio</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vav_sizing_option</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setSizingOption</span><span class="p">(</span><span class="n">vav_sizing_option</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hw_temp_c</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">designLoopExitTemperature</span><span class="p">()</span>
        <span class="n">hw_delta_t_k</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">loopDesignTemperatureDifference</span><span class="p">()</span>

    <span class="c1"># air handler controls</span>
    <span class="n">sa_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Supply Air Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sa_temp_sch</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Air Setpoint Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create fan</span>
    <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;VAV_System_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
        <span class="n">fan_efficiency</span><span class="o">=</span><span class="n">fan_efficiency</span><span class="p">,</span> <span class="n">pressure_rise</span><span class="o">=</span><span class="n">fan_pressure_rise</span><span class="p">,</span>
        <span class="n">motor_efficiency</span><span class="o">=</span><span class="n">fan_motor_efficiency</span><span class="p">,</span> <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;VAV System Fans&#39;</span><span class="p">)</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create heating coil</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Electric Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># default to NaturalGas</span>
            <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Gas Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_heating_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span><span class="p">,</span>
            <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span> <span class="o">-</span> <span class="n">hw_delta_t_k</span><span class="p">,</span>
            <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;prehtg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
            <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

    <span class="c1"># create cooling coil</span>
    <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                                         <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                                         <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;OS default&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_cooling_water</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span>
                                  <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># outdoor air intake system</span>
    <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetMaximumFractionofOutdoorAirSchedule</span><span class="p">()</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">econo_ctrl_mthd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setEconomizerControlType</span><span class="p">(</span><span class="n">econo_ctrl_mthd</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oa_damper_sch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">oa_damper_sch</span><span class="p">)</span>
    <span class="n">controller_mv</span> <span class="o">=</span> <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">controllerMechanicalVentilation</span><span class="p">()</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Vent Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setSystemOutdoorAirMethod</span><span class="p">(</span><span class="s1">&#39;ZoneSum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
        <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">availabilityManager</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">availabilityManagers</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">avail_mgr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
            <span class="n">avail_mgr</span><span class="o">.</span><span class="n">to_AvailabilityManagerNightCycle</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">to_AvailabilityManagerNightCycle</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">avail_mgr</span><span class="o">.</span><span class="n">setCyclingRunTime</span><span class="p">(</span><span class="mi">1800</span><span class="p">)</span>

    <span class="c1"># hook the VAV system to each zone</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="c1"># create reheat coil</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">reheat_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Gas Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">reheat_type</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">reheat_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span><span class="p">,</span>
                <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="p">(</span><span class="n">hw_temp_c</span> <span class="o">-</span> <span class="n">hw_delta_t_k</span><span class="p">),</span>
                <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
                <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># no reheat</span>

        <span class="c1"># set zone reheat temperatures depending on reheat</span>
        <span class="k">if</span> <span class="n">reheat_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Water&#39;</span><span class="p">):</span>
            <span class="c1"># create vav terminal</span>
            <span class="n">terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctVAVReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">rht_coil</span><span class="p">)</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> VAV Terminal&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.0.1&#39;</span><span class="p">):</span>
                <span class="n">terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowInputMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="c1"># default to single maximum control logic</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setDamperHeatingAction</span><span class="p">(</span><span class="s1">&#39;Normal&#39;</span><span class="p">)</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setMaximumReheatAirTemperature</span><span class="p">(</span>
                <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
            <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="c1"># air_terminal_single_duct_vav_reheat_apply_initial_prototype_damper_position</span>
            <span class="n">min_damper_position</span> <span class="o">=</span> <span class="mf">0.3</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setConstantMinimumAirFlowFraction</span><span class="p">(</span><span class="n">min_damper_position</span><span class="p">)</span>
            <span class="c1"># zone sizing</span>
            <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
            <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setCoolingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDayWithLimit&#39;</span><span class="p">)</span>
            <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setHeatingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDay&#39;</span><span class="p">)</span>
            <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
                <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
            <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
                <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no reheat</span>
            <span class="c1"># create vav terminal</span>
            <span class="n">terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctVAVNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> VAV Terminal&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.0.1&#39;</span><span class="p">):</span>
                <span class="n">terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowInputMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
            <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="c1"># air_terminal_single_duct_vav_reheat_apply_initial_prototype_damper_position</span>
            <span class="n">min_damper_position</span> <span class="o">=</span> <span class="mf">0.3</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setConstantMinimumAirFlowFraction</span><span class="p">(</span><span class="n">min_damper_position</span><span class="p">)</span>
            <span class="c1"># zone sizing</span>
            <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
            <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setCoolingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDayWithLimit&#39;</span><span class="p">)</span>
            <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
                <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">return_plenum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">zone</span><span class="o">.</span><span class="n">setReturnPlenum</span><span class="p">(</span><span class="n">return_plenum</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>



<div class="viewcode-block" id="model_add_vav_pfp_boxes">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vav_pfp_boxes">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_vav_pfp_boxes</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a VAV system with parallel fan powered boxes and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop to</span>
<span class="sd">            connect to the cooling coil.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in which</span>
<span class="sd">            case will be defaulted to always on.</span>
<span class="sd">        oa_damper_sch: [String] name of the oa damper schedule or None in which</span>
<span class="sd">            case will be defaulted to always open.</span>
<span class="sd">        fan_efficiency: [Double] fan total efficiency, including motor and impeller.</span>
<span class="sd">        fan_motor_efficiency: [Double] fan motor efficiency.</span>
<span class="sd">        fan_pressure_rise: [Double] fan pressure rise, inH2O.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create air handler</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone VAV with PFP Boxes and Reheat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># oa damper schedule</span>
    <span class="n">oa_damper_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="p">)</span>

    <span class="c1"># default design temperatures and settings used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>
    <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">)</span>

    <span class="c1"># air handler controls</span>
    <span class="n">sa_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Supply Air Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sa_temp_sch</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Air Setpoint Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create fan</span>
    <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;VAV_System_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
        <span class="n">fan_efficiency</span><span class="o">=</span><span class="n">fan_efficiency</span><span class="p">,</span> <span class="n">pressure_rise</span><span class="o">=</span><span class="n">fan_pressure_rise</span><span class="p">,</span>
        <span class="n">motor_efficiency</span><span class="o">=</span><span class="n">fan_motor_efficiency</span><span class="p">,</span> <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;VAV System Fans&#39;</span><span class="p">)</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create heating coil</span>
    <span class="n">create_coil_heating_electric</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># create cooling coil</span>
    <span class="n">create_coil_cooling_water</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># create outdoor air intake system</span>
    <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="n">controller_mv</span> <span class="o">=</span> <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">controllerMechanicalVentilation</span><span class="p">()</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Vent Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setSystemOutdoorAirMethod</span><span class="p">(</span><span class="s1">&#39;ZoneSum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

    <span class="c1"># attach the VAV system to each zone</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="c1"># create reheat coil</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="c1"># create terminal fan</span>
        <span class="n">pfp_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;PFP_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PFP Term Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">pfp_fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># create parallel fan powered terminal</span>
        <span class="n">pfp_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctParallelPIUReheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">pfp_fan</span><span class="p">,</span> <span class="n">rht_coil</span><span class="p">)</span>
        <span class="n">pfp_terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PFP Term&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">pfp_terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setCoolingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDay&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setHeatingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDay&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>



<div class="viewcode-block" id="model_add_pvav">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_pvav">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_pvav</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_plenum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">electric_reheat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">econo_ctrl_mthd</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a packaged VAV system and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        return_plenum: [OpenStudio::Model::ThermalZone] the zone to attach as</span>
<span class="sd">            the supply plenum, or None, in which case no return plenum will be used.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to connect</span>
<span class="sd">            heating and reheat coils to. If None, will be electric heat and electric reheat.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop</span>
<span class="sd">            to connect cooling coils to. If None, will be DX cooling.</span>
<span class="sd">        heating_type: [String] main heating coil fuel type. Valid choices are</span>
<span class="sd">            NaturalGas, Electricity, Water, or None (defaults to NaturalGas).</span>
<span class="sd">        electric_reheat: [Boolean] if true electric reheat coils, if false the</span>
<span class="sd">            reheat coils served by hot_water_loop.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in</span>
<span class="sd">            which case will be defaulted to always on.</span>
<span class="sd">        oa_damper_sch: [String] name of the oa damper schedule or None in which</span>
<span class="sd">            case will be defaulted to always open.</span>
<span class="sd">        econo_ctrl_mthd: [String] economizer control type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create air handler</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone PVAV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># oa damper schedule</span>
    <span class="n">oa_damper_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="p">)</span>

    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hw_temp_c</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">designLoopExitTemperature</span><span class="p">()</span>
        <span class="n">hw_delta_t_k</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">loopDesignTemperatureDifference</span><span class="p">()</span>

    <span class="c1"># adjusted zone design heating temperature for pvav unless it would cause</span>
    <span class="c1"># a temperature higher than reheat water supply temperature</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">hw_temp_c</span> <span class="o">&lt;</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">140.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># default design settings used across all air loops</span>
    <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">)</span>

    <span class="c1"># air handler controls</span>
    <span class="n">sa_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Supply Air Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sa_temp_sch</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Air Setpoint Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create fan</span>
    <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;VAV_default&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create heating coil</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Electric Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># default to NaturalGas</span>
            <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Gas Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_heating_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span><span class="p">,</span>
            <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span> <span class="o">-</span> <span class="n">hw_delta_t_k</span><span class="p">,</span>
            <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;prehtg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
            <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

    <span class="c1"># create cooling coil</span>
    <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;OS default&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_cooling_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># outdoor air intake system</span>
    <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetMaximumFractionofOutdoorAirSchedule</span><span class="p">()</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">econo_ctrl_mthd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setEconomizerControlType</span><span class="p">(</span><span class="n">econo_ctrl_mthd</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oa_damper_sch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">oa_damper_sch</span><span class="p">)</span>
    <span class="n">controller_mv</span> <span class="o">=</span> <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">controllerMechanicalVentilation</span><span class="p">()</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Mechanical Ventilation Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setSystemOutdoorAirMethod</span><span class="p">(</span><span class="s1">&#39;ZoneSum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
        <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">availabilityManager</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">availabilityManagers</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">avail_mgr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
            <span class="n">avail_mgr</span><span class="o">.</span><span class="n">to_AvailabilityManagerNightCycle</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">to_AvailabilityManagerNightCycle</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">avail_mgr</span><span class="o">.</span><span class="n">setCyclingRunTime</span><span class="p">(</span><span class="mi">1800</span><span class="p">)</span>

    <span class="c1"># attach the VAV system to each zone</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="c1"># create reheat coil</span>
        <span class="k">if</span> <span class="n">electric_reheat</span> <span class="ow">or</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span><span class="p">,</span>
                <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span> <span class="o">-</span> <span class="n">hw_delta_t_k</span><span class="p">,</span>
                <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
                <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="c1"># create VAV terminal</span>
        <span class="n">terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctVAVReheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">rht_coil</span><span class="p">)</span>
        <span class="n">terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> VAV Terminal&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.0.1&#39;</span><span class="p">):</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">terminal</span><span class="o">.</span><span class="n">setZoneMinimumAirFlowInputMethod</span><span class="p">(</span><span class="s1">&#39;Constant&#39;</span><span class="p">)</span>
        <span class="c1"># default to single maximum control logic</span>
        <span class="n">terminal</span><span class="o">.</span><span class="n">setDamperHeatingAction</span><span class="p">(</span><span class="s1">&#39;Normal&#39;</span><span class="p">)</span>
        <span class="n">terminal</span><span class="o">.</span><span class="n">setMaximumReheatAirTemperature</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="c1"># air_terminal_single_duct_vav_reheat_apply_initial_prototype_damper_position</span>
        <span class="n">min_damper_position</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">terminal</span><span class="o">.</span><span class="n">setConstantMinimumAirFlowFraction</span><span class="p">(</span><span class="n">min_damper_position</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_plenum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">zone</span><span class="o">.</span><span class="n">setReturnPlenum</span><span class="p">(</span><span class="n">return_plenum</span><span class="p">)</span>
        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>



<div class="viewcode-block" id="model_add_pvav_pfp_boxes">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_pvav_pfp_boxes">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_pvav_pfp_boxes</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a packaged VAV system with parallel fan powered boxes.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop</span>
<span class="sd">            to connect cooling coils to. If None, will be DX cooling.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in</span>
<span class="sd">            which case will be defaulted to always on.</span>
<span class="sd">        oa_damper_sch: [String] name of the oa damper schedule or None in</span>
<span class="sd">            which case will be defaulted to always open.</span>
<span class="sd">        fan_efficiency: [Double] fan total efficiency, including motor and impeller.</span>
<span class="sd">        fan_motor_efficiency: [Double] fan motor efficiency.</span>
<span class="sd">        fan_pressure_rise: [Double] fan pressure rise, inH2O.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create air handler</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone PVAV with PFP Boxes and Reheat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">))</span> \
        <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">system_name</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># oa damper schedule</span>
    <span class="n">oa_damper_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="p">)</span>

    <span class="c1"># default design temperatures and settings used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>
    <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">)</span>

    <span class="c1"># air handler controls</span>
    <span class="n">sa_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Supply Air Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]),</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sa_temp_sch</span><span class="p">)</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Air Setpoint Manager&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">sa_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

    <span class="c1"># create fan</span>
    <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;VAV_System_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
        <span class="n">fan_efficiency</span><span class="o">=</span><span class="n">fan_efficiency</span><span class="p">,</span> <span class="n">pressure_rise</span><span class="o">=</span><span class="n">fan_pressure_rise</span><span class="p">,</span>
        <span class="n">motor_efficiency</span><span class="o">=</span><span class="n">fan_motor_efficiency</span><span class="p">,</span> <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;VAV System Fans&#39;</span><span class="p">)</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
    <span class="n">fan</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># create heating coil</span>
    <span class="n">create_coil_heating_electric</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Main Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># create cooling coil</span>
    <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;OS default&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">create_coil_cooling_water</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">air_loop_node</span><span class="o">=</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">(),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

    <span class="c1"># create outdoor air intake system</span>
    <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">oa_damper_sch</span><span class="p">)</span>
    <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
    <span class="n">controller_mv</span> <span class="o">=</span> <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">controllerMechanicalVentilation</span><span class="p">()</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Vent Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">controller_mv</span><span class="o">.</span><span class="n">setSystemOutdoorAirMethod</span><span class="p">(</span><span class="s1">&#39;ZoneSum&#39;</span><span class="p">)</span>

    <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
    <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

    <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
    <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

    <span class="c1"># attach the VAV system to each zone</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="c1"># create electric reheat coil</span>
        <span class="n">rht_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Reheat Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="c1"># create terminal fan</span>
        <span class="n">pfp_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;PFP_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PFP Term Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">pfp_fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># parallel fan powered terminal</span>
        <span class="n">pfp_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctParallelPIUReheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">pfp_fan</span><span class="p">,</span> <span class="n">rht_coil</span><span class="p">)</span>
        <span class="n">pfp_terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s2">&quot;#</span><span class="si">{zone.name}</span><span class="s2"> PFP Term&quot;</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">pfp_terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="c1"># adjust zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setCoolingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDay&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setHeatingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDay&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>



<div class="viewcode-block" id="model_add_psz_ac">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_psz_ac">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_psz_ac</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;Single Speed DX AC&#39;</span><span class="p">,</span>
        <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">supplemental_heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fan_location</span><span class="o">=</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">,</span>
        <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;ConstantVolume&#39;</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a PSZ-AC system for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        cooling_type: [String] valid choices are Water, Two Speed DX AC,</span>
<span class="sd">            Single Speed DX AC, Single Speed Heat Pump, Water To Air Heat Pump.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] chilled water loop</span>
<span class="sd">            to connect cooling coil to, or None.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to</span>
<span class="sd">            connect heating coil to, or None.</span>
<span class="sd">        heating_type: [String] valid choices are NaturalGas, Electricity,</span>
<span class="sd">            Water, Single Speed Heat Pump, Water To Air Heat Pump, or None (no heat).</span>
<span class="sd">        supplemental_heating_type: [String] valid choices are Electricity,</span>
<span class="sd">            NaturalGas, None (no heat).</span>
<span class="sd">        fan_location: [String] valid choices are BlowThrough, DrawThrough.</span>
<span class="sd">        fan_type: [String] valid choices are ConstantVolume, Cycling.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in</span>
<span class="sd">            which case will be defaulted to always on.</span>
<span class="sd">        oa_damper_sch: [String] name of the oa damper schedule or None in</span>
<span class="sd">            which case will be defaulted to always open.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># oa damper schedule</span>
    <span class="n">oa_damper_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="p">)</span>

    <span class="c1"># create a PSZ-AC for each zone</span>
    <span class="n">air_loops</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PSZ-AC&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span> \
            <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">,</span> <span class="n">system_name</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
        <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># default design temperatures and settings used across all air loops</span>
        <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hw_temp_c</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">designLoopExitTemperature</span><span class="p">()</span>
            <span class="n">hw_delta_t_k</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">loopDesignTemperatureDifference</span><span class="p">()</span>

        <span class="c1"># adjusted design heating temperature for psz_ac</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span>

        <span class="c1"># default design settings used across all air loops</span>
        <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">,</span> <span class="n">min_sys_airflow_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># air handler controls</span>
        <span class="c1"># add a setpoint manager single zone reheat to control the supply air temperature</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerSingleZoneReheat</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Setpoint Manager SZ Reheat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setControlZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setMinimumSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="c1"># create heating coil</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Gas Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No hot water plant loop supplied&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span><span class="p">,</span>
                <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span> <span class="o">-</span> <span class="n">hw_delta_t_k</span><span class="p">,</span>
                <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;prehtg_dsgn_sup_air_temp_c&#39;</span><span class="p">],</span>
                <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed Heat Pump&#39;</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> HP Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;PSZ-AC&#39;</span><span class="p">,</span> <span class="n">cop</span><span class="o">=</span><span class="mf">3.3</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water To Air Heat Pump&#39;</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water_to_air_heat_pump_equation_fit</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water-to-Air HP Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">):</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># zero-capacity, always-off electric heating coil</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> No Heat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span>
                <span class="n">nominal_capacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># create supplemental heating coil</span>
        <span class="k">if</span> <span class="n">supplemental_heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">):</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">supplemental_heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Gas Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Zero-capacity, always-off electric heating coil</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> No Heat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span> <span class="n">nominal_capacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># create cooling coil</span>
        <span class="k">if</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No chilled water plant loop supplied&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Two Speed DX AC&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed DX AC&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 1spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;PSZ-AC&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed Heat Pump&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 1spd DX HP Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Heat Pump&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water To Air Heat Pump&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chilled_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No chilled water plant loop supplied&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_water_to_air_heat_pump_equation_fit</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water-to-Air HP Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Use a Fan:OnOff in the unitary system object</span>
        <span class="k">if</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;Cycling&#39;</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Packaged_RTU_SZ_AC_Cycling_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;ConstantVolume&#39;</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Packaged_RTU_SZ_AC_CAV_OnOff_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid PSZ-AC fan_type &quot;</span><span class="si">{}</span><span class="s1">&quot;.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fan_type</span><span class="p">))</span>

        <span class="c1"># fan location</span>
        <span class="n">fan_location</span> <span class="o">=</span> <span class="s1">&#39;DrawThrough&#39;</span> <span class="k">if</span> <span class="n">fan_location</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fan_location</span>
        <span class="k">if</span> <span class="n">fan_location</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">,</span> <span class="s1">&#39;BlowThrough&#39;</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Invalid fan_location </span><span class="si">{}</span><span class="s1"> for fan </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">fan_location</span><span class="p">,</span> <span class="n">fan</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># construct unitary system object</span>
        <span class="n">unitary_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACUnitarySystem</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyFan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setHeatingCoil</span><span class="p">(</span><span class="n">htg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setCoolingCoil</span><span class="p">(</span><span class="n">clg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">supplemental_htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplementalHeatingCoil</span><span class="p">(</span><span class="n">supplemental_htg_coil</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setControllingZoneorThermostatLocation</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="n">fan_location</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># added logic and naming for heat pumps</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water To Air Heat Pump&#39;</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforSupplementalHeaterOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">40.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary HP&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span>
                <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.7.0&#39;</span><span class="p">):</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodDuringCoolingOperation</span><span class="p">(</span>
                    <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodDuringHeatingOperation</span><span class="p">(</span>
                    <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodWhenNoCoolingorHeatingisRequired</span><span class="p">(</span>
                    <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateDuringCoolingOperation</span><span class="p">()</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateDuringHeatingOperation</span><span class="p">()</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed Heat Pump&#39;</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforSupplementalHeaterOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">40.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary HP&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary AC&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

        <span class="c1"># specify control logic</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;Cycling&#39;</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># constant volume operation</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>

        <span class="c1"># add the OA system</span>
        <span class="n">oa_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">oa_damper_sch</span><span class="p">)</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
        <span class="n">oa_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_controller</span><span class="p">)</span>
        <span class="n">oa_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">oa_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">availabilityManager</span><span class="p">()</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">availabilityManagers</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">avail_mgr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                <span class="n">avail_mgr</span><span class="o">.</span><span class="n">to_AvailabilityManagerNightCycle</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">avail_mgr</span> <span class="o">=</span> <span class="n">avail_mgr</span><span class="o">.</span><span class="n">to_AvailabilityManagerNightCycle</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">avail_mgr</span><span class="o">.</span><span class="n">setCyclingRunTime</span><span class="p">(</span><span class="mi">1800</span><span class="p">)</span>

        <span class="c1"># create a diffuser and attach the zone/diffuser pair to the air loop</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">diffuser</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Diffuser&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">diffuser</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">air_loops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">air_loop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">air_loops</span></div>



<div class="viewcode-block" id="model_add_psz_vav">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_psz_vav">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_psz_vav</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">,</span> <span class="n">supplemental_heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;VAV_System_Fan&#39;</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chilled_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimum_volume_setpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a packaged single zone VAV system for each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to connect to this system.</span>
<span class="sd">        system_name: [String] the name of the system, or None in which case it</span>
<span class="sd">            will be defaulted.</span>
<span class="sd">        heating_type: [String] valid choices are NaturalGas, Electricity, Water,</span>
<span class="sd">            None (no heat).</span>
<span class="sd">        supplemental_heating_type: [String] valid choices are Electricity,</span>
<span class="sd">            NaturalGas, None (no heat).</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in</span>
<span class="sd">            which case will be defaulted to always on.</span>
<span class="sd">        oa_damper_sch: [String] name of the oa damper schedule or None in which</span>
<span class="sd">            case will be defaulted to always open.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># oa damper schedule</span>
    <span class="n">oa_damper_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="p">)</span>

    <span class="c1"># create a PSZ-AC for each zone</span>
    <span class="n">air_loops</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">system_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PSZ-VAV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span> \
            <span class="k">if</span> <span class="n">system_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">,</span> <span class="n">system_name</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
        <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># default design temperatures used across all air loops</span>
        <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

        <span class="c1"># adjusted zone design heating temperature for psz_vav</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span>

        <span class="c1"># default design settings used across all air loops</span>
        <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">)</span>

        <span class="c1"># air handler controls</span>
        <span class="c1"># add a setpoint manager single zone reheat to control the supply air temperature</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerSingleZoneReheat</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Setpoint Manager SZ Reheat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setControlZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setMinimumSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">setpoint_mgr_single_zone_reheat</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="c1"># create fan</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fan_type</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                                 <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;VAV System Fans&#39;</span><span class="p">)</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>

        <span class="c1"># create heating coil</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Gas Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">):</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Zero-capacity, always-off electric heating coil</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> No Heat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span> <span class="n">nominal_capacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># create supplemental heating coil</span>
        <span class="k">if</span> <span class="n">supplemental_heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">):</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">supplemental_heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Gas Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># zero-capacity, always-off electric heating coil</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> No Backup Heat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span> <span class="n">nominal_capacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># create cooling coil</span>
        <span class="k">if</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;WaterCooled&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># AirCooled</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoilCoolingDXVariableSpeed</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Var spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setBasinHeaterCapacity</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setBasinHeaterSetpointTemperature</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="c1"># first speed level</span>
            <span class="n">clg_spd_1</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoilCoolingDXVariableSpeedSpeedData</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">addSpeed</span><span class="p">(</span><span class="n">clg_spd_1</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setNominalSpeedLevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># wrap coils in a unitary system</span>
        <span class="n">unitary_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACUnitarySystem</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyFan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setHeatingCoil</span><span class="p">(</span><span class="n">htg_coil</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setCoolingCoil</span><span class="p">(</span><span class="n">clg_coil</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplementalHeatingCoil</span><span class="p">(</span><span class="n">supplemental_htg_coil</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary PSZ-VAV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="c1"># The following control strategy can lead to &quot;Developer Error: Component sizing incomplete.&quot;</span>
        <span class="c1"># EnergyPlus severe (not fatal) errors if there is no heating design load</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setControlType</span><span class="p">(</span><span class="s1">&#39;SingleZoneVAV&#39;</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setControllingZoneorThermostatLocation</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.7.0&#39;</span><span class="p">):</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodDuringCoolingOperation</span><span class="p">(</span>
                <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodDuringHeatingOperation</span><span class="p">(</span>
                <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">minimum_volume_setpoint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodWhenNoCoolingorHeatingisRequired</span><span class="p">(</span>
                    <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">us</span> <span class="o">=</span> <span class="n">unitary_system</span>
                <span class="n">us</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodWhenNoCoolingorHeatingisRequired</span><span class="p">(</span>
                    <span class="s1">&#39;FractionOfAutosizedCoolingValue&#39;</span><span class="p">)</span>
                <span class="n">us</span><span class="o">.</span><span class="n">setFractionofAutosizedDesignCoolingSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">(</span>
                    <span class="n">minimum_volume_setpoint</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateDuringCoolingOperation</span><span class="p">()</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateDuringHeatingOperation</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">minimum_volume_setpoint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">us</span> <span class="o">=</span> <span class="n">unitary_system</span>
                <span class="n">us</span><span class="o">.</span><span class="n">setFractionofAutosizedDesignCoolingSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">(</span>
                    <span class="n">minimum_volume_setpoint</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># create outdoor air system</span>
        <span class="n">oa_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Sys Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">setMinimumOutdoorAirSchedule</span><span class="p">(</span><span class="n">oa_damper_sch</span><span class="p">)</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
        <span class="n">oa_controller</span><span class="o">.</span><span class="n">setHeatRecoveryBypassControlType</span><span class="p">(</span><span class="s1">&#39;BypassWhenOAFlowGreaterThanMinimum&#39;</span><span class="p">)</span>
        <span class="n">oa_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">oa_controller</span><span class="p">)</span>
        <span class="n">oa_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">oa_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># set air loop availability controls and night cycle manager, after oa system added</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setNightCycleControlType</span><span class="p">(</span><span class="s1">&#39;CycleOnAny&#39;</span><span class="p">)</span>

        <span class="c1"># create a VAV no reheat terminal and attach the zone/terminal pair to the air loop</span>
        <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctVAVNoReheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">diffuser</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Diffuser&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">diffuser</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">air_loops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">air_loop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">air_loops</span></div>



<div class="viewcode-block" id="model_add_minisplit_hp">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_minisplit_hp">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_minisplit_hp</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span>
        <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;Two Speed DX AC&#39;</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="s1">&#39;Single Speed DX&#39;</span><span class="p">,</span>
        <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a minisplit heatpump system for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to connect to this system.</span>
<span class="sd">        cooling_type: [String] valid choices are Two Speed DX AC, Single</span>
<span class="sd">            Speed DX AC, Single Speed Heat Pump.</span>
<span class="sd">        heating_type: [String] valid choices are Single Speed DX.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in</span>
<span class="sd">            which case will be defaulted to always on.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># default design temperatures across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="c1"># adjusted temperatures for minisplit</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span>

    <span class="n">minisplit_hps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Minisplit Heat Pump&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># default design settings used across all air loops</span>
        <span class="n">sizing_system</span> <span class="o">=</span> <span class="n">adjust_sizing_system</span><span class="p">(</span>
            <span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">,</span> <span class="n">sizing_option</span><span class="o">=</span><span class="s1">&#39;NonCoincident&#39;</span><span class="p">)</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinCooling</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinHeating</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># create heating coil</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed DX&#39;</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Heating Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Residential Minisplit HP&#39;</span><span class="p">)</span>
            <span class="n">o_dbt_fco</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="o">-</span><span class="mf">30.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setMinimumOutdoorDryBulbTemperatureforCompressorOperation</span><span class="p">(</span><span class="n">o_dbt_fco</span><span class="p">)</span>
            <span class="n">o_dbt_fdo</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="o">-</span><span class="mf">30.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforDefrostOperation</span><span class="p">(</span><span class="n">o_dbt_fdo</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setCrankcaseHeaterCapacity</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setDefrostStrategy</span><span class="p">(</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setDefrostControl</span><span class="p">(</span><span class="s1">&#39;OnDemand&#39;</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">resetDefrostTimePeriodFraction</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No heating coil type selected for minisplit HP: </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># create backup heating coil</span>
        <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Backup Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

        <span class="c1"># create cooling coil</span>
        <span class="k">if</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Two Speed DX AC&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 2spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Residential Minisplit HP&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed DX AC&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 1spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Split AC&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed Heat Pump&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> 1spd DX HP Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Heat Pump&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No cooling coil type selected for minisplit HP: </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># create fan</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Minisplit_HP_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;Minisplit HP Fans&#39;</span><span class="p">)</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>

        <span class="c1"># create unitary system (holds the coils and fan)</span>
        <span class="n">unitary</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACUnitarySystem</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">max_sat</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">200.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span><span class="n">max_sat</span><span class="p">)</span>
        <span class="n">max_dbt_sho</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">40.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforSupplementalHeaterOperation</span><span class="p">(</span><span class="n">max_dbt_sho</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setControllingZoneorThermostatLocation</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># attach the coils and fan</span>
        <span class="k">if</span> <span class="n">htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setHeatingCoil</span><span class="p">(</span><span class="n">htg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setCoolingCoil</span><span class="p">(</span><span class="n">clg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">supplemental_htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplementalHeatingCoil</span><span class="p">(</span><span class="n">supplemental_htg_coil</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyFan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># create a diffuser</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">diffuser</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Direct Air&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">diffuser</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="n">minisplit_hps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">air_loop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">minisplit_hps</span></div>



<div class="viewcode-block" id="model_add_ptac">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_ptac">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_ptac</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;Two Speed DX AC&#39;</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="s1">&#39;Gas&#39;</span><span class="p">,</span>
        <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;Cycling&#39;</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a PTAC system for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        cooling_type: [String] valid choices are Two Speed DX AC, Single Speed DX AC.</span>
<span class="sd">        heating_type: [String] valid choices are NaturalGas, Electricity,</span>
<span class="sd">            Water, nil (no heat).</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to connect</span>
<span class="sd">            heating coil to. Set to nil for heating types besides water.</span>
<span class="sd">        fan_type: [String] valid choices are ConstantVolume, Cycling.</span>
<span class="sd">        ventilation: [Boolean] If True, ventilation will be supplied through</span>
<span class="sd">            the unit. If False, no ventilation will be supplied through the unit,</span>
<span class="sd">            with the expectation that it will be provided by a DOAS or separate system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hw_temp_c</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">designLoopExitTemperature</span><span class="p">()</span>
        <span class="n">hw_delta_t_k</span> <span class="o">=</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">loopDesignTemperatureDifference</span><span class="p">()</span>

    <span class="c1"># adjusted zone design temperatures for ptac</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">57.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># make a PTAC for each zone</span>
    <span class="n">ptacs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirHumidityRatio</span><span class="p">(</span><span class="mf">0.008</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirHumidityRatio</span><span class="p">(</span><span class="mf">0.008</span><span class="p">)</span>

        <span class="c1"># add fan</span>
        <span class="k">if</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;ConstantVolume&#39;</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;PTAC_CAV_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;Cycling&#39;</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;PTAC_Cycling_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;ptac_fan_type &quot;</span><span class="si">{}</span><span class="s1">&quot; is not recognized.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fan_type</span><span class="p">))</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># add heating coil</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC Gas Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">):</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC Electric Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC No Heat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span> <span class="n">nominal_capacity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No hot water plant loop supplied for PTAC water coil.&#39;</span><span class="p">)</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()),</span>
                <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span><span class="p">,</span>
                <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="n">hw_temp_c</span> <span class="o">-</span> <span class="n">hw_delta_t_k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;ptac_heating_type of </span><span class="si">{}</span><span class="s1"> is not recognized.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heating_type</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># add cooling coil</span>
        <span class="k">if</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Two Speed DX AC&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_two_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC 2spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Single Speed DX AC&#39;</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC 1spd DX AC Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;PTAC&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;ptac_cooling_type of &quot;</span><span class="si">{}</span><span class="s1">&quot; is not recognized.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cooling_type</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># wrap coils in a PTAC system</span>
        <span class="n">ptac_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACPackagedTerminalAirConditioner</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">fan</span><span class="p">,</span> <span class="n">htg_coil</span><span class="p">,</span> <span class="n">clg_coil</span><span class="p">)</span>
        <span class="n">ptac_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTAC&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">ptac_system</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;ConstantVolume&#39;</span><span class="p">:</span>
            <span class="n">ptac_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ptac_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">ptac_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringCoolingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">ptac_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringHeatingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">ptac_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateWhenNoCoolingorHeatingisNeeded</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">ptac_system</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">ptacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptac_system</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ptacs</span></div>



<div class="viewcode-block" id="model_add_pthp">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_pthp">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_pthp</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;Cycling&#39;</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a PTHP system for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        fan_type: [String] valid choices are ConstantVolume, Cycling.</span>
<span class="sd">        ventilation: [Boolean] If true, ventilation will be supplied through the unit.</span>
<span class="sd">            If False, no ventilation will be supplied through the unit, with the</span>
<span class="sd">            expectation that it will be provided by a DOAS or separate system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="c1"># adjusted zone design temperatures for pthp</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">57.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># make a PTHP for each zone</span>
    <span class="n">pthps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirHumidityRatio</span><span class="p">(</span><span class="mf">0.008</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirHumidityRatio</span><span class="p">(</span><span class="mf">0.008</span><span class="p">)</span>

        <span class="c1"># add fan</span>
        <span class="k">if</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;ConstantVolume&#39;</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;PTAC_CAV_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTHP Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;Cycling&#39;</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;PTAC_Cycling_Fan&#39;</span><span class="p">,</span>
                                     <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTHP Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;PTHP fan_type of </span><span class="si">{}</span><span class="s1"> is not recognized.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fan_type</span><span class="p">))</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># add heating coil</span>
        <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_dx_single_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTHP Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="c1"># add cooling coil</span>
        <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTHP Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Heat Pump&#39;</span><span class="p">)</span>
        <span class="c1"># supplemental heating coil</span>
        <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTHP Supplemental Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="c1"># wrap coils in a PTHP system</span>
        <span class="n">pthp_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACPackagedTerminalHeatPump</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">fan</span><span class="p">,</span> <span class="n">htg_coil</span><span class="p">,</span> <span class="n">clg_coil</span><span class="p">,</span>
            <span class="n">supplemental_htg_coil</span><span class="p">)</span>
        <span class="n">pthp_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> PTHP&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">pthp_system</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fan_type</span> <span class="o">==</span> <span class="s1">&#39;ConstantVolume&#39;</span><span class="p">:</span>
            <span class="n">pthp_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pthp_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
                <span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">pthp_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringCoolingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">pthp_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringHeatingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">pthp_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateWhenNoCoolingorHeatingisNeeded</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">pthp_system</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">pthps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pthp_system</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pthps</span></div>



<div class="viewcode-block" id="model_add_unitheater">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_unitheater">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_unitheater</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fan_control_type</span><span class="o">=</span><span class="s1">&#39;ConstantVolume&#39;</span><span class="p">,</span>
        <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="mf">180.0</span><span class="p">,</span> <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="mf">160.0</span><span class="p">,</span>
        <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="mf">104.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a unit heater for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        hvac_op_sch: [String] name of the HVAC operation schedule or None in which</span>
<span class="sd">            case will be defaulted to always on.</span>
<span class="sd">        fan_control_type: [String] valid choices are OnOff, ConstantVolume,</span>
<span class="sd">            VariableVolume.</span>
<span class="sd">        fan_pressure_rise: [Double] fan pressure rise, inH2O.</span>
<span class="sd">        heating_type: [String] valid choices are NaturalGas, Gas, Electricity,</span>
<span class="sd">            Electric, DistrictHeating, DistrictHeatingWater, DistrictHeatingSteam.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] hot water loop to connect</span>
<span class="sd">            to the heating coil.</span>
<span class="sd">        rated_inlet_water_temperature: [Double] rated inlet water temperature in</span>
<span class="sd">            degrees Fahrenheit, default is 180F.</span>
<span class="sd">        rated_outlet_water_temperature: [Double] rated outlet water temperature</span>
<span class="sd">            in degrees Fahrenheit, default is 160F.</span>
<span class="sd">        rated_inlet_air_temperature: [Double] rated inlet air temperature in</span>
<span class="sd">            degrees Fahrenheit, default is 60F.</span>
<span class="sd">        rated_outlet_air_temperature: [Double] rated outlet air temperature in</span>
<span class="sd">            degrees Fahrenheit, default is 100F.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># hvac operation schedule</span>
    <span class="n">hvac_op_sch</span> <span class="o">=</span> <span class="n">model_add_schedule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">)</span>

    <span class="c1"># set defaults if nil</span>
    <span class="n">fan_control_type</span> <span class="o">=</span> <span class="s1">&#39;ConstantVolume&#39;</span> <span class="k">if</span> <span class="n">fan_control_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fan_control_type</span>
    <span class="n">fan_pressure_rise</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="k">if</span> <span class="n">fan_pressure_rise</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fan_pressure_rise</span>

    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="c1"># adjusted zone design heating temperature for unit heater</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># make a unit heater for each zone</span>
    <span class="n">unit_heaters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="c1"># add fan</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Unit_Heater_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> UnitHeater Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
            <span class="n">pressure_rise</span><span class="o">=</span><span class="n">fan_pressure_rise</span><span class="p">)</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">hvac_op_sch</span><span class="p">)</span>

        <span class="c1"># add heating coil</span>
        <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;NaturalGas&#39;</span> <span class="ow">or</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Gas&#39;</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> UnitHeater Gas Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">hvac_op_sch</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span> <span class="ow">or</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Electric&#39;</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> UnitHeater Electric Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">hvac_op_sch</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;DistrictHeating&#39;</span> <span class="ow">in</span> <span class="n">heating_type</span> <span class="ow">and</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># control temperature for hot water loop</span>
            <span class="k">if</span> <span class="n">rated_inlet_water_temperature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rated_inlet_water_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">180.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rated_inlet_water_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">rated_inlet_water_temperature</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">rated_outlet_water_temperature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rated_outlet_water_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">160.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rated_outlet_water_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">rated_outlet_water_temperature</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">rated_inlet_air_temperature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rated_inlet_air_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">60.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rated_inlet_air_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">rated_inlet_air_temperature</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">rated_outlet_air_temperature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">rated_outlet_air_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">104.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rated_outlet_air_temperature_c</span> <span class="o">=</span> \
                    <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">rated_outlet_air_temperature</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> UnitHeater Water Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">rated_inlet_water_temperature</span><span class="o">=</span><span class="n">rated_inlet_water_temperature_c</span><span class="p">,</span>
                <span class="n">rated_outlet_water_temperature</span><span class="o">=</span><span class="n">rated_outlet_water_temperature_c</span><span class="p">,</span>
                <span class="n">rated_inlet_air_temperature</span><span class="o">=</span><span class="n">rated_inlet_air_temperature_c</span><span class="p">,</span>
                <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">rated_outlet_air_temperature_c</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No heating type was found when adding unit heater; &#39;</span>
                             <span class="s1">&#39;no unit heater will be created.&#39;</span><span class="p">)</span>

        <span class="c1"># create unit heater</span>
        <span class="n">unit_heater</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACUnitHeater</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="p">,</span> <span class="n">fan</span><span class="p">,</span> <span class="n">htg_coil</span><span class="p">)</span>
        <span class="n">unit_heater</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unit Heater&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">unit_heater</span><span class="o">.</span><span class="n">setFanControlType</span><span class="p">(</span><span class="n">fan_control_type</span><span class="p">)</span>
        <span class="n">unit_heater</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unit_heaters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unit_heater</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unit_heaters</span></div>



<div class="viewcode-block" id="model_add_evap_cooler">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_evap_cooler">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_evap_cooler</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an evaporative cooler for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="c1"># adjusted design temperatures for evap cooler</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">70.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;max_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">78.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;max_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;max_clg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;approach_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span>  <span class="c1"># wetbulb approach temperature</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;approach_k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;approach_r&#39;</span><span class="p">]],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># EMS programs</span>
    <span class="n">programs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Make an evap cooler for each zone</span>
    <span class="n">evap_coolers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">zone_name_clean</span> <span class="o">=</span> <span class="n">zone_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># Air loop</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Evaporative Cooler&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name_clean</span><span class="p">))</span>
        <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># default design settings used across all air loops</span>
        <span class="n">adjust_sizing_system</span><span class="p">(</span><span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">)</span>

        <span class="c1"># air handler controls</span>
        <span class="c1"># setpoint follows OAT WetBulb</span>
        <span class="n">evap_stpt_manager</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerFollowOutdoorAirTemperature</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">evap_stpt_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> F above OATwb&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;approach_r&#39;</span><span class="p">]))</span>
        <span class="n">evap_stpt_manager</span><span class="o">.</span><span class="n">setReferenceTemperatureType</span><span class="p">(</span><span class="s1">&#39;OutdoorAirWetBulb&#39;</span><span class="p">)</span>
        <span class="n">evap_stpt_manager</span><span class="o">.</span><span class="n">setMaximumSetpointTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;max_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">evap_stpt_manager</span><span class="o">.</span><span class="n">setMinimumSetpointTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">evap_stpt_manager</span><span class="o">.</span><span class="n">setOffsetTemperatureDifference</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;approach_k&#39;</span><span class="p">])</span>
        <span class="n">evap_stpt_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">())</span>

        <span class="c1"># Schedule to control the airloop availability</span>
        <span class="n">air_loop_avail_sch</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ScheduleConstant</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">air_loop_avail_sch</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Availability Sch&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">air_loop_avail_sch</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">air_loop_avail_sch</span><span class="p">)</span>

        <span class="c1"># EMS to turn on Evap Cooler if there is a cooling load in the target zone.</span>
        <span class="c1"># Without this EMS, the airloop runs 24/7-365 even when there is no load in the zone.</span>

        <span class="c1"># Create a sensor to read the zone load</span>
        <span class="n">ems_zone_name</span> <span class="o">=</span> <span class="n">ems_friendly_name</span><span class="p">(</span><span class="n">zone_name_clean</span><span class="p">)</span>
        <span class="n">zn_load_sensor</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemSensor</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Zone Predicted Sensible Load to Cooling Setpoint Heat Transfer Rate&#39;</span><span class="p">)</span>
        <span class="n">zn_load_sensor</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Clg Load Sensor&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ems_zone_name</span><span class="p">))</span>
        <span class="n">zn_load_sensor</span><span class="o">.</span><span class="n">setKeyName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">handle</span><span class="p">()))</span>

        <span class="c1"># Create an actuator to set the airloop availability</span>
        <span class="n">ems_loop_name</span> <span class="o">=</span> <span class="n">ems_friendly_name</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">air_loop_avail_actuator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
            <span class="n">air_loop_avail_sch</span><span class="p">,</span> <span class="s1">&#39;Schedule:Constant&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
        <span class="n">air_loop_avail_actuator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Availability Actuator&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ems_loop_name</span><span class="p">))</span>

        <span class="c1"># Create a program to turn on Evap Cooler if</span>
        <span class="c1"># there is a cooling load in the target zone.</span>
        <span class="c1"># Load &lt; 0.0 is a cooling load.</span>
        <span class="n">avail_program</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgram</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">avail_program</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Availability Control&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ems_loop_name</span><span class="p">))</span>
        <span class="n">avail_program_body</span> <span class="o">=</span> \
            <span class="s1">&#39;IF </span><span class="si">{zn_load_sensor_handle}</span><span class="s1"> &lt; 0.0</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{air_loop_avail_actuator_handle}</span><span class="s1"> = 1</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ELSE</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{air_loop_avail_actuator_handle}</span><span class="s1"> = 0</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ENDIF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">zn_load_sensor_handle</span><span class="o">=</span><span class="n">zn_load_sensor</span><span class="o">.</span><span class="n">handle</span><span class="p">(),</span>
                <span class="n">air_loop_avail_actuator_handle</span><span class="o">=</span><span class="n">air_loop_avail_actuator</span><span class="o">.</span><span class="n">handle</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="n">avail_program</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">avail_program_body</span><span class="p">)</span>

        <span class="n">programs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avail_program</span><span class="p">)</span>

        <span class="c1"># Direct Evap Cooler</span>
        <span class="c1"># @todo better assumptions for fan pressure rise</span>
        <span class="n">evap</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EvaporativeCoolerDirectResearchSpecial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Evap Media&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="c1"># assume 90% design effectiveness from</span>
        <span class="c1"># https://basc.pnnl.gov/resource-guides/evaporative-cooling-systems#edit-group-description</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">setCoolerDesignEffectiveness</span><span class="p">(</span><span class="mf">0.90</span><span class="p">)</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">autosizePrimaryAirDesignFlowRate</span><span class="p">()</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">autosizeRecirculatingWaterPumpPowerConsumption</span><span class="p">()</span>
        <span class="c1"># use suggested E+ default values of 90.0 W-s/m^3 for pump sizing factor</span>
        <span class="c1"># and 3.0 for blowdown concentration</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">setWaterPumpPowerSizingFactor</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">setBlowdownConcentrationRatio</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
        <span class="n">evap</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># Fan (cycling), must be inside unitary system to cycle on airloop</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Evap_Cooler_Supply_Fan&#39;</span><span class="p">,</span>
            <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Evap Cooler Supply Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># Dummy zero-capacity cooling coil</span>
        <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dummy Always Off DX Coil&#39;</span><span class="p">,</span>
            <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="n">unitary_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACUnitarySystem</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Evap Cooler Cycling Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyFan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setCoolingCoil</span><span class="p">(</span><span class="n">clg_coil</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setControllingZoneorThermostatLocation</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.7.0&#39;</span><span class="p">):</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodDuringCoolingOperation</span><span class="p">(</span>
                <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodDuringHeatingOperation</span><span class="p">(</span>
                <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFlowRateMethodWhenNoCoolingorHeatingisRequired</span><span class="p">(</span>
                <span class="s1">&#39;SupplyAirFlowRate&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateDuringCoolingOperation</span><span class="p">()</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateDuringHeatingOperation</span><span class="p">()</span>
            <span class="n">unitary_system</span><span class="o">.</span><span class="n">autosizeSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">()</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="n">unitary_system</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># Outdoor air intake system</span>
        <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumLimitType</span><span class="p">(</span><span class="s1">&#39;FixedMinimum&#39;</span><span class="p">)</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
        <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setMinimumFractionofOutdoorAirSchedule</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">controller_mv</span> <span class="o">=</span> <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">controllerMechanicalVentilation</span><span class="p">()</span>
        <span class="n">controller_mv</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Vent Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">controller_mv</span><span class="o">.</span><span class="n">setSystemOutdoorAirMethod</span><span class="p">(</span><span class="s1">&#39;ZoneSum&#39;</span><span class="p">)</span>

        <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
        <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># make an air terminal for the zone</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">air_terminal</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">air_terminal</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Air Terminal&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="c1"># attach new terminal to the zone and to the airloop</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">air_terminal</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setCoolingDesignAirFlowMethod</span><span class="p">(</span><span class="s1">&#39;DesignDay&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="n">evap_coolers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">air_loop</span><span class="p">)</span>

    <span class="c1"># Create a programcallingmanager</span>
    <span class="n">avail_pcm</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgramCallingManager</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">avail_pcm</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;EvapCoolerAvailabilityProgramCallingManager&#39;</span><span class="p">)</span>
    <span class="n">avail_pcm</span><span class="o">.</span><span class="n">setCallingPoint</span><span class="p">(</span><span class="s1">&#39;AfterPredictorAfterHVACManagers&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">program</span> <span class="ow">in</span> <span class="n">programs</span><span class="p">:</span>
        <span class="n">avail_pcm</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">program</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">evap_coolers</span></div>



<div class="viewcode-block" id="model_add_baseboard">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_baseboard">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_baseboard</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds hydronic or electric baseboard heating to each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            add baseboards to.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] The hot water loop that</span>
<span class="sd">            serves the baseboards. If None, baseboards are electric.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make a baseboard heater for each zone</span>
    <span class="n">baseboards</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">baseboard</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACBaseboardConvectiveElectric</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">baseboard</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Electric Baseboard&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
            <span class="n">baseboard</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
            <span class="n">baseboards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">baseboard</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoilHeatingWaterBaseboard</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Hydronic Baseboard Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
            <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">htg_coil</span><span class="p">)</span>
            <span class="n">baseboard</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACBaseboardConvectiveWater</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">htg_coil</span><span class="p">)</span>
            <span class="n">baseboard</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Hydronic Baseboard&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
            <span class="n">baseboard</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
            <span class="n">baseboards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">baseboard</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">baseboards</span></div>



<div class="viewcode-block" id="model_add_vrf">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_vrf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_vrf</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds Variable Refrigerant Flow system and terminal units for each zone</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to add fan coil units.</span>
<span class="sd">        ventilation: [Boolean] If True, ventilation will be supplied through the unit.</span>
<span class="sd">            If False, no ventilation will be supplied through the unit, with the</span>
<span class="sd">            expectation that it will be provided by a DOAS or separate system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create vrf outdoor unit</span>
    <span class="n">master_zone</span> <span class="o">=</span> <span class="n">thermal_zones</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">vrf_outdoor_unit</span> <span class="o">=</span> <span class="n">create_air_conditioner_variable_refrigerant_flow</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Zone VRF System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">)),</span>
        <span class="n">master_zone</span><span class="o">=</span><span class="n">master_zone</span><span class="p">)</span>

    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># zone sizing</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="c1"># add vrf terminal unit</span>
        <span class="n">vrf_terminal_unit</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACTerminalUnitVariableRefrigerantFlow</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> VRF Terminal Unit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">setTerminalUnitAvailabilityschedule</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">ventilation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringCoolingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringHeatingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateWhenNoCoolingorHeatingisNeeded</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># set fan variables</span>
        <span class="c1"># always off denotes cycling fan</span>
        <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="n">vrf_fan</span> <span class="o">=</span> <span class="n">vrf_terminal_unit</span><span class="o">.</span><span class="n">supplyAirFan</span><span class="p">()</span><span class="o">.</span><span class="n">to_FanOnOff</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vrf_fan</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">vrf_fan</span> <span class="o">=</span> <span class="n">vrf_fan</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">vrf_fan</span><span class="o">.</span><span class="n">setPressureRise</span><span class="p">(</span><span class="mf">300.0</span><span class="p">)</span>
            <span class="n">vrf_fan</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">vrf_fan</span><span class="o">.</span><span class="n">setFanEfficiency</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
            <span class="n">vrf_fan</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> VRF Unit Cycling Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="c1"># add to main condensing unit</span>
        <span class="n">vrf_outdoor_unit</span><span class="o">.</span><span class="n">addTerminal</span><span class="p">(</span><span class="n">vrf_terminal_unit</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">vrf_outdoor_unit</span></div>



<div class="viewcode-block" id="model_add_four_pipe_fan_coil">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_four_pipe_fan_coil">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_four_pipe_fan_coil</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">capacity_control_method</span><span class="o">=</span><span class="s1">&#39;CyclingFan&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds four pipe fan coil units to each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            add fan coil units.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] the chilled water loop</span>
<span class="sd">            that serves the fan coils.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] the hot water loop that</span>
<span class="sd">            serves the fan coils. If None, a zero-capacity, electric heating</span>
<span class="sd">            coil set to Always-Off will be included in the unit.</span>
<span class="sd">        ventilation: [Boolean] If true, ventilation will be supplied through</span>
<span class="sd">            the unit. If false, no ventilation will be supplied through the unit,</span>
<span class="sd">            with the expectation that it will be provided by a DOAS or separate system.</span>
<span class="sd">        capacity_control_method: [String] Capacity control method for the fan coil.</span>
<span class="sd">            Options are ConstantFanVariableFlow, CyclingFan, VariableFanVariableFlow,</span>
<span class="sd">            and VariableFanConstantFlow.  If VariableFan, the fan will be VariableVolume.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># default design temperatures used across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="c1"># make a fan coil unit for each zone</span>
    <span class="n">fcus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneCoolingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_clg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setZoneHeatingDesignSupplyAirTemperature</span><span class="p">(</span>
            <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">chilled_water_loop</span><span class="p">:</span>
            <span class="n">fcu_clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> FCU Cooling Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Fan coil units require a chilled water loop, &#39;</span>
                             <span class="s1">&#39;but none was provided.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hot_water_loop</span><span class="p">:</span>
            <span class="n">fcu_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> FCU Heating Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">rated_outlet_air_temperature</span><span class="o">=</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Zero-capacity, always-off electric heating coil</span>
            <span class="n">fcu_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> No Heat&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span> <span class="n">nominal_capacity</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">capacity_control_method</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;VariableFanVariableFlow&#39;</span><span class="p">,</span> <span class="s1">&#39;VariableFanConstantFlow&#39;</span><span class="p">):</span>
            <span class="n">fcu_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Fan_Coil_VarSpeed_Fan&#39;</span><span class="p">,</span>
                <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan Coil Variable Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;FCU Fans&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fcu_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Fan_Coil_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Fan Coil fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
                <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;FCU Fans&#39;</span><span class="p">)</span>
        <span class="n">fcu_fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">fcu_fan</span><span class="o">.</span><span class="n">autosizeMaximumFlowRate</span><span class="p">()</span>

        <span class="n">fcu</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACFourPipeFanCoil</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">fcu_fan</span><span class="p">,</span> <span class="n">fcu_clg_coil</span><span class="p">,</span> <span class="n">fcu_htg_coil</span><span class="p">)</span>
        <span class="n">fcu</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> FCU&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">fcu</span><span class="o">.</span><span class="n">setCapacityControlMethod</span><span class="p">(</span><span class="n">capacity_control_method</span><span class="p">)</span>
        <span class="n">fcu</span><span class="o">.</span><span class="n">autosizeMaximumSupplyAirFlowRate</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">fcu</span><span class="o">.</span><span class="n">setMaximumOutdoorAirFlowRate</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">fcu</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">fcus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fcu</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fcus</span></div>



<div class="viewcode-block" id="model_add_high_temp_radiant">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_high_temp_radiant">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_high_temp_radiant</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span>
        <span class="n">combustion_efficiency</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">control_type</span><span class="o">=</span><span class="s1">&#39;MeanAirTemperature&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a high temp radiant heater for each zone and adds it to the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            connect to this system.</span>
<span class="sd">        heating_type: [String] valid choices are NaturalGas, Electric.</span>
<span class="sd">        combustion_efficiency: [Double] combustion efficiency as decimal.</span>
<span class="sd">        control_type: [String] control type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;NaturalGas&#39;</span> <span class="k">if</span> <span class="n">heating_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">heating_type</span>
    <span class="c1"># make a high temp radiant heater for each zone</span>
    <span class="n">radiant_heaters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">high_temp_radiant</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACHighTemperatureRadiant</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> High Temp Radiant&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;NaturalGas&#39;</span> <span class="ow">or</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Gas&#39;</span><span class="p">:</span>
            <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setFuelType</span><span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setFuelType</span><span class="p">(</span><span class="n">heating_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">combustion_efficiency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;NaturalGas&#39;</span> <span class="ow">or</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Gas&#39;</span><span class="p">:</span>
                <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setCombustionEfficiency</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">heating_type</span> <span class="o">==</span> <span class="s1">&#39;Electric&#39;</span><span class="p">:</span>
                <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setCombustionEfficiency</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setCombustionEfficiency</span><span class="p">(</span><span class="n">combustion_efficiency</span><span class="p">)</span>

        <span class="c1"># set heating setpoint schedule</span>
        <span class="n">htg_sch</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">tstat</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">thermostatSetpointDualSetpoint</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tstat</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">tstat</span> <span class="o">=</span> <span class="n">tstat</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">tstat</span><span class="o">.</span><span class="n">heatingSetpointTemperatureSchedule</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
                <span class="n">htg_sch</span> <span class="o">=</span> <span class="n">tstat</span><span class="o">.</span><span class="n">heatingSetpointTemperatureSchedule</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">htg_sch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;For </span><span class="si">{}</span><span class="s1">: Cannot find a heating setpoint schedule for this zone, &#39;</span> \
                <span class="s1">&#39;cannot apply high temp radiant system.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># set defaults</span>
        <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setHeatingSetpointTemperatureSchedule</span><span class="p">(</span><span class="n">htg_sch</span><span class="p">)</span>
        <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setTemperatureControlType</span><span class="p">(</span><span class="n">control_type</span><span class="p">)</span>
        <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setFractionofInputConvertedtoRadiantEnergy</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">setHeatingThrottlingRange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">high_temp_radiant</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">radiant_heaters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">high_temp_radiant</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">radiant_heaters</span></div>



<div class="viewcode-block" id="model_add_low_temp_radiant">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_low_temp_radiant">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_low_temp_radiant</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span>
        <span class="n">plant_supply_water_temperature_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plant_supply_water_temperature_control_strategy</span><span class="o">=</span><span class="s1">&#39;outdoor_air&#39;</span><span class="p">,</span>
        <span class="n">hwsp_at_oat_low</span><span class="o">=</span><span class="mf">120.0</span><span class="p">,</span> <span class="n">hw_oat_low</span><span class="o">=</span><span class="mf">55.0</span><span class="p">,</span> <span class="n">hwsp_at_oat_high</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">hw_oat_high</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span>
        <span class="n">chwsp_at_oat_low</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">chw_oat_low</span><span class="o">=</span><span class="mf">65.0</span><span class="p">,</span> <span class="n">chwsp_at_oat_high</span><span class="o">=</span><span class="mf">55.0</span><span class="p">,</span> <span class="n">chw_oat_high</span><span class="o">=</span><span class="mf">75.0</span><span class="p">,</span>
        <span class="n">radiant_type</span><span class="o">=</span><span class="s1">&#39;floor&#39;</span><span class="p">,</span> <span class="n">radiant_temperature_control_type</span><span class="o">=</span><span class="s1">&#39;SurfaceFaceTemperature&#39;</span><span class="p">,</span>
        <span class="n">radiant_setpoint_control_type</span><span class="o">=</span><span class="s1">&#39;ZeroFlowPower&#39;</span><span class="p">,</span>
        <span class="n">include_carpet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">carpet_thickness_in</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
        <span class="n">control_strategy</span><span class="o">=</span><span class="s1">&#39;proportional_control&#39;</span><span class="p">,</span>
        <span class="n">use_zone_occupancy_for_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">occupied_percentage_threshold</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span>
        <span class="n">model_occ_hr_start</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">model_occ_hr_end</span><span class="o">=</span><span class="mf">18.0</span><span class="p">,</span>
        <span class="n">proportional_gain</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">switch_over_time</span><span class="o">=</span><span class="mf">24.0</span><span class="p">,</span>
        <span class="n">slab_sp_at_oat_low</span><span class="o">=</span><span class="mi">73</span><span class="p">,</span> <span class="n">slab_oat_low</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span>
        <span class="n">slab_sp_at_oat_high</span><span class="o">=</span><span class="mi">68</span><span class="p">,</span> <span class="n">slab_oat_high</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
        <span class="n">radiant_availability_type</span><span class="o">=</span><span class="s1">&#39;precool&#39;</span><span class="p">,</span> <span class="n">radiant_lockout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">radiant_lockout_start_time</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span> <span class="n">radiant_lockout_end_time</span><span class="o">=</span><span class="mf">20.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds low temperature radiant loop systems to each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            add radiant loops.</span>
<span class="sd">        hot_water_loop: [OpenStudio::Model::PlantLoop] the hot water loop that</span>
<span class="sd">            serves the radiant loop.</span>
<span class="sd">        chilled_water_loop: [OpenStudio::Model::PlantLoop] the chilled water loop</span>
<span class="sd">            that serves the radiant loop.</span>
<span class="sd">        plant_supply_water_temperature_control: [Bool] Set to True if the plant</span>
<span class="sd">            supply water temperature is to be controlled else it is held constant,</span>
<span class="sd">            default to false.</span>
<span class="sd">        plant_supply_water_temperature_control_strategy: [String] Method to determine</span>
<span class="sd">            how to control the plant&#39;s supply water temperature. Options include.</span>
<span class="sd">            outdoor_air - Set the supply water temperature based on the outdoor</span>
<span class="sd">                air temperature.</span>
<span class="sd">            zone_demand - Set the supply water temperature based on the preponderance</span>
<span class="sd">                of zone demand.</span>
<span class="sd">        hwsp_at_oat_low: [Double] hot water plant supply water temperature setpoint,</span>
<span class="sd">            in F, at the outdoor low temperature.</span>
<span class="sd">        hw_oat_low: [Double] hot water plant supply water temperature setpoint,</span>
<span class="sd">            in F, at the outdoor high temperature.</span>
<span class="sd">        hw_oat_high: [Double] outdoor drybulb air temperature, in F, for high</span>
<span class="sd">            setpoint for hot water plant.</span>
<span class="sd">        chwsp_at_oat_low: [Double] chilled water plant supply water temperature</span>
<span class="sd">            setpoint, in F, at the outdoor low temperature.</span>
<span class="sd">        chw_oat_low: [Double] outdoor drybulb air  temperature, in F, for low</span>
<span class="sd">            setpoint for chilled water plant.</span>
<span class="sd">        chwsp_at_oat_high: [Double] chilled water plant supply water temperature</span>
<span class="sd">            setpoint, in F, at the outdoor high temperature.</span>
<span class="sd">        chw_oat_high: [Double] outdoor drybulb air temperature, in F, for high</span>
<span class="sd">            setpoint for chilled water plant.</span>
<span class="sd">        radiant_type: [String] type of radiant system to create in zone. Valid options</span>
<span class="sd">            incllude the following.</span>

<span class="sd">            * floor</span>
<span class="sd">            * ceiling</span>
<span class="sd">            * ceilingmetalpanel</span>
<span class="sd">            * floorwithhardwood</span>

<span class="sd">        radiant_temperature_control_type: [String] determines the controlled</span>
<span class="sd">            temperature for the radiant system options include the following.</span>

<span class="sd">            * MeanAirTemperature</span>
<span class="sd">            * MeanRadiantTemperature</span>
<span class="sd">            * OperativeTemperature</span>
<span class="sd">            * OutdoorDryBulbTemperature</span>
<span class="sd">            * OutdoorWetBulbTemperature</span>
<span class="sd">            * SurfaceFaceTemperature</span>
<span class="sd">            * SurfaceInteriorTemperature</span>

<span class="sd">        radiant_setpoint_control_type: [String] determines the response of the</span>
<span class="sd">            radiant system at setpoint temperature options include the following.</span>

<span class="sd">            * ZeroFlowPower</span>
<span class="sd">            * HalfFlowPower</span>

<span class="sd">        include_carpet: [Boolean] boolean to include thin carpet tile over</span>
<span class="sd">            radiant slab, default to true.</span>
<span class="sd">        carpet_thickness_in: [Double] thickness of carpet in inches.</span>
<span class="sd">        control_strategy: [String] name of control strategy. Options include</span>
<span class="sd">            the following.</span>

<span class="sd">            * proportional_control</span>
<span class="sd">            * oa_based_control</span>
<span class="sd">            * constant_control</span>
<span class="sd">            * none</span>

<span class="sd">            If control strategy is proportional_control, the method will apply</span>
<span class="sd">            the CBE radiant control sequences detailed in Raftery et al. (2017)</span>
<span class="sd">            &#39;A new control strategy for high thermal mass radiant systems&#39;.</span>
<span class="sd">            If control strategy is oa_based_control, the method will apply native</span>
<span class="sd">            EnergyPlus objects/parameters to vary slab setpoint based on outdoor weather.</span>
<span class="sd">            If control strategy is constant_control, the method will apply native</span>
<span class="sd">            EnergyPlus objects/parameters to maintain a constant slab setpoint.</span>
<span class="sd">            Otherwise no control strategy will be applied and the radiant system</span>
<span class="sd">            will assume the EnergyPlus default controls.</span>
<span class="sd">        use_zone_occupancy_for_control: [Boolean] Set to true if radiant system is</span>
<span class="sd">            to use specific zone occupancy objects for CBE control strategy. If False,</span>
<span class="sd">            then it will use values in model_occ_hr_start and model_occ_hr_end</span>
<span class="sd">            for all radiant zones. default to True.</span>
<span class="sd">        occupied_percentage_threshold: [Double] the minimum fraction (0 to 1) that</span>
<span class="sd">            counts as occupied if this parameter is set, the returned ScheduleRuleset</span>
<span class="sd">            will be 0 = unoccupied, 1 = occupied. Otherwise the ScheduleRuleset</span>
<span class="sd">            will be the weighted fractional occupancy schedule. Only used if</span>
<span class="sd">            use_zone_occupancy_for_control is set to true.</span>
<span class="sd">        model_occ_hr_start: [Double] (Optional) Only applies if control_strategy</span>
<span class="sd">            is proportional_control. Starting hour of building occupancy.</span>
<span class="sd">        model_occ_hr_end: [Double] (Optional) Only applies if control_strategy</span>
<span class="sd">            is proportional_control. Ending hour of building occupancy.</span>
<span class="sd">        proportional_gain: [Double] (Optional) Only applies if control_strategy</span>
<span class="sd">            is proportional_control. Proportional gain constant (recommended 0.3 or less).</span>
<span class="sd">        switch_over_time: [Double] Time limitation for when the system can switch</span>
<span class="sd">            between heating and cooling</span>
<span class="sd">        slab_sp_at_oat_low: [Double] radiant slab temperature setpoint, in F,</span>
<span class="sd">            at the outdoor high temperature.</span>
<span class="sd">        slab_oat_low: [Double] outdoor drybulb air temperature, in F, for low</span>
<span class="sd">            radiant slab setpoint.</span>
<span class="sd">        slab_sp_at_oat_high: [Double] radiant slab temperature setpoint, in F,</span>
<span class="sd">            at the outdoor low temperature.</span>
<span class="sd">        slab_oat_high: [Double] outdoor drybulb air temperature, in F, for high</span>
<span class="sd">            radiant slab setpoint.</span>
<span class="sd">        radiant_availability_type: [String] a preset that determines the availability</span>
<span class="sd">            of the radiant system. Options include the following.</span>

<span class="sd">            * all_day - radiant system is available 24 hours a day</span>
<span class="sd">            * precool - primarily operates radiant system during night-time hours</span>
<span class="sd">            * afternoon_shutoff - avoids operation during peak grid demand</span>
<span class="sd">            * occupancy - operates radiant system during building occupancy hours</span>

<span class="sd">        radiant_lockout: [Boolean] True if system contains a radiant lockout.</span>
<span class="sd">            If true, it will overwrite radiant_availability_type.</span>
<span class="sd">        radiant_lockout_start_time: [double] decimal hour of when radiant lockout starts.</span>
<span class="sd">            Only used if radiant_lockout is True.</span>
<span class="sd">        radiant_lockout_end_time: [double] decimal hour of when radiant lockout ends.</span>
<span class="sd">            Only used if radiant_lockout is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># determine construction insulation thickness by climate zone</span>
    <span class="n">climate_zone_obj</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getClimateZones</span><span class="p">()</span><span class="o">.</span><span class="n">getClimateZone</span><span class="p">(</span><span class="s1">&#39;ASHRAE&#39;</span><span class="p">,</span> <span class="mi">2006</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">climate_zone_obj</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">climate_zone_obj</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getClimateZones</span><span class="p">()</span><span class="o">.</span><span class="n">getClimateZone</span><span class="p">(</span><span class="s1">&#39;ASHRAE&#39;</span><span class="p">,</span> <span class="mi">2013</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">climate_zone_obj</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">climate_zone</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">climate_zone</span> <span class="o">=</span> <span class="n">climate_zone_obj</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">climate_zone</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Unable to determine climate zone for radiant slab insulation &#39;</span> \
            <span class="s1">&#39;determination. Defaulting to climate zone 5, R-20 insulation, 110F &#39;</span> \
            <span class="s1">&#39;heating design supply water temperature.&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">110</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">90</span>
        <span class="k">elif</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;2A&#39;</span><span class="p">,</span> <span class="s1">&#39;2B&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;3A&#39;</span><span class="p">,</span> <span class="s1">&#39;3B&#39;</span><span class="p">,</span> <span class="s1">&#39;3C&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;4A&#39;</span><span class="p">,</span> <span class="s1">&#39;4B&#39;</span><span class="p">,</span> <span class="s1">&#39;4C&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;5A&#39;</span><span class="p">,</span> <span class="s1">&#39;5B&#39;</span><span class="p">,</span> <span class="s1">&#39;5C&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">110</span>
        <span class="k">elif</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;6A&#39;</span><span class="p">,</span> <span class="s1">&#39;6B&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">120</span>
        <span class="k">elif</span> <span class="n">climate_zone</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">):</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">120</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># default to 4</span>
            <span class="n">cz_mult</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1"># create materials</span>
    <span class="n">mat_concrete_3_5in</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;MediumRough&#39;</span><span class="p">,</span> <span class="mf">0.0889</span><span class="p">,</span> <span class="mf">2.31</span><span class="p">,</span> <span class="mi">2322</span><span class="p">,</span> <span class="mi">832</span><span class="p">)</span>
    <span class="n">mat_concrete_3_5in</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Slab Concrete - 3.5 in.&#39;</span><span class="p">)</span>

    <span class="n">mat_concrete_1_5in</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;MediumRough&#39;</span><span class="p">,</span> <span class="mf">0.0381</span><span class="p">,</span> <span class="mf">2.31</span><span class="p">,</span> <span class="mi">2322</span><span class="p">,</span> <span class="mi">832</span><span class="p">)</span>
    <span class="n">mat_concrete_1_5in</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Slab Concrete - 1.5 in&#39;</span><span class="p">)</span>

    <span class="n">metal_mat</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">air_gap_mat</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">wood_mat</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">wood_floor_insulation</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gypsum_ceiling_mat</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceilingmetalpanel&#39;</span><span class="p">:</span>
        <span class="n">metal_mat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;MediumSmooth&#39;</span><span class="p">,</span> <span class="mf">0.003175</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">7680</span><span class="p">,</span> <span class="mi">418</span><span class="p">)</span>
        <span class="n">metal_mat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Metal Layer - 0.125 in&#39;</span><span class="p">)</span>
        <span class="n">air_gap_mat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MasslessOpaqueMaterial</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Smooth&#39;</span><span class="p">,</span> <span class="mf">0.004572</span><span class="p">)</span>
        <span class="n">air_gap_mat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Generic Ceiling Air Gap - R 0.025&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floorwithhardwood&#39;</span><span class="p">:</span>
        <span class="n">wood_mat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;MediumSmooth&#39;</span><span class="p">,</span> <span class="mf">0.01905</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">608</span><span class="p">,</span> <span class="mi">1629</span><span class="p">)</span>
        <span class="n">wood_mat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Hardwood Flooring - 0.75 in&#39;</span><span class="p">)</span>
        <span class="n">wood_floor_insulation</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Rough&#39;</span><span class="p">,</span> <span class="mf">0.0508</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">56.06</span><span class="p">,</span> <span class="mi">1210</span><span class="p">)</span>
        <span class="n">wood_floor_insulation</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Subfloor Insulation - 4.0 in&#39;</span><span class="p">)</span>
        <span class="n">gypsum_ceiling_mat</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Smooth&#39;</span><span class="p">,</span> <span class="mf">0.0127</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1089</span><span class="p">)</span>
        <span class="n">gypsum_ceiling_mat</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Gypsum Ceiling for Radiant Hardwood Flooring - 0.5 in&#39;</span><span class="p">)</span>

    <span class="n">mat_refl_roof_membrane</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getStandardOpaqueMaterialByName</span><span class="p">(</span>
        <span class="s1">&#39;Roof Membrane - Highly Reflective&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mat_refl_roof_membrane</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">mat_refl_roof_membrane</span> <span class="o">=</span> <span class="n">mat_refl_roof_membrane</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mat_refl_roof_membrane</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;VeryRough&#39;</span><span class="p">,</span> <span class="mf">0.0095</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">1121.29</span><span class="p">,</span> <span class="mi">1460</span><span class="p">)</span>
        <span class="n">mat_refl_roof_membrane</span><span class="o">.</span><span class="n">setThermalAbsorptance</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">mat_refl_roof_membrane</span><span class="o">.</span><span class="n">setSolarAbsorptance</span><span class="p">(</span><span class="mf">0.45</span><span class="p">)</span>
        <span class="n">mat_refl_roof_membrane</span><span class="o">.</span><span class="n">setVisibleAbsorptance</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">mat_refl_roof_membrane</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Roof Membrane - Highly Reflective&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
        <span class="n">carpet_thickness_m</span> <span class="o">=</span> <span class="n">DISTANCE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">carpet_thickness_in</span> <span class="o">/</span> <span class="mf">12.0</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;ft&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">conductivity_si</span> <span class="o">=</span> <span class="mf">0.06</span>
        <span class="n">mat_thin_carpet_tile</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;MediumRough&#39;</span><span class="p">,</span> <span class="n">carpet_thickness_m</span><span class="p">,</span> <span class="n">conductivity_si</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">1380</span><span class="p">)</span>
        <span class="n">mat_thin_carpet_tile</span><span class="o">.</span><span class="n">setThermalAbsorptance</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="n">mat_thin_carpet_tile</span><span class="o">.</span><span class="n">setSolarAbsorptance</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">mat_thin_carpet_tile</span><span class="o">.</span><span class="n">setVisibleAbsorptance</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">mat_thin_carpet_tile</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Slab Thin Carpet Tile&#39;</span><span class="p">)</span>

    <span class="c1"># set exterior slab insulation thickness based on climate zone</span>
    <span class="n">slab_insulation_thickness_m</span> <span class="o">=</span> <span class="mf">0.0254</span> <span class="o">*</span> <span class="n">cz_mult</span>
    <span class="n">mat_slab_insulation</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Rough&#39;</span><span class="p">,</span> <span class="n">slab_insulation_thickness_m</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">56.06</span><span class="p">,</span> <span class="mi">1210</span><span class="p">)</span>
    <span class="n">slab_in_name</span> <span class="o">=</span> <span class="s1">&#39;Radiant Ground Slab Insulation - </span><span class="si">{}</span><span class="s1"> in.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cz_mult</span><span class="p">)</span>
    <span class="n">mat_slab_insulation</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">slab_in_name</span><span class="p">)</span>

    <span class="n">ext_insulation_thickness_m</span> <span class="o">=</span> <span class="mf">0.0254</span> <span class="o">*</span> <span class="p">(</span><span class="n">cz_mult</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mat_ext_insulation</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Rough&#39;</span><span class="p">,</span> <span class="n">ext_insulation_thickness_m</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">56.06</span><span class="p">,</span> <span class="mi">1210</span><span class="p">)</span>
    <span class="n">ext_in_name</span> <span class="o">=</span> <span class="s1">&#39;Radiant Exterior Slab Insulation - </span><span class="si">{}</span><span class="s1"> in.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cz_mult</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mat_ext_insulation</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">ext_in_name</span><span class="p">)</span>

    <span class="n">roof_insulation_thickness_m</span> <span class="o">=</span> <span class="mf">0.0254</span> <span class="o">*</span> <span class="p">(</span><span class="n">cz_mult</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">mat_roof_insulation</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">StandardOpaqueMaterial</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Rough&#39;</span><span class="p">,</span> <span class="n">roof_insulation_thickness_m</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">56.06</span><span class="p">,</span> <span class="mi">1210</span><span class="p">)</span>
    <span class="n">rf_in_name</span> <span class="o">=</span> <span class="s1">&#39;Radiant Exterior Ceiling Insulation - </span><span class="si">{}</span><span class="s1"> in.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">cz_mult</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">mat_roof_insulation</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">rf_in_name</span><span class="p">)</span>

    <span class="c1"># create radiant internal source constructions</span>
    <span class="c1"># create radiant internal source constructions</span>
    <span class="n">radiant_ground_slab_construction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">radiant_exterior_slab_construction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">radiant_interior_floor_slab_construction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">radiant_interior_ceiling_slab_construction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">radiant_ceiling_slab_construction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">radiant_interior_ceiling_metal_construction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">radiant_ceiling_metal_construction</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floor&#39;</span><span class="p">:</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_slab_insulation</span><span class="p">,</span> <span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">mat_concrete_1_5in</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_ground_slab_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_ground_slab_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_ground_slab_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Ground Slab Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_ground_slab_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">radiant_ground_slab_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">radiant_ground_slab_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_ext_insulation</span><span class="p">,</span> <span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">mat_concrete_1_5in</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_exterior_slab_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_exterior_slab_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_exterior_slab_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Exterior Slab Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_exterior_slab_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">radiant_exterior_slab_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">radiant_exterior_slab_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">mat_concrete_1_5in</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_interior_floor_slab_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_interior_floor_slab_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_interior_floor_slab_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Interior Floor Slab Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_interior_floor_slab_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">radiant_interior_floor_slab_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">radiant_interior_floor_slab_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

    <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceiling&#39;</span><span class="p">:</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">mat_concrete_1_5in</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_interior_ceiling_slab_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_slab_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_slab_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Interior Ceiling Slab Construction&#39;</span><span class="p">)</span>
        <span class="n">slab_src_loc</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">include_carpet</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">radiant_interior_ceiling_slab_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="n">slab_src_loc</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_slab_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span>
            <span class="n">slab_src_loc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_slab_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_refl_roof_membrane</span><span class="p">,</span> <span class="n">mat_roof_insulation</span><span class="p">,</span>
                  <span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">mat_concrete_1_5in</span><span class="p">]</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_ceiling_slab_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_ceiling_slab_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_ceiling_slab_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Exterior Ceiling Slab Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_ceiling_slab_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">radiant_ceiling_slab_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">radiant_ceiling_slab_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

    <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceilingmetalpanel&#39;</span><span class="p">:</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">air_gap_mat</span><span class="p">,</span> <span class="n">metal_mat</span><span class="p">,</span> <span class="n">metal_mat</span><span class="p">]</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_interior_ceiling_metal_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_metal_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_metal_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Interior Ceiling Metal Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_metal_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_metal_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">radiant_interior_ceiling_metal_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.1524</span><span class="p">)</span>  <span class="c1"># 6 inches</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_refl_roof_membrane</span><span class="p">,</span> <span class="n">mat_roof_insulation</span><span class="p">,</span> <span class="n">mat_concrete_3_5in</span><span class="p">,</span>
                  <span class="n">air_gap_mat</span><span class="p">,</span> <span class="n">metal_mat</span><span class="p">,</span> <span class="n">metal_mat</span><span class="p">]</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_ceiling_metal_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_ceiling_metal_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_ceiling_metal_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant Ceiling Metal Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_ceiling_metal_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">radiant_ceiling_metal_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">radiant_ceiling_metal_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.1524</span><span class="p">)</span>  <span class="c1"># 6 inches</span>

    <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floorwithhardwood&#39;</span><span class="p">:</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_slab_insulation</span><span class="p">,</span> <span class="n">mat_concrete_3_5in</span><span class="p">,</span> <span class="n">wood_mat</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_ground_wood_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_ground_wood_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_ground_wood_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Ground Slab Wood Floor Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_ground_wood_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">radiant_ground_wood_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">radiant_ground_wood_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_ext_insulation</span><span class="p">,</span> <span class="n">wood_mat</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_exterior_wood_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_exterior_wood_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_exterior_wood_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Exterior Wood Floor Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_exterior_wood_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">radiant_exterior_wood_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">radiant_exterior_wood_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">gypsum_ceiling_mat</span><span class="p">,</span> <span class="n">wood_floor_insulation</span><span class="p">,</span> <span class="n">wood_mat</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">include_carpet</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat_thin_carpet_tile</span><span class="p">)</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">os_create_vector</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">MaterialVector</span><span class="p">())</span>
        <span class="n">radiant_interior_wood_floor_construction</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ConstructionWithInternalSource</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">radiant_interior_wood_floor_construction</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">radiant_interior_wood_floor_construction</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;Radiant Interior Wooden Floor Construction&#39;</span><span class="p">)</span>
        <span class="n">radiant_interior_wood_floor_construction</span><span class="o">.</span><span class="n">setSourcePresentAfterLayerNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">radiant_interior_wood_floor_construction</span><span class="o">.</span><span class="n">setTemperatureCalculationRequestedAfterLayerNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">radiant_interior_wood_floor_construction</span><span class="o">.</span><span class="n">setTubeSpacing</span><span class="p">(</span><span class="mf">0.2286</span><span class="p">)</span>  <span class="c1"># 9 inches</span>

    <span class="c1"># adjust hot and chilled water loop temperatures and set new setpoint schedules</span>
    <span class="n">radiant_htg_dsgn_sup_wtr_temp_delt_r</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="n">radiant_htg_dsgn_sup_wtr_temp_c</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">radiant_htg_dsgn_sup_wtr_temp_delt_k</span> <span class="o">=</span> \
        <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">radiant_htg_dsgn_sup_wtr_temp_delt_r</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span>
        <span class="n">radiant_htg_dsgn_sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span>
        <span class="n">radiant_htg_dsgn_sup_wtr_temp_delt_k</span><span class="p">)</span>
    <span class="n">hw_sch_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="nb">round</span><span class="p">(</span><span class="n">radiant_htg_dsgn_sup_wtr_temp_f</span><span class="p">))</span>
    <span class="n">hw_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">radiant_htg_dsgn_sup_wtr_temp_c</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">hw_sch_name</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">spm</span> <span class="ow">in</span> <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">()</span><span class="o">.</span><span class="n">setpointManagers</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerScheduled</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">spm</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerScheduled</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">spm</span><span class="o">.</span><span class="n">setSchedule</span><span class="p">(</span><span class="n">hw_temp_sch</span><span class="p">)</span>

    <span class="n">radiant_clg_dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mf">55.0</span>
    <span class="n">radiant_clg_dsgn_sup_wtr_temp_delt_r</span> <span class="o">=</span> <span class="mf">5.0</span>
    <span class="n">radiant_clg_dsgn_sup_wtr_temp_c</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">radiant_clg_dsgn_sup_wtr_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">radiant_clg_dsgn_sup_wtr_temp_delt_k</span> <span class="o">=</span> \
        <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">radiant_clg_dsgn_sup_wtr_temp_delt_r</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">setDesignLoopExitTemperature</span><span class="p">(</span>
        <span class="n">radiant_clg_dsgn_sup_wtr_temp_c</span><span class="p">)</span>
    <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">setLoopDesignTemperatureDifference</span><span class="p">(</span>
        <span class="n">radiant_clg_dsgn_sup_wtr_temp_delt_k</span><span class="p">)</span>
    <span class="n">chw_sch_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="nb">round</span><span class="p">(</span><span class="n">radiant_clg_dsgn_sup_wtr_temp_f</span><span class="p">))</span>
    <span class="n">chw_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">radiant_clg_dsgn_sup_wtr_temp_c</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">chw_sch_name</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">spm</span> <span class="ow">in</span> <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">()</span><span class="o">.</span><span class="n">setpointManagers</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerScheduled</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">spm</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerScheduled</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">spm</span><span class="o">.</span><span class="n">setSchedule</span><span class="p">(</span><span class="n">chw_temp_sch</span><span class="p">)</span>

    <span class="c1"># default temperature controls for radiant system</span>
    <span class="n">zn_radiant_htg_dsgn_temp_f</span> <span class="o">=</span> <span class="mf">68.0</span>
    <span class="n">zn_radiant_htg_dsgn_temp_c</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">zn_radiant_htg_dsgn_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">zn_radiant_clg_dsgn_temp_f</span> <span class="o">=</span> <span class="mf">74.0</span>
    <span class="n">zn_radiant_clg_dsgn_temp_c</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">zn_radiant_clg_dsgn_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">htg_sch_name</span> <span class="o">=</span> <span class="s1">&#39;Zone Radiant Loop Heating Threshold Temperature Schedule &#39;</span> \
        <span class="s1">&#39;- </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zn_radiant_htg_dsgn_temp_f</span><span class="p">))</span>
    <span class="n">htg_control_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">zn_radiant_htg_dsgn_temp_c</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">htg_sch_name</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">clg_sch_name</span> <span class="o">=</span> <span class="s1">&#39;Zone Radiant Loop Cooling Threshold Temperature Schedule &#39;</span> \
        <span class="s1">&#39;- </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zn_radiant_clg_dsgn_temp_f</span><span class="p">))</span>
    <span class="n">clg_control_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">zn_radiant_clg_dsgn_temp_c</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">clg_sch_name</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
    <span class="n">throttling_range_f</span> <span class="o">=</span> <span class="mf">4.0</span>  <span class="c1"># 2 degF on either side of control temperature</span>
    <span class="n">throttling_range_c</span> <span class="o">=</span> <span class="n">TEMP_DELTA</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">throttling_range_f</span><span class="p">],</span> <span class="s1">&#39;dC&#39;</span><span class="p">,</span> <span class="s1">&#39;dF&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># create preset availability schedule for radiant loop</span>
    <span class="n">radiant_avail_sch</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ScheduleRuleset</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Radiant System Availability Schedule&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">radiant_lockout</span><span class="p">:</span>
        <span class="n">radiant_availability_type</span> <span class="o">=</span> <span class="n">radiant_availability_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">radiant_availability_type</span> <span class="o">==</span> <span class="s1">&#39;all_day&#39;</span><span class="p">:</span>
            <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">24</span>
            <span class="n">start_minute</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end_hour</span> <span class="o">=</span> <span class="mi">24</span>
            <span class="n">end_minute</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">radiant_availability_type</span> <span class="o">==</span> <span class="s1">&#39;afternoon_shutoff&#39;</span><span class="p">:</span>
            <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">15</span>
            <span class="n">start_minute</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end_hour</span> <span class="o">=</span> <span class="mi">22</span>
            <span class="n">end_minute</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">radiant_availability_type</span> <span class="o">==</span> <span class="s1">&#39;precool&#39;</span><span class="p">:</span>
            <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">start_minute</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end_hour</span> <span class="o">=</span> <span class="mi">22</span>
            <span class="n">end_minute</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">radiant_availability_type</span> <span class="o">==</span> <span class="s1">&#39;occupancy&#39;</span><span class="p">:</span>
            <span class="n">start_hour</span> <span class="o">=</span> <span class="n">model_occ_hr_end</span><span class="o">.</span><span class="n">to_i</span>
            <span class="n">start_minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">model_occ_hr_end</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
            <span class="n">end_hour</span> <span class="o">=</span> <span class="n">model_occ_hr_start</span><span class="o">.</span><span class="n">to_i</span>
            <span class="n">end_minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">model_occ_hr_start</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Unsupported radiant availability preset &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span> \
                <span class="s1">&#39; Defaulting to all day operation.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">radiant_availability_type</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">24</span>
            <span class="n">start_minute</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end_hour</span> <span class="o">=</span> <span class="mi">24</span>
            <span class="n">end_minute</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># create custom availability schedule for radiant loop</span>
    <span class="k">if</span> <span class="n">radiant_lockout</span><span class="p">:</span>
        <span class="n">start_hour</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">radiant_lockout_start_time</span><span class="p">)</span>
        <span class="n">start_minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">radiant_lockout_start_time</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
        <span class="n">end_hour</span> <span class="o">=</span> <span class="n">radiant_lockout_end_time</span><span class="o">.</span><span class="n">to_i</span>
        <span class="n">end_minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">radiant_lockout_end_time</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="c1"># create availability schedules</span>
    <span class="k">if</span> <span class="n">end_hour</span> <span class="o">&gt;</span> <span class="n">start_hour</span><span class="p">:</span>
        <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
            <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start_hour</span><span class="p">,</span> <span class="n">start_minute</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
            <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_hour</span><span class="p">,</span> <span class="n">end_minute</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_hour</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
                <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">start_hour</span> <span class="o">&gt;</span> <span class="n">end_hour</span><span class="p">:</span>
        <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
            <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_hour</span><span class="p">,</span> <span class="n">end_minute</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
            <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start_hour</span><span class="p">,</span> <span class="n">start_minute</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_hour</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
                <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">radiant_avail_sch</span><span class="o">.</span><span class="n">defaultDaySchedule</span><span class="p">()</span><span class="o">.</span><span class="n">addValue</span><span class="p">(</span>
            <span class="n">openstudio</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># add supply water temperature control if enabled</span>
    <span class="k">if</span> <span class="n">plant_supply_water_temperature_control</span><span class="p">:</span>
        <span class="c1"># add supply water temperature for heating plant loop</span>
        <span class="n">model_add_plant_supply_water_temperature_control</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span>
            <span class="n">control_strategy</span><span class="o">=</span><span class="n">plant_supply_water_temperature_control_strategy</span><span class="p">,</span>
            <span class="n">sp_at_oat_low</span><span class="o">=</span><span class="n">hwsp_at_oat_low</span><span class="p">,</span> <span class="n">oat_low</span><span class="o">=</span><span class="n">hw_oat_low</span><span class="p">,</span>
            <span class="n">sp_at_oat_high</span><span class="o">=</span><span class="n">hwsp_at_oat_high</span><span class="p">,</span> <span class="n">oat_high</span><span class="o">=</span><span class="n">hw_oat_high</span><span class="p">,</span>
            <span class="n">thermal_zones</span><span class="o">=</span><span class="n">thermal_zones</span><span class="p">)</span>

        <span class="c1"># add supply water temperature for cooling plant loop</span>
        <span class="n">model_add_plant_supply_water_temperature_control</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">control_strategy</span><span class="o">=</span><span class="n">plant_supply_water_temperature_control_strategy</span><span class="p">,</span>
            <span class="n">sp_at_oat_low</span><span class="o">=</span><span class="n">chwsp_at_oat_low</span><span class="p">,</span> <span class="n">oat_low</span><span class="o">=</span><span class="n">chw_oat_low</span><span class="p">,</span>
            <span class="n">sp_at_oat_high</span><span class="o">=</span><span class="n">chwsp_at_oat_high</span><span class="p">,</span> <span class="n">oat_high</span><span class="o">=</span><span class="n">chw_oat_high</span><span class="p">,</span>
            <span class="n">thermal_zones</span><span class="o">=</span><span class="n">thermal_zones</span><span class="p">)</span>

    <span class="c1"># make a low temperature radiant loop for each zone</span>
    <span class="n">radiant_loops</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">zone_name</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Thermal zone &quot;</span><span class="si">{}</span><span class="s1">&quot; has a restricted character &quot;:&quot; in the name and &#39;</span> \
                <span class="s1">&#39;will not work with some EMS and output reporting objects. &#39;</span>\
                <span class="s1">&#39;Please rename the zone&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># assign internal source construction to floors in zone</span>
        <span class="n">srf_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">space</span> <span class="ow">in</span> <span class="n">zone</span><span class="o">.</span><span class="n">spaces</span><span class="p">():</span>
            <span class="n">surfaces</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">surfaces</span><span class="p">()</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">space</span><span class="o">.</span><span class="n">surfaces</span>
            <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">isAirWall</span><span class="p">():</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floor&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">surfaceType</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Floor&#39;</span><span class="p">:</span>
                        <span class="n">srf_count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">outsideBoundaryCondition</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Ground&#39;</span><span class="p">:</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_ground_slab_construction</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">surface</span><span class="o">.</span><span class="n">outsideBoundaryCondition</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Outdoors&#39;</span><span class="p">:</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_exterior_slab_construction</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># interior floor</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_interior_floor_slab_construction</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceiling&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">surfaceType</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;RoofCeiling&#39;</span><span class="p">:</span>
                        <span class="n">srf_count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">outsideBoundaryCondition</span> <span class="o">==</span> <span class="s1">&#39;Outdoors&#39;</span><span class="p">:</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_ceiling_slab_construction</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># interior ceiling</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_interior_ceiling_slab_construction</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceilingmetalpanel&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">surfaceType</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;RoofCeiling&#39;</span><span class="p">:</span>
                        <span class="n">srf_count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">outsideBoundaryCondition</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Outdoors&#39;</span><span class="p">:</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_ceiling_metal_construction</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># interior ceiling</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_interior_ceiling_metal_construction</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floorwithhardwood&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">surfaceType</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Floor&#39;</span><span class="p">:</span>
                        <span class="n">srf_count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">surface</span><span class="o">.</span><span class="n">outsideBoundaryCondition</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Ground&#39;</span><span class="p">:</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_ground_wood_construction</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">surface</span><span class="o">.</span><span class="n">outsideBoundaryCondition</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Outdoors&#39;</span><span class="p">:</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_exterior_wood_construction</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># interior floor</span>
                            <span class="n">surface</span><span class="o">.</span><span class="n">setConstruction</span><span class="p">(</span><span class="n">radiant_interior_wood_floor_construction</span><span class="p">)</span>

        <span class="c1"># ignore the Zone if it has not thermally active Faces</span>
        <span class="k">if</span> <span class="n">srf_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># create radiant coils</span>
        <span class="n">radiant_loop_htg_coil</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoilHeatingLowTempRadiantVarFlow</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">htg_control_temp_sch</span><span class="p">)</span>
        <span class="n">radiant_loop_htg_coil</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Radiant Loop Heating Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">radiant_loop_htg_coil</span><span class="o">.</span><span class="n">setHeatingControlThrottlingRange</span><span class="p">(</span><span class="n">throttling_range_c</span><span class="p">)</span>
        <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">radiant_loop_htg_coil</span><span class="p">)</span>

        <span class="n">radiant_loop_clg_coil</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">CoilCoolingLowTempRadiantVarFlow</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">clg_control_temp_sch</span><span class="p">)</span>
        <span class="n">radiant_loop_clg_coil</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Radiant Loop Cooling Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">radiant_loop_clg_coil</span><span class="o">.</span><span class="n">setCoolingControlThrottlingRange</span><span class="p">(</span><span class="n">throttling_range_c</span><span class="p">)</span>
        <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">radiant_loop_clg_coil</span><span class="p">)</span>

        <span class="n">radiant_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACLowTempRadiantVarFlow</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">radiant_avail_sch</span><span class="p">,</span> <span class="n">radiant_loop_htg_coil</span><span class="p">,</span> <span class="n">radiant_loop_clg_coil</span><span class="p">)</span>

        <span class="c1"># radiant loop surfaces</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Radiant Loop&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floor&#39;</span><span class="p">:</span>
            <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setRadiantSurfaceType</span><span class="p">(</span><span class="s1">&#39;Floors&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceiling&#39;</span><span class="p">:</span>
            <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setRadiantSurfaceType</span><span class="p">(</span><span class="s1">&#39;Ceilings&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;ceilingmetalpanel&#39;</span><span class="p">:</span>
            <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setRadiantSurfaceType</span><span class="p">(</span><span class="s1">&#39;Ceilings&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">radiant_type</span> <span class="o">==</span> <span class="s1">&#39;floorwithhardwood&#39;</span><span class="p">:</span>
            <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setRadiantSurfaceType</span><span class="p">(</span><span class="s1">&#39;Floors&#39;</span><span class="p">)</span>

        <span class="c1"># radiant loop layout details</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setHydronicTubingInsideDiameter</span><span class="p">(</span><span class="mf">0.015875</span><span class="p">)</span>  <span class="c1"># 5/8 in. ID, 3/4 in. OD</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setNumberofCircuits</span><span class="p">(</span><span class="s1">&#39;CalculateFromCircuitLength&#39;</span><span class="p">)</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setCircuitLength</span><span class="p">(</span><span class="mf">106.7</span><span class="p">)</span>

        <span class="c1"># radiant loop temperature controls</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setTemperatureControlType</span><span class="p">(</span><span class="n">radiant_temperature_control_type</span><span class="p">)</span>

        <span class="c1"># radiant loop setpoint temperature response</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">setSetpointControlType</span><span class="p">(</span><span class="n">radiant_setpoint_control_type</span><span class="p">)</span>
        <span class="n">radiant_loop</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">radiant_loops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radiant_loop</span><span class="p">)</span>

        <span class="c1"># rename nodes before adding EMS code</span>
        <span class="n">rename_plant_loop_nodes</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="c1"># set radiant loop controls</span>
        <span class="n">control_strategy</span> <span class="o">=</span> <span class="n">control_strategy</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">control_strategy</span> <span class="o">==</span> <span class="s1">&#39;proportional_control&#39;</span><span class="p">:</span>
            <span class="c1"># slab setpoint varies based on previous day zone conditions</span>
            <span class="n">model_add_radiant_proportional_controls</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">radiant_loop</span><span class="p">,</span>
                <span class="n">radiant_temperature_control_type</span><span class="o">=</span><span class="n">radiant_temperature_control_type</span><span class="p">,</span>
                <span class="n">use_zone_occupancy_for_control</span><span class="o">=</span><span class="n">use_zone_occupancy_for_control</span><span class="p">,</span>
                <span class="n">occupied_percentage_threshold</span><span class="o">=</span><span class="n">occupied_percentage_threshold</span><span class="p">,</span>
                <span class="n">model_occ_hr_start</span><span class="o">=</span><span class="n">model_occ_hr_start</span><span class="p">,</span> <span class="n">model_occ_hr_end</span><span class="o">=</span><span class="n">model_occ_hr_end</span><span class="p">,</span>
                <span class="n">proportional_gain</span><span class="o">=</span><span class="n">proportional_gain</span><span class="p">,</span> <span class="n">switch_over_time</span><span class="o">=</span><span class="n">switch_over_time</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">control_strategy</span> <span class="o">==</span> <span class="s1">&#39;oa_based_control&#39;</span><span class="p">:</span>
            <span class="c1"># slab setpoint varies based on outdoor weather</span>
            <span class="n">model_add_radiant_basic_controls</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">radiant_loop</span><span class="p">,</span>
                <span class="n">radiant_temperature_control_type</span><span class="o">=</span><span class="n">radiant_temperature_control_type</span><span class="p">,</span>
                <span class="n">slab_setpoint_oa_control</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">switch_over_time</span><span class="o">=</span><span class="n">switch_over_time</span><span class="p">,</span>
                <span class="n">slab_sp_at_oat_low</span><span class="o">=</span><span class="n">slab_sp_at_oat_low</span><span class="p">,</span> <span class="n">slab_oat_low</span><span class="o">=</span><span class="n">slab_oat_low</span><span class="p">,</span>
                <span class="n">slab_sp_at_oat_high</span><span class="o">=</span><span class="n">slab_sp_at_oat_high</span><span class="p">,</span> <span class="n">slab_oat_high</span><span class="o">=</span><span class="n">slab_oat_high</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">control_strategy</span> <span class="o">==</span> <span class="s1">&#39;constant_control&#39;</span><span class="p">:</span>
            <span class="c1"># constant slab setpoint control</span>
            <span class="n">model_add_radiant_basic_controls</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">radiant_loop</span><span class="p">,</span>
                <span class="n">radiant_temperature_control_type</span><span class="o">=</span><span class="n">radiant_temperature_control_type</span><span class="p">,</span>
                <span class="n">slab_setpoint_oa_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">switch_over_time</span><span class="o">=</span><span class="n">switch_over_time</span><span class="p">,</span>
                <span class="n">slab_sp_at_oat_low</span><span class="o">=</span><span class="n">slab_sp_at_oat_low</span><span class="p">,</span> <span class="n">slab_oat_low</span><span class="o">=</span><span class="n">slab_oat_low</span><span class="p">,</span>
                <span class="n">slab_sp_at_oat_high</span><span class="o">=</span><span class="n">slab_sp_at_oat_high</span><span class="p">,</span> <span class="n">slab_oat_high</span><span class="o">=</span><span class="n">slab_oat_high</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">radiant_loops</span></div>



<div class="viewcode-block" id="model_add_window_ac">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_window_ac">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_window_ac</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a window air conditioner to each zone. Code adapted from.</span>

<span class="sd">    https://github.com/NREL/OpenStudio-BEopt/blob/master/measures/</span>
<span class="sd">    ResidentialHVACRoomAirConditioner/measure.rb</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to add window AC units to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Defaults</span>
    <span class="n">eer</span> <span class="o">=</span> <span class="mf">8.5</span>  <span class="c1"># Btu/W-h</span>
    <span class="n">cop</span> <span class="o">=</span> <span class="n">POWER</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">eer</span><span class="p">],</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;Btu/h&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># ratio of the sensible portion of the load to the total load:</span>
    <span class="n">shr</span> <span class="o">=</span> <span class="mf">0.65</span>  <span class="c1"># sensible heat ratio at the nominal rated capacity</span>

    <span class="n">acs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Window AC Cooling Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Window AC&#39;</span><span class="p">,</span> <span class="n">cop</span><span class="o">=</span><span class="n">cop</span><span class="p">)</span>
        <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedSensibleHeatRatio</span><span class="p">(</span><span class="n">shr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedEvaporatorFanPowerPerVolumeFlowRate</span><span class="p">(</span><span class="mf">773.3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedEvaporatorFanPowerPerVolumeFlowRate2017</span><span class="p">(</span><span class="mf">773.3</span><span class="p">)</span>
        <span class="n">clg_coil</span><span class="o">.</span><span class="n">setEvaporativeCondenserEffectiveness</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="n">clg_coil</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureForCrankcaseHeaterOperation</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">clg_coil</span><span class="o">.</span><span class="n">setBasinHeaterSetpointTemperature</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Window_AC_Supply_Fan&#39;</span><span class="p">,</span>
            <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Window AC Supply Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
            <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;Window AC Fans&#39;</span><span class="p">)</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Window AC Always Off Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span>
            <span class="n">schedule</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">(),</span> <span class="n">nominal_capacity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ptac</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACPackagedTerminalAirConditioner</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">fan</span><span class="p">,</span> <span class="n">htg_coil</span><span class="p">,</span> <span class="n">clg_coil</span><span class="p">)</span>
        <span class="n">ptac</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Window AC&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">ptac</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>
        <span class="n">ptac</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">acs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptac</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">acs</span></div>



<div class="viewcode-block" id="model_add_furnace_central_ac">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_furnace_central_ac">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_furnace_central_ac</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">heating_type</span><span class="o">=</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a forced air furnace or central AC to each zone.</span>

<span class="sd">    Default is a forced air furnace without outdoor air. Code adapted from.</span>

<span class="sd">    https://github.com/NREL/OpenStudio-BEopt/blob/master/measures/</span>
<span class="sd">    ResidentialHVACFurnaceFuel/measure.rb</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            add furnace to.</span>
<span class="sd">        heating: [Boolean] if true, the unit will include a heating coil.</span>
<span class="sd">        cooling: [Boolean] if true, the unit will include a DX cooling coil.</span>
<span class="sd">        ventilation: [Boolean] if true, the unit will include an OA intake.</span>
<span class="sd">        heating_type: [String] valid choices are NaturalGas, Gas, Electricity, Electric.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">heating</span> <span class="ow">and</span> <span class="n">cooling</span><span class="p">:</span>
        <span class="n">equip_name</span> <span class="o">=</span> <span class="s1">&#39;Central Heating and AC&#39;</span>
    <span class="k">elif</span> <span class="n">heating</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cooling</span><span class="p">:</span>
        <span class="n">equip_name</span> <span class="o">=</span> <span class="s1">&#39;Furnace&#39;</span>
    <span class="k">elif</span> <span class="n">cooling</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">heating</span><span class="p">:</span>
        <span class="n">equip_name</span> <span class="o">=</span> <span class="s1">&#39;Central AC&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Heating and cooling both disabled, not a valid Furnace or &#39;</span> \
            <span class="s1">&#39;Central AC selection, no equipment was added.&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># defaults</span>
    <span class="n">afue</span> <span class="o">=</span> <span class="mf">0.78</span>
    <span class="c1"># seer = 13.0</span>
    <span class="n">eer</span> <span class="o">=</span> <span class="mf">11.1</span>
    <span class="n">shr</span> <span class="o">=</span> <span class="mf">0.73</span>
    <span class="n">ac_w_per_cfm</span> <span class="o">=</span> <span class="mf">0.365</span>
    <span class="n">crank_case_heat_w</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">crank_case_max_temp_f</span> <span class="o">=</span> <span class="mf">55.0</span>

    <span class="n">furnaces</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">,</span> <span class="n">equip_name</span><span class="p">))</span>
        <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># default design temperatures across all air loops</span>
        <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

        <span class="c1"># adjusted temperatures for furnace_central_ac</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span>
        <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span>

        <span class="c1"># default design settings used across all air loops</span>
        <span class="n">sizing_system</span> <span class="o">=</span> <span class="n">adjust_sizing_system</span><span class="p">(</span>
            <span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">,</span> <span class="n">sizing_option</span><span class="o">=</span><span class="s1">&#39;NonCoincident&#39;</span><span class="p">)</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinCooling</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinHeating</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># create heating coil</span>
        <span class="n">htg_coil</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">heating</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;NaturalGas&#39;</span> <span class="k">if</span> <span class="n">heating_type</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">heating_type</span>
            <span class="k">if</span> <span class="n">heating_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
                <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_gas</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Heating Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span> <span class="n">efficiency</span><span class="o">=</span><span class="n">afue</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># electric coil</span>
                <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Heating Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

        <span class="c1"># create cooling coil</span>
        <span class="n">clg_coil</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cooling</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Cooling Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Residential Central AC&#39;</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedSensibleHeatRatio</span><span class="p">(</span><span class="n">shr</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedCOP</span><span class="p">(</span><span class="n">eer_to_cop_no_fan</span><span class="p">(</span><span class="n">eer</span><span class="p">))</span>
            <span class="n">ac_w_per_mps</span> <span class="o">=</span> <span class="n">ac_w_per_cfm</span> <span class="o">/</span> <span class="n">FLOW_RATE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;m3/s&#39;</span><span class="p">,</span> <span class="s1">&#39;cfm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
                <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedEvaporatorFanPowerPerVolumeFlowRate</span><span class="p">(</span><span class="n">ac_w_per_mps</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedEvaporatorFanPowerPerVolumeFlowRate2017</span><span class="p">(</span><span class="n">ac_w_per_mps</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setNominalTimeForCondensateRemovalToBegin</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatioOfInitialMoistureEvaporationRateAndSteadyStateLatentCapacity</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setMaximumCyclingRate</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setLatentCapacityTimeConstant</span><span class="p">(</span><span class="mf">45.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setCondenserType</span><span class="p">(</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setCrankcaseHeaterCapacity</span><span class="p">(</span><span class="n">crank_case_heat_w</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureForCrankcaseHeaterOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">crank_case_max_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># create fan</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Residential_HVAC_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;Residential HVAC Fans&#39;</span><span class="p">)</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="c1"># create outdoor air intake</span>
            <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
            <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
            <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
            <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># create unitary system (holds the coils and fan)</span>
        <span class="n">unitary</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACUnitarySystem</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">])</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setControllingZoneorThermostatLocation</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># set flow rates during different conditions</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">heating</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFlowRateDuringHeatingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cooling</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFlowRateDuringCoolingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># attach the coils and fan</span>
        <span class="k">if</span> <span class="n">htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setHeatingCoil</span><span class="p">(</span><span class="n">htg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setCoolingCoil</span><span class="p">(</span><span class="n">clg_coil</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyFan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># create a diffuser</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">diffuser</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Direct Air&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">diffuser</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="n">furnaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">air_loop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">furnaces</span></div>



<div class="viewcode-block" id="model_add_central_air_source_heat_pump">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_central_air_source_heat_pump">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_central_air_source_heat_pump</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds an air source heat pump to each zone. Code adapted from.</span>

<span class="sd">    https://github.com/NREL/OpenStudio-BEopt/blob/master/measures/</span>
<span class="sd">    ResidentialHVACAirSourceHeatPumpSingleSpeed/measure.rb</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            to add fan coil units to.</span>
<span class="sd">        heating: [Boolean] if true, the unit will include a heating coil.</span>
<span class="sd">        cooling: [Boolean] if true, the unit will include a DX cooling coil.</span>
<span class="sd">        ventilation: [Boolean] if true, the unit will include an OA intake.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># defaults</span>
    <span class="n">hspf</span> <span class="o">=</span> <span class="mf">7.7</span>
    <span class="c1"># seer = 13.0</span>
    <span class="c1"># eer = 11.4</span>
    <span class="n">cop</span> <span class="o">=</span> <span class="mf">3.05</span>
    <span class="n">shr</span> <span class="o">=</span> <span class="mf">0.73</span>
    <span class="n">ac_w_per_cfm</span> <span class="o">=</span> <span class="mf">0.365</span>
    <span class="n">min_hp_oat_f</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">crank_case_heat_w</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">crank_case_max_temp_f</span> <span class="o">=</span> <span class="mi">55</span>

    <span class="c1"># default design temperatures across all air loops</span>
    <span class="n">dsgn_temps</span> <span class="o">=</span> <span class="n">standard_design_sizing_temperatures</span><span class="p">()</span>

    <span class="c1"># adjusted temperatures for furnace_central_ac</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">122.0</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_f&#39;</span><span class="p">]</span>
    <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsgn_temps</span><span class="p">[</span><span class="s1">&#39;zn_htg_dsgn_sup_air_temp_c&#39;</span><span class="p">]</span>

    <span class="n">hps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVAC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Central Air Source HP&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">loop_name</span> <span class="o">=</span> <span class="n">air_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>

        <span class="c1"># default design settings used across all air loops</span>
        <span class="n">sizing_system</span> <span class="o">=</span> <span class="n">adjust_sizing_system</span><span class="p">(</span>
            <span class="n">air_loop</span><span class="p">,</span> <span class="n">dsgn_temps</span><span class="p">,</span> <span class="n">sizing_option</span><span class="o">=</span><span class="s1">&#39;NonCoincident&#39;</span><span class="p">)</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinCooling</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sizing_system</span><span class="o">.</span><span class="n">setAllOutdoorAirinHeating</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># create heating coil</span>
        <span class="n">htg_coil</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">heating</span><span class="p">:</span>
            <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> heating coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Residential Central Air Source HP&#39;</span><span class="p">,</span> <span class="n">cop</span><span class="o">=</span><span class="n">hspf_to_cop_no_fan</span><span class="p">(</span><span class="n">hspf</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
                <span class="n">htg_coil</span><span class="o">.</span><span class="n">setRatedSupplyFanPowerPerVolumeFlowRate</span><span class="p">(</span>
                    <span class="n">ac_w_per_cfm</span> <span class="o">/</span> <span class="n">FLOW_RATE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;m3/s&#39;</span><span class="p">,</span> <span class="s1">&#39;cfm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">htg_coil</span><span class="o">.</span><span class="n">setRatedSupplyFanPowerPerVolumeFlowRate2017</span><span class="p">(</span>
                    <span class="n">ac_w_per_cfm</span> <span class="o">/</span> <span class="n">FLOW_RATE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;m3/s&#39;</span><span class="p">,</span> <span class="s1">&#39;cfm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setMinimumOutdoorDryBulbTemperatureforCompressorOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">min_hp_oat_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforDefrostOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">40.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setCrankcaseHeaterCapacity</span><span class="p">(</span><span class="n">crank_case_heat_w</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforCrankcaseHeaterOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">crank_case_max_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setDefrostStrategy</span><span class="p">(</span><span class="s1">&#39;ReverseCycle&#39;</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">setDefrostControl</span><span class="p">(</span><span class="s1">&#39;OnDemand&#39;</span><span class="p">)</span>
            <span class="n">htg_coil</span><span class="o">.</span><span class="n">resetDefrostTimePeriodFraction</span><span class="p">()</span>

            <span class="c1"># create supplemental heating coil</span>
            <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supplemental Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>

        <span class="c1"># create cooling coil</span>
        <span class="n">clg_coil</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">cooling</span><span class="p">:</span>
            <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_dx_single_speed</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Cooling Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Residential Central ASHP&#39;</span><span class="p">,</span> <span class="n">cop</span><span class="o">=</span><span class="n">cop</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedSensibleHeatRatio</span><span class="p">(</span><span class="n">shr</span><span class="p">)</span>
            <span class="n">ac_w_per_mps</span> <span class="o">=</span> <span class="n">ac_w_per_cfm</span> <span class="o">/</span> <span class="n">FLOW_RATE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;m3/s&#39;</span><span class="p">,</span> <span class="s1">&#39;cfm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;3.5.0&#39;</span><span class="p">):</span>
                <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedEvaporatorFanPowerPerVolumeFlowRate</span><span class="p">(</span><span class="n">ac_w_per_mps</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatedEvaporatorFanPowerPerVolumeFlowRate2017</span><span class="p">(</span><span class="n">ac_w_per_mps</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setNominalTimeForCondensateRemovalToBegin</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setRatioOfInitialMoistureEvaporationRateAndSteadyStateLatentCapacity</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setMaximumCyclingRate</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setLatentCapacityTimeConstant</span><span class="p">(</span><span class="mf">45.0</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setCondenserType</span><span class="p">(</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setCrankcaseHeaterCapacity</span><span class="p">(</span><span class="n">crank_case_heat_w</span><span class="p">)</span>
            <span class="n">clg_coil</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureForCrankcaseHeaterOperation</span><span class="p">(</span>
                <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">crank_case_max_temp_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># create fan</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Residential_HVAC_Fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">),</span>
            <span class="n">end_use_subcategory</span><span class="o">=</span><span class="s1">&#39;Residential HVAC Fans&#39;</span><span class="p">)</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># create outdoor air intake</span>
        <span class="k">if</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">oa_intake_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ControllerOutdoorAir</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">autosizeMinimumOutdoorAirFlowRate</span><span class="p">()</span>
            <span class="n">oa_intake_controller</span><span class="o">.</span><span class="n">resetEconomizerMinimumLimitDryBulbTemperature</span><span class="p">()</span>
            <span class="n">oa_intake</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACOutdoorAirSystem</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">oa_intake_controller</span><span class="p">)</span>
            <span class="n">oa_intake</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> OA System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
            <span class="n">oa_intake</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># create unitary system (holds the coils and fan)</span>
        <span class="n">unitary</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirLoopHVACUnitarySystem</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unitary System&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="c1"># higher temp for supplemental heat as to not severely limit its use,</span>
        <span class="c1"># resulting in unmet hours</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setMaximumSupplyAirTemperature</span><span class="p">(</span><span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">170.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setMaximumOutdoorDryBulbTemperatureforSupplementalHeaterOperation</span><span class="p">(</span>
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">40.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setControllingZoneorThermostatLocation</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">air_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># set flow rates during different conditions</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFlowRateWhenNoCoolingorHeatingisRequired</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># attach the coils and fan</span>
        <span class="k">if</span> <span class="n">htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setHeatingCoil</span><span class="p">(</span><span class="n">htg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setCoolingCoil</span><span class="p">(</span><span class="n">clg_coil</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">supplemental_htg_coil</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplementalHeatingCoil</span><span class="p">(</span><span class="n">supplemental_htg_coil</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyFan</span><span class="p">(</span><span class="n">fan</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setFanPlacement</span><span class="p">(</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span>
        <span class="n">unitary</span><span class="o">.</span><span class="n">setSupplyAirFanOperatingModeSchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOffDiscreteSchedule</span><span class="p">())</span>

        <span class="c1"># create a diffuser</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.7.0&#39;</span><span class="p">):</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctUncontrolled</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diffuser</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">AirTerminalSingleDuctConstantVolumeNoReheat</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>
        <span class="n">diffuser</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Direct Air&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">air_loop</span><span class="o">.</span><span class="n">multiAddBranchForZone</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span> <span class="n">diffuser</span><span class="o">.</span><span class="n">to_HVACComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="n">hps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">air_loop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hps</span></div>



<div class="viewcode-block" id="model_add_water_source_hp">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_water_source_hp">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_water_source_hp</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">,</span> <span class="n">condenser_loop</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds zone level water-to-air heat pumps for each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones</span>
<span class="sd">            served by heat pumps.</span>
<span class="sd">        condenser_loop [OpenStudio::Model::PlantLoop] the condenser loop for</span>
<span class="sd">            the heat pumps.</span>
<span class="sd">        ventilation [Boolean] if true, ventilation will be supplied through the unit.</span>
<span class="sd">            If false, no ventilation will be supplied through the unit, with</span>
<span class="sd">            the expectation that it will be provided by a DOAS or separate system.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">water_to_air_hp_systems</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">supplemental_htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_electric</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supplemental Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">htg_coil</span> <span class="o">=</span> <span class="n">create_coil_heating_water_to_air_heat_pump_equation_fit</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">condenser_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water-to-Air HP Htg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">clg_coil</span> <span class="o">=</span> <span class="n">create_coil_cooling_water_to_air_heat_pump_equation_fit</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">condenser_loop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Water-to-Air HP Clg Coil&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="c1"># add fan</span>
        <span class="n">fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;WSHP_Fan&#39;</span><span class="p">,</span>
                                 <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> WSHP Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">fan</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

        <span class="n">water_to_air_hp_system</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACWaterToAirHeatPump</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">(),</span> <span class="n">fan</span><span class="p">,</span> <span class="n">htg_coil</span><span class="p">,</span> <span class="n">clg_coil</span><span class="p">,</span>
            <span class="n">supplemental_htg_coil</span><span class="p">)</span>
        <span class="n">water_to_air_hp_system</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> WSHP&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ventilation</span><span class="p">:</span>
            <span class="n">water_to_air_hp_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringHeatingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">water_to_air_hp_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateDuringCoolingOperation</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">water_to_air_hp_system</span><span class="o">.</span><span class="n">setOutdoorAirFlowRateWhenNoCoolingorHeatingisNeeded</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">water_to_air_hp_system</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>

        <span class="n">water_to_air_hp_systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">water_to_air_hp_system</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">water_to_air_hp_systems</span></div>



<div class="viewcode-block" id="model_add_zone_erv">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_zone_erv">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_zone_erv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds zone level ERVs for each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            add heat pumps to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ervs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="c1"># Determine the OA requirement for this zone</span>
        <span class="n">min_oa_flow_m3_per_s_per_m2</span> <span class="o">=</span> <span class="n">thermal_zone_get_outdoor_airflow_rate_per_area</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
        <span class="n">supply_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;ERV_Supply_Fan&#39;</span><span class="p">,</span>
                                        <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV Supply Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">fan_change_impeller_efficiency</span><span class="p">(</span><span class="n">supply_fan</span><span class="p">,</span> <span class="n">impeller_eff</span><span class="o">=</span><span class="mf">0.55</span><span class="p">)</span>
        <span class="n">exhaust_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;ERV_Supply_Fan&#39;</span><span class="p">,</span>
                                         <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV Exhaust Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">fan_change_impeller_efficiency</span><span class="p">(</span><span class="n">exhaust_fan</span><span class="p">,</span> <span class="n">impeller_eff</span><span class="o">=</span><span class="mf">0.55</span><span class="p">)</span>

        <span class="n">erv_controller</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACEnergyRecoveryVentilatorController</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">erv_controller</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV Controller&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>

        <span class="n">heat_exchanger</span> <span class="o">=</span> <span class="n">create_hx_air_to_air_sensible_and_latent</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV HX&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;Plate&#39;</span><span class="p">,</span>
            <span class="n">economizer_lockout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">supply_air_outlet_temperature_control</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">sensible_heating_100_eff</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">latent_heating_100_eff</span><span class="o">=</span><span class="mf">0.68</span><span class="p">,</span>
            <span class="n">sensible_cooling_100_eff</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span> <span class="n">latent_cooling_100_eff</span><span class="o">=</span><span class="mf">0.68</span><span class="p">,)</span>

        <span class="n">zone_hvac</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACEnergyRecoveryVentilator</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">heat_exchanger</span><span class="p">,</span> <span class="n">supply_fan</span><span class="p">,</span> <span class="n">exhaust_fan</span><span class="p">)</span>
        <span class="n">zone_hvac</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ERV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">zone_hvac</span><span class="o">.</span><span class="n">setVentilationRateperUnitFloorArea</span><span class="p">(</span><span class="n">min_oa_flow_m3_per_s_per_m2</span><span class="p">)</span>
        <span class="n">zone_hvac</span><span class="o">.</span><span class="n">setController</span><span class="p">(</span><span class="n">erv_controller</span><span class="p">)</span>
        <span class="n">zone_hvac</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>

        <span class="c1"># ensure the ERV takes priority, so ventilation load is included when</span>
        <span class="c1"># treated by other zonal systems</span>
        <span class="n">zone</span><span class="o">.</span><span class="n">setCoolingPriority</span><span class="p">(</span><span class="n">zone_hvac</span><span class="o">.</span><span class="n">to_ModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">zone</span><span class="o">.</span><span class="n">setHeatingPriority</span><span class="p">(</span><span class="n">zone_hvac</span><span class="o">.</span><span class="n">to_ModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># set the cooling and heating fraction to zero so that the ERV does</span>
        <span class="c1"># not try to meet the heating or cooling load.</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">version</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">openstudio</span><span class="o">.</span><span class="n">VersionString</span><span class="p">(</span><span class="s1">&#39;2.8.0&#39;</span><span class="p">):</span>
            <span class="n">zone</span><span class="o">.</span><span class="n">setSequentialCoolingFraction</span><span class="p">(</span><span class="n">zone_hvac</span><span class="o">.</span><span class="n">to_ModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="n">zone</span><span class="o">.</span><span class="n">setSequentialHeatingFraction</span><span class="p">(</span><span class="n">zone_hvac</span><span class="o">.</span><span class="n">to_ModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="c1"># Calculate ERV SAT during sizing periods</span>
        <span class="c1"># Standard rating conditions based on AHRI Std 1060 - 2013</span>
        <span class="c1"># heating design</span>
        <span class="n">oat_f</span> <span class="o">=</span> <span class="mf">35.0</span>
        <span class="n">return_air_f</span> <span class="o">=</span> <span class="mf">70.0</span>
        <span class="n">eff</span> <span class="o">=</span> <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">sensibleEffectivenessat100HeatingAirFlow</span><span class="p">()</span>
        <span class="n">coldest_erv_supply_f</span> <span class="o">=</span> <span class="n">oat_f</span> <span class="o">-</span> <span class="p">(</span><span class="n">eff</span> <span class="o">*</span> <span class="p">(</span><span class="n">oat_f</span> <span class="o">-</span> <span class="n">return_air_f</span><span class="p">))</span>
        <span class="n">coldest_erv_supply_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">coldest_erv_supply_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># cooling design</span>
        <span class="n">oat_f</span> <span class="o">=</span> <span class="mf">95.0</span>
        <span class="n">return_air_f</span> <span class="o">=</span> <span class="mf">75.0</span>
        <span class="n">eff</span> <span class="o">=</span> <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">sensibleEffectivenessat100CoolingAirFlow</span><span class="p">()</span>
        <span class="n">hottest_erv_supply_f</span> <span class="o">=</span> <span class="n">oat_f</span> <span class="o">-</span> <span class="p">(</span><span class="n">eff</span> <span class="o">*</span> <span class="p">(</span><span class="n">oat_f</span> <span class="o">-</span> <span class="n">return_air_f</span><span class="p">))</span>
        <span class="n">hottest_erv_supply_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">hottest_erv_supply_f</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Ensure that zone sizing accounts for OA from ERV</span>
        <span class="n">sizing_zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">sizingZone</span><span class="p">()</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setAccountforDedicatedOutdoorAirSystem</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirSystemControlStrategy</span><span class="p">(</span><span class="s1">&#39;NeutralSupplyAir&#39;</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirLowSetpointTemperatureforDesign</span><span class="p">(</span>
            <span class="n">coldest_erv_supply_c</span><span class="p">)</span>
        <span class="n">sizing_zone</span><span class="o">.</span><span class="n">setDedicatedOutdoorAirHighSetpointTemperatureforDesign</span><span class="p">(</span>
            <span class="n">hottest_erv_supply_c</span><span class="p">)</span>

        <span class="n">ervs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zone_hvac</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ervs</span></div>



<div class="viewcode-block" id="model_add_residential_erv">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_residential_erv">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_residential_erv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add residential zone level ERVs for each zone.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            add heat pumps to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># consider implementing the full method in openstudio-standards</span>
    <span class="c1"># this method has many different criteria based on the version of AHSRAE 90.1</span>
    <span class="c1"># is also varies with climate zone</span>
    <span class="k">return</span> <span class="n">model_add_zone_erv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">)</span></div>



<div class="viewcode-block" id="model_add_residential_ventilator">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_residential_ventilator">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_residential_ventilator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a residential ventilation.</span>

<span class="sd">    Ventilators are standalone unit ventilation and zone exhaust that operates</span>
<span class="sd">    to provide OA, used in conjuction with a system that having mechanical</span>
<span class="sd">    cooling and a heating coil.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            enable ideal air loads.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unit_ventilators</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">thermal_zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">thermal_zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
        <span class="n">min_oa_flow_m3</span> <span class="o">=</span> <span class="n">thermal_zone_get_outdoor_airflow_rate</span><span class="p">(</span><span class="n">thermal_zone</span><span class="p">)</span>
        <span class="c1"># Fan power with no energy recovery = 0.806 W/cfm</span>
        <span class="n">supply_fan</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;ERV_Supply_Fan&#39;</span><span class="p">,</span>
            <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Ventilator Supply Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.48</span><span class="p">)</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setFanTotalEfficiency</span><span class="p">(</span><span class="mf">0.303158</span><span class="p">)</span>
        <span class="n">supply_fan</span><span class="o">.</span><span class="n">setPressureRise</span><span class="p">(</span><span class="mf">233.6875</span><span class="p">)</span>

        <span class="n">unit_ventilator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">ZoneHVACUnitVentilator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">supply_fan</span><span class="p">)</span>
        <span class="n">unit_ventilator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Unit Ventilator&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">unit_ventilator</span><span class="o">.</span><span class="n">addToThermalZone</span><span class="p">(</span><span class="n">thermal_zone</span><span class="p">)</span>

        <span class="n">fan_zone_exhaust</span> <span class="o">=</span> <span class="n">create_fan_by_name</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;ERV_Exhaust_fan&#39;</span><span class="p">,</span> <span class="n">fan_name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Exhaust Fan&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">))</span>
        <span class="n">fan_zone_exhaust</span><span class="o">.</span><span class="n">setMotorEfficiency</span><span class="p">(</span><span class="mf">0.48</span><span class="p">)</span>
        <span class="n">fan_zone_exhaust</span><span class="o">.</span><span class="n">setFanEfficiency</span><span class="p">(</span><span class="mf">0.303158</span><span class="p">)</span>
        <span class="n">fan_zone_exhaust</span><span class="o">.</span><span class="n">setPressureRise</span><span class="p">(</span><span class="mf">233.6875</span><span class="p">)</span>

        <span class="c1"># Set OA requirements; Assumes a default of 55 cfm</span>
        <span class="n">unit_ventilator</span><span class="o">.</span><span class="n">setMaximumSupplyAirFlowRate</span><span class="p">(</span><span class="n">min_oa_flow_m3</span><span class="p">)</span>
        <span class="n">fan_zone_exhaust</span><span class="o">.</span><span class="n">setMaximumFlowRate</span><span class="p">(</span><span class="n">min_oa_flow_m3</span><span class="p">)</span>

        <span class="c1"># Ensure the unit ventilator takes priority, so ventilation load is</span>
        <span class="c1"># included when treated by other zonal systems</span>
        <span class="n">thermal_zone</span><span class="o">.</span><span class="n">setCoolingPriority</span><span class="p">(</span><span class="n">unit_ventilator</span><span class="o">.</span><span class="n">to_ModelObject</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">thermal_zone</span><span class="o">.</span><span class="n">setHeatingPriority</span><span class="p">(</span><span class="n">unit_ventilator</span><span class="o">.</span><span class="n">to_ModelObject</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">unit_ventilators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unit_ventilator</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unit_ventilators</span></div>



<div class="viewcode-block" id="model_add_waterside_economizer">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_waterside_economizer">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_waterside_economizer</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">condenser_water_loop</span><span class="p">,</span> <span class="n">integrated</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a waterside economizer to the chilled water and condenser loop.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        integrated [Boolean] when set to true, models an integrated waterside economizer.</span>
<span class="sd">            Integrated - in series with chillers, can run simultaneously with chillers</span>
<span class="sd">            Non-Integrated - in parallel with chillers, chillers locked out during operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make a new heat exchanger</span>
    <span class="n">heat_exchanger</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">HeatExchangerFluidToFluid</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setHeatExchangeModelType</span><span class="p">(</span><span class="s1">&#39;CounterFlow&#39;</span><span class="p">)</span>
    <span class="c1"># zero degree minimum necessary to allow both economizer and heat exchanger</span>
    <span class="c1"># to operate in both integrated and non-integrated archetypes</span>
    <span class="c1"># possibly results from an EnergyPlus issue that didn&#39;t get resolved correctly</span>
    <span class="c1"># https://github.com/NREL/EnergyPlus/issues/5626</span>
    <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setMinimumTemperatureDifferencetoActivateHeatExchanger</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setHeatTransferMeteringEndUseType</span><span class="p">(</span><span class="s1">&#39;FreeCooling&#39;</span><span class="p">)</span>
    <span class="n">o_min_tl</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">35.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setOperationMinimumTemperatureLimit</span><span class="p">(</span><span class="n">o_min_tl</span><span class="p">)</span>
    <span class="n">o_max_tl</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">72.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setOperationMaximumTemperatureLimit</span><span class="p">(</span><span class="n">o_max_tl</span><span class="p">)</span>
    <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setAvailabilitySchedule</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">alwaysOnDiscreteSchedule</span><span class="p">())</span>

    <span class="c1"># get the chillers on the chilled water loop</span>
    <span class="n">chillers</span> <span class="o">=</span> <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyComponents</span><span class="p">(</span>
        <span class="s1">&#39;OS:Chiller:Electric:EIR&#39;</span><span class="o">.</span><span class="n">to_IddObjectType</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">integrated</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os_vector_len</span><span class="p">(</span><span class="n">chillers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No chillers were found on </span><span class="si">{}</span><span class="s1">; only modeling waterside economizer&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># set methods for integrated heat exchanger</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Integrated Waterside Economizer Heat Exchanger&#39;</span><span class="p">)</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setControlType</span><span class="p">(</span><span class="s1">&#39;CoolingDifferentialOnOff&#39;</span><span class="p">)</span>

        <span class="c1"># add the heat exchanger to the chilled water loop upstream of the chiller</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>

        <span class="c1"># Copy the setpoint managers from the plant&#39;s supply outlet node</span>
        <span class="c1"># to the chillers and HX outlets.</span>
        <span class="c1"># This is necessary so that the correct type of operation scheme will be created.</span>
        <span class="c1"># Without this, OS will create an uncontrolled operation scheme</span>
        <span class="c1"># and the chillers will never run.</span>
        <span class="n">chw_spms</span> <span class="o">=</span> <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="o">.</span><span class="n">setpointManagers</span><span class="p">()</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">chillers</span><span class="p">:</span>
            <span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">to_ChillerElectricEIR</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="n">objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">heat_exchanger</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">outlet</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">supplyOutletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">spm</span> <span class="ow">in</span> <span class="n">chw_spms</span><span class="p">:</span>
                <span class="n">new_spm</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to_SetpointManager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="n">new_spm</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">outlet</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># non-integrated</span>
        <span class="c1"># if the heat exchanger can meet the entire load, the heat exchanger will run</span>
        <span class="c1"># and the chiller is disabled.</span>
        <span class="c1"># In E+, only one chiller can be tied to a given heat exchanger, so if you have</span>
        <span class="c1"># multiple chillers, they will cannot be tied to a single heat exchanger without EMS.</span>
        <span class="n">chiller</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">os_vector_len</span><span class="p">(</span><span class="n">chillers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No chillers were found on </span><span class="si">{}</span><span class="s1">; cannot add a non-integrated &#39;</span> \
                <span class="s1">&#39;waterside economizer.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setControlType</span><span class="p">(</span><span class="s1">&#39;CoolingSetpointOnOff&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os_vector_len</span><span class="p">(</span><span class="n">chillers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">chiller</span> <span class="o">=</span> <span class="n">chillers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;More than one chiller was found on </span><span class="si">{}</span><span class="s1">. EnergyPlus only allows a &#39;</span> \
                <span class="s1">&#39;single chiller to be interlocked with the HX.  Chiller </span><span class="si">{}</span><span class="s1"> was selected.&#39;</span> \
                <span class="s1">&#39; Additional chillers will not be locked out during HX operation.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="n">chiller</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># 1 chiller</span>
            <span class="n">chiller</span> <span class="o">=</span> <span class="n">chillers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">chiller</span> <span class="o">=</span> <span class="n">chiller</span><span class="o">.</span><span class="n">to_ChillerElectricEIR</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c1"># set methods for non-integrated heat exchanger</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Non-Integrated Waterside Economizer Heat Exchanger&#39;</span><span class="p">)</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setControlType</span><span class="p">(</span><span class="s1">&#39;CoolingSetpointOnOffWithComponentOverride&#39;</span><span class="p">)</span>

        <span class="c1"># add the heat exchanger to a supply side branch of the chilled water loop</span>
        <span class="c1"># parallel with the chiller(s)</span>
        <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">addSupplyBranchForComponent</span><span class="p">(</span><span class="n">heat_exchanger</span><span class="p">)</span>

        <span class="c1"># Copy the setpoint managers from the plant&#39;s supply outlet node to the HX outlet.</span>
        <span class="c1"># This is necessary so that the correct type of operation scheme will be created.</span>
        <span class="c1"># Without this, the HX will never run</span>
        <span class="n">chw_spms</span> <span class="o">=</span> <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">()</span><span class="o">.</span><span class="n">setpointManagers</span><span class="p">()</span>
        <span class="n">outlet</span> <span class="o">=</span> <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">supplyOutletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">spm</span> <span class="ow">in</span> <span class="n">chw_spms</span><span class="p">:</span>
            <span class="n">new_spm</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span><span class="o">.</span><span class="n">to_SetpointManager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">new_spm</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">outlet</span><span class="p">)</span>

        <span class="c1"># set the supply and demand inlet fields to interlock the heat exchanger with the chiller</span>
        <span class="n">chiller_supply_inlet</span> <span class="o">=</span> <span class="n">chiller</span><span class="o">.</span><span class="n">supplyInletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setComponentOverrideLoopSupplySideInletNode</span><span class="p">(</span><span class="n">chiller_supply_inlet</span><span class="p">)</span>
        <span class="n">chiller_demand_inlet</span> <span class="o">=</span> <span class="n">chiller</span><span class="o">.</span><span class="n">demandInletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">setComponentOverrideLoopDemandSideInletNode</span><span class="p">(</span><span class="n">chiller_demand_inlet</span><span class="p">)</span>

        <span class="c1"># check if the chilled water pump is on a branch with the chiller.</span>
        <span class="c1"># if it is, move this pump before the splitter so that it can push water</span>
        <span class="c1"># through either the chiller or the heat exchanger.</span>
        <span class="n">pumps_on_branches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># search for constant and variable speed pumps between supply splitter and supply mixer.</span>
        <span class="n">supply_comps</span> <span class="o">=</span> <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyComponents</span><span class="p">(</span>
            <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplySplitter</span><span class="p">(),</span> <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyMixer</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">supply_comp</span> <span class="ow">in</span> <span class="n">supply_comps</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">supply_comp</span><span class="o">.</span><span class="n">to_PumpConstantSpeed</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
                <span class="n">pumps_on_branches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">supply_comp</span><span class="o">.</span><span class="n">to_PumpConstantSpeed</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">supply_comp</span><span class="o">.</span><span class="n">to_PumpVariableSpeed</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
                <span class="n">pumps_on_branches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">supply_comp</span><span class="o">.</span><span class="n">to_PumpVariableSpeed</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="c1"># If only one pump is found, clone it, put the clone on the supply inlet node,</span>
        <span class="c1"># and delete the original pump.</span>
        <span class="c1"># If multiple branch pumps, clone the first pump found, add it to the inlet</span>
        <span class="c1"># of the heat exchanger, and warn user.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pumps_on_branches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pump</span> <span class="o">=</span> <span class="n">pumps_on_branches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pump_clone</span> <span class="o">=</span> <span class="n">pump</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">to_StraightComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">pump_clone</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">supplyInletNode</span><span class="p">())</span>
            <span class="n">pump</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">pumps_on_branches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">hx_inlet_node</span> <span class="o">=</span> <span class="n">heat_exchanger</span><span class="o">.</span><span class="n">inletModelObject</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">to_Node</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">pump</span> <span class="o">=</span> <span class="n">pumps_on_branches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pump_clone</span> <span class="o">=</span> <span class="n">pump</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">to_StraightComponent</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">pump_clone</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span><span class="n">hx_inlet_node</span><span class="p">)</span>

    <span class="c1"># add heat exchanger to condenser water loop</span>
    <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">addDemandBranchForComponent</span><span class="p">(</span><span class="n">heat_exchanger</span><span class="p">)</span>

    <span class="c1"># change setpoint manager on condenser water loop to allow waterside economizing</span>
    <span class="n">dsgn_sup_wtr_temp_f</span> <span class="o">=</span> <span class="mf">42.0</span>
    <span class="n">dsgn_sup_wtr_temp_c</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mf">42.0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">spm</span> <span class="ow">in</span> <span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">supplyOutletNode</span><span class="p">()</span><span class="o">.</span><span class="n">setpointManagers</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerFollowOutdoorAirTemperature</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">spm</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerFollowOutdoorAirTemperature</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">spm</span><span class="o">.</span><span class="n">setMinimumSetpointTemperature</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_c</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerScheduled</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">spm</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">to_SetpointManagerScheduled</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()()</span>
            <span class="n">cw_temp_sch</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp_c</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Temp - </span><span class="si">{}</span><span class="s1">F&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">chilled_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="nb">int</span><span class="p">(</span><span class="n">dsgn_sup_wtr_temp_f</span><span class="p">)),</span>
                <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
            <span class="n">spm</span><span class="o">.</span><span class="n">setSchedule</span><span class="p">(</span><span class="n">cw_temp_sch</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Condenser water loop </span><span class="si">{}</span><span class="s1"> setpoint manager </span><span class="si">{}</span><span class="s1"> is not a recognized &#39;</span> \
                <span class="s1">&#39;setpoint manager type. Cannot change to account for the waterside &#39;</span> \
                <span class="s1">&#39;economizer.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condenser_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="n">spm</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">heat_exchanger</span></div>



<div class="viewcode-block" id="model_add_zone_heat_cool_request_count_program">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_zone_heat_cool_request_count_program">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_zone_heat_cool_request_count_program</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make EMS program that will compare &#39;measured&#39; zone air temperatures to setpoints.</span>

<span class="sd">    This can be used to determine if zone needs cooling or heating. Program will</span>
<span class="sd">    output the total zones needing heating and cooling and the their ratio using</span>
<span class="sd">    the total number of zones.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones to</span>
<span class="sd">            dictate cooling or heating mode of water plant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create container schedules to hold number of zones needing heating and cooling</span>
    <span class="n">sch_zones_needing_heating</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zones Needing Heating Count Schedule&#39;</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Dimensionless&#39;</span><span class="p">)</span>
    <span class="n">zone_needing_heating_actuator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
        <span class="n">sch_zones_needing_heating</span><span class="p">,</span> <span class="s1">&#39;Schedule:Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
    <span class="n">zone_needing_heating_actuator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Zones_Needing_Heating&#39;</span><span class="p">)</span>

    <span class="n">sch_zones_needing_cooling</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zones Needing Cooling Count Schedule&#39;</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Dimensionless&#39;</span><span class="p">)</span>

    <span class="n">zone_needing_cooling_actuator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
        <span class="n">sch_zones_needing_cooling</span><span class="p">,</span> <span class="s1">&#39;Schedule:Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
    <span class="n">zone_needing_cooling_actuator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Zones_Needing_Cooling&#39;</span><span class="p">)</span>

    <span class="c1"># create container schedules to hold ratio of zones needing heating and cooling</span>
    <span class="n">sch_zones_needing_heating_ratio</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zones Needing Heating Ratio Schedule&#39;</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Dimensionless&#39;</span><span class="p">)</span>

    <span class="n">zone_needing_heating_ratio_actuator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
        <span class="n">sch_zones_needing_heating_ratio</span><span class="p">,</span> <span class="s1">&#39;Schedule:Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
    <span class="n">zone_needing_heating_ratio_actuator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Zone_Heating_Ratio&#39;</span><span class="p">)</span>

    <span class="n">sch_zones_needing_cooling_ratio</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zones Needing Cooling Ratio Schedule&#39;</span><span class="p">,</span>
        <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Dimensionless&#39;</span><span class="p">)</span>

    <span class="n">zone_needing_cooling_ratio_actuator</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
        <span class="n">sch_zones_needing_cooling_ratio</span><span class="p">,</span> <span class="s1">&#39;Schedule:Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
    <span class="n">zone_needing_cooling_ratio_actuator</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Zone_Cooling_Ratio&#39;</span><span class="p">)</span>

    <span class="c1">#####</span>
    <span class="c1"># Create EMS program to check comfort exceedances</span>
    <span class="c1">####</span>

    <span class="c1"># initalize inner body for heating and cooling requests programs</span>
    <span class="n">determine_zone_cooling_needs_prg_inner_body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">determine_zone_heating_needs_prg_inner_body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">thermal_zones</span><span class="p">:</span>
        <span class="c1"># get existing &#39;sensors&#39;</span>
        <span class="n">exisiting_ems_sensors</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getEnergyManagementSystemSensors</span><span class="p">()</span>
        <span class="n">exisiting_ems_sensors_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sen</span> <span class="ow">in</span> <span class="n">exisiting_ems_sensors</span><span class="p">:</span>
            <span class="n">sen_desc</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sen</span><span class="o">.</span><span class="n">nameString</span><span class="p">(),</span> <span class="n">sen</span><span class="o">.</span><span class="n">outputVariableOrMeterName</span><span class="p">())</span>
            <span class="n">exisiting_ems_sensors_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sen_desc</span><span class="p">)</span>

        <span class="c1"># Create zone air temperature &#39;sensor&#39; for the zone.</span>
        <span class="n">zone_name</span> <span class="o">=</span> <span class="n">ems_friendly_name</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>
        <span class="n">zone_air_sensor_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_ctrl_temperature&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-Zone Air Temperature&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_air_sensor_name</span><span class="p">)</span> \
                <span class="ow">not</span> <span class="ow">in</span> <span class="n">exisiting_ems_sensors_names</span><span class="p">:</span>
            <span class="n">zone_ctrl_temperature</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemSensor</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Zone Air Temperature&#39;</span><span class="p">)</span>
            <span class="n">zone_ctrl_temperature</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">zone_air_sensor_name</span><span class="p">)</span>
            <span class="n">zone_ctrl_temperature</span><span class="o">.</span><span class="n">setKeyName</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>

        <span class="c1"># check for zone thermostats</span>
        <span class="n">zone_thermostat</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">thermostatSetpointDualSetpoint</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">zone_thermostat</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Zone </span><span class="si">{}</span><span class="s1"> does not have thermostats.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">nameString</span><span class="p">()))</span>

        <span class="n">zone_thermostat</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">thermostatSetpointDualSetpoint</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">zone_clg_thermostat</span> <span class="o">=</span> <span class="n">zone_thermostat</span><span class="o">.</span><span class="n">coolingSetpointTemperatureSchedule</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">zone_htg_thermostat</span> <span class="o">=</span> <span class="n">zone_thermostat</span><span class="o">.</span><span class="n">heatingSetpointTemperatureSchedule</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c1"># create new sensor for zone thermostat if it does not exist already</span>
        <span class="n">zone_clg_thermostat_sensor_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_upper_comfort_limit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>
        <span class="n">zone_htg_thermostat_sensor_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_lower_comfort_limit&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-Schedule Value&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_clg_thermostat_sensor_name</span><span class="p">)</span> \
                <span class="ow">not</span> <span class="ow">in</span> <span class="n">exisiting_ems_sensors_names</span><span class="p">:</span>
            <span class="c1"># Upper comfort limit for the zone. Taken from existing thermostat</span>
            <span class="n">zone_upper_comfort_limit</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemSensor</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
            <span class="n">zone_upper_comfort_limit</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">zone_clg_thermostat_sensor_name</span><span class="p">)</span>
            <span class="n">zone_upper_comfort_limit</span><span class="o">.</span><span class="n">setKeyName</span><span class="p">(</span><span class="n">zone_clg_thermostat</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>

        <span class="k">if</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-Schedule Value&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">zone_htg_thermostat_sensor_name</span><span class="p">)</span> \
                <span class="ow">not</span> <span class="ow">in</span> <span class="n">exisiting_ems_sensors_names</span><span class="p">:</span>
            <span class="c1"># Lower comfort limit for the zone. Taken from existing thermostat schedules in the zone.</span>
            <span class="n">zone_lower_comfort_limit</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemSensor</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
            <span class="n">zone_lower_comfort_limit</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">zone_htg_thermostat_sensor_name</span><span class="p">)</span>
            <span class="n">zone_lower_comfort_limit</span><span class="o">.</span><span class="n">setKeyName</span><span class="p">(</span><span class="n">zone_htg_thermostat</span><span class="o">.</span><span class="n">nameString</span><span class="p">())</span>

        <span class="c1"># create program inner body for determining zone cooling needs</span>
        <span class="n">z_cool_need</span> <span class="o">=</span> \
            <span class="s1">&#39;IF </span><span class="si">{zone_air_sensor_name}</span><span class="s1"> &gt; </span><span class="si">{zone_clg_thermostat_sensor_name}</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET Zones_Needing_Cooling = Zones_Needing_Cooling + 1,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ENDIF,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">zone_air_sensor_name</span><span class="o">=</span><span class="n">zone_air_sensor_name</span><span class="p">,</span>
                <span class="n">zone_clg_thermostat_sensor_name</span><span class="o">=</span><span class="n">zone_clg_thermostat_sensor_name</span>
            <span class="p">)</span>
        <span class="n">determine_zone_cooling_needs_prg_inner_body</span> <span class="o">+=</span> <span class="n">z_cool_need</span>

        <span class="c1"># create program inner body for determining zone cooling needs</span>
        <span class="n">z_heat_need</span> <span class="o">=</span> \
            <span class="s1">&#39;IF </span><span class="si">{zone_air_sensor_name}</span><span class="s1"> &lt; </span><span class="si">{zone_htg_thermostat_sensor_name}</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET Zones_Needing_Heating = Zones_Needing_Heating + 1,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ENDIF,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">zone_air_sensor_name</span><span class="o">=</span><span class="n">zone_air_sensor_name</span><span class="p">,</span>
                <span class="n">zone_htg_thermostat_sensor_name</span><span class="o">=</span><span class="n">zone_htg_thermostat_sensor_name</span>
            <span class="p">)</span>
        <span class="n">determine_zone_heating_needs_prg_inner_body</span> <span class="o">+=</span> <span class="n">z_heat_need</span>

    <span class="c1"># create program for determining zone cooling needs</span>
    <span class="n">determine_zone_cooling_needs_prg</span> <span class="o">=</span> \
        <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgram</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">determine_zone_cooling_needs_prg</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Determine_Zone_Cooling_Needs&#39;</span><span class="p">)</span>
    <span class="n">determine_zone_cooling_needs_prg_body</span> <span class="o">=</span> \
        <span class="s1">&#39;SET Zones_Needing_Cooling = 0,</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;</span><span class="si">{zone_cooling_prg_inner_body}</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;SET Total_Zones = </span><span class="si">{thermal_zones_length}</span><span class="se">\n</span><span class="s1">,&#39;</span> \
        <span class="s1">&#39;SET Zone_Cooling_Ratio = Zones_Needing_Cooling/Total_Zones&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">zone_cooling_prg_inner_body</span><span class="o">=</span><span class="n">determine_zone_cooling_needs_prg_inner_body</span><span class="p">,</span>
            <span class="n">thermal_zones_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">determine_zone_cooling_needs_prg</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">determine_zone_cooling_needs_prg_body</span><span class="p">)</span>

    <span class="c1"># create program for determining zone heating needs</span>
    <span class="n">determine_zone_heating_needs_prg</span> <span class="o">=</span> \
        <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgram</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">determine_zone_heating_needs_prg</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Determine_Zone_Heating_Needs&#39;</span><span class="p">)</span>
    <span class="n">determine_zone_heating_needs_prg_body</span> <span class="o">=</span> \
        <span class="s1">&#39;SET Zones_Needing_Heating = 0,</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;</span><span class="si">{zone_heating_prg_inner_body}</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;SET Total_Zones = </span><span class="si">{thermal_zones_length}</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;SET Zone_Heating_Ratio = Zones_Needing_Heating/Total_Zones&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">zone_heating_prg_inner_body</span><span class="o">=</span><span class="n">determine_zone_heating_needs_prg_inner_body</span><span class="p">,</span>
            <span class="n">thermal_zones_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">thermal_zones</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">determine_zone_heating_needs_prg</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">determine_zone_heating_needs_prg_body</span><span class="p">)</span>

    <span class="c1"># create EMS program manager objects</span>
    <span class="n">programs_at_beginning_of_timestep</span> <span class="o">=</span> \
        <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgramCallingManager</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
        <span class="s1">&#39;Heating_Cooling_Request_Programs_At_End_Of_Timestep&#39;</span><span class="p">)</span>
    <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">setCallingPoint</span><span class="p">(</span>
        <span class="s1">&#39;EndOfZoneTimestepAfterZoneReporting&#39;</span><span class="p">)</span>
    <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">determine_zone_cooling_needs_prg</span><span class="p">)</span>
    <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">determine_zone_heating_needs_prg</span><span class="p">)</span></div>



<div class="viewcode-block" id="model_add_plant_supply_water_temperature_control">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_plant_supply_water_temperature_control">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_plant_supply_water_temperature_control</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">plant_water_loop</span><span class="p">,</span> <span class="n">control_strategy</span><span class="o">=</span><span class="s1">&#39;outdoor_air&#39;</span><span class="p">,</span>
        <span class="n">sp_at_oat_low</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oat_low</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_at_oat_high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oat_high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">thermal_zones</span><span class="o">=</span><span class="p">()):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds supply water temperature control on specified plant water loops.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        plant_water_loop: [OpenStudio::Model::PlantLoop] plant water loop to add</span>
<span class="sd">            supply water temperature control.</span>
<span class="sd">        control_strategy: [String] Method to determine how to control the plant&#39;s</span>
<span class="sd">            supply water temperature (swt). Options include the following.</span>
<span class="sd">            outdoor_air -- The plant&#39;s swt will be proportional to the outdoor</span>
<span class="sd">                air based on the next 4 parameters.</span>
<span class="sd">            zone_demand -- The plant&#39;s swt will be determined by preponderance</span>
<span class="sd">                of zone demand.</span>
<span class="sd">        sp_at_oat_low: [Double] supply water temperature setpoint, in F, at the</span>
<span class="sd">            outdoor low temperature.</span>
<span class="sd">        oat_low: [Double] outdoor drybulb air  temperature, in F, for low setpoint.</span>
<span class="sd">        sp_at_oat_high: [Double] supply water temperature setpoint, in F, at</span>
<span class="sd">            the outdoor high temperature.</span>
<span class="sd">        oat_high: [Double] outdoor drybulb air temperature, in F, for high setpoint.</span>
<span class="sd">        thermal_zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of zones.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loop_name</span> <span class="o">=</span> <span class="n">plant_water_loop</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span>
    <span class="c1"># check that all required temperature parameters are defined</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sp_at_oat_low</span><span class="p">,</span> <span class="n">oat_low</span><span class="p">,</span> <span class="n">sp_at_oat_high</span><span class="p">,</span> <span class="n">oat_high</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;At least one of the required temperature parameter is nil.&#39;</span><span class="p">)</span>

    <span class="c1"># remove any existing setpoint manager on the plant water loop</span>
    <span class="n">exisiting_setpoint_managers</span> <span class="o">=</span> <span class="n">plant_water_loop</span><span class="o">.</span><span class="n">loopTemperatureSetpointNode</span><span class="p">()</span><span class="o">.</span><span class="n">setpointManagers</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">spm</span> <span class="ow">in</span> <span class="n">exisiting_setpoint_managers</span><span class="p">:</span>
        <span class="n">spm</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">control_strategy</span> <span class="o">==</span> <span class="s1">&#39;outdoor_air&#39;</span><span class="p">:</span>
        <span class="c1"># create supply water temperature setpoint managers for plant based on outdoor temperature</span>
        <span class="n">water_loop_setpoint_manager</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerOutdoorAirReset</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Water Temperature Control&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setControlVariable</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setSetpointatOutdoorLowTemperature</span><span class="p">(</span>
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sp_at_oat_low</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setOutdoorLowTemperature</span><span class="p">(</span>
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">oat_low</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setSetpointatOutdoorHighTemperature</span><span class="p">(</span>
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sp_at_oat_high</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setOutdoorHighTemperature</span><span class="p">(</span>
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">oat_high</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span>
            <span class="n">plant_water_loop</span><span class="o">.</span><span class="n">loopTemperatureSetpointNode</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># create supply water temperature setpoint managers for plant based on</span>
        <span class="c1"># zone heating and cooling demand</span>
        <span class="c1"># check if zone heat and cool requests program exists, if not create it</span>
        <span class="n">determine_zone_cooling_needs_prg</span> <span class="o">=</span> \
            <span class="n">model</span><span class="o">.</span><span class="n">getEnergyManagementSystemProgramByName</span><span class="p">(</span><span class="s1">&#39;Determine_Zone_Cooling_Needs&#39;</span><span class="p">)</span>
        <span class="n">determine_zone_heating_needs_prg</span> <span class="o">=</span> \
            <span class="n">model</span><span class="o">.</span><span class="n">getEnergyManagementSystemProgramByName</span><span class="p">(</span><span class="s1">&#39;Determine_Zone_Heating_Needs&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">determine_zone_cooling_needs_prg</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> \
                <span class="n">determine_zone_heating_needs_prg</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">model_add_zone_heat_cool_request_count_program</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">thermal_zones</span><span class="p">)</span>

        <span class="n">plant_water_loop_name</span> <span class="o">=</span> <span class="n">ems_friendly_name</span><span class="p">(</span><span class="n">loop_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plant_water_loop</span><span class="o">.</span><span class="n">componentType</span><span class="p">()</span><span class="o">.</span><span class="n">valueName</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Heating&#39;</span><span class="p">:</span>
            <span class="n">sp_at_oat_low</span> <span class="o">=</span> <span class="mi">120</span> <span class="k">if</span> <span class="n">sp_at_oat_low</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sp_at_oat_low</span>
            <span class="n">swt_upper_limit</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sp_at_oat_low</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sp_at_oat_high</span> <span class="o">=</span> <span class="mi">80</span> <span class="k">if</span> <span class="n">sp_at_oat_high</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sp_at_oat_high</span>
            <span class="n">swt_lower_limit</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sp_at_oat_high</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">swt_init</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">zone_demand_var</span> <span class="o">=</span> <span class="s1">&#39;Zone_Heating_Ratio&#39;</span>
            <span class="n">swt_inc_condition_var</span> <span class="o">=</span> <span class="s1">&#39;&gt; 0.70&#39;</span>
            <span class="n">swt_dec_condition_var</span> <span class="o">=</span> <span class="s1">&#39;&lt; 0.30&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sp_at_oat_low</span> <span class="o">=</span> <span class="mi">70</span> <span class="k">if</span> <span class="n">sp_at_oat_low</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sp_at_oat_low</span>
            <span class="n">swt_upper_limit</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sp_at_oat_low</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sp_at_oat_high</span> <span class="o">=</span> <span class="mi">55</span> <span class="k">if</span> <span class="n">sp_at_oat_high</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sp_at_oat_high</span>
            <span class="n">swt_lower_limit</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">sp_at_oat_high</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">swt_init</span> <span class="o">=</span> <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="mi">62</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">zone_demand_var</span> <span class="o">=</span> <span class="s1">&#39;Zone_Cooling_Ratio&#39;</span>
            <span class="n">swt_inc_condition_var</span> <span class="o">=</span> <span class="s1">&#39;&lt; 0.30&#39;</span>
            <span class="n">swt_dec_condition_var</span> <span class="o">=</span> <span class="s1">&#39;&gt; 0.70&#39;</span>

        <span class="c1"># plant loop supply water control actuator</span>
        <span class="n">sch_plant_swt_ctrl</span> <span class="o">=</span> <span class="n">create_constant_schedule_ruleset</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">swt_init</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Sch_Supply_Water_Temperature&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plant_water_loop_name</span><span class="p">),</span>
            <span class="n">schedule_type_limit</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>

        <span class="n">cmd_plant_water_ctrl</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemActuator</span><span class="p">(</span>
            <span class="n">sch_plant_swt_ctrl</span><span class="p">,</span> <span class="s1">&#39;Schedule:Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Schedule Value&#39;</span><span class="p">)</span>
        <span class="n">cmd_plant_water_ctrl</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_supply_water_ctrl&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plant_water_loop_name</span><span class="p">))</span>

        <span class="c1"># create plant loop setpoint manager</span>
        <span class="n">water_loop_setpoint_manager</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">SetpointManagerScheduled</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sch_plant_swt_ctrl</span><span class="p">)</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Supply Water Temperature Control&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loop_name</span><span class="p">))</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">setControlVariable</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
        <span class="n">water_loop_setpoint_manager</span><span class="o">.</span><span class="n">addToNode</span><span class="p">(</span>
            <span class="n">plant_water_loop</span><span class="o">.</span><span class="n">loopTemperatureSetpointNode</span><span class="p">())</span>

        <span class="c1"># add uninitialized variables into constant program</span>
        <span class="n">set_constant_values_prg_body</span> <span class="o">=</span> \
            <span class="s1">&#39;SET </span><span class="si">{}</span><span class="s1">_supply_water_ctrl = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plant_water_loop_name</span><span class="p">,</span> <span class="n">swt_init</span><span class="p">)</span>

        <span class="n">set_constant_values_prg</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getEnergyManagementSystemProgramByName</span><span class="p">(</span>
            <span class="s1">&#39;Set_Plant_Constant_Values&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">set_constant_values_prg</span> <span class="o">=</span> <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">set_constant_values_prg_body</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">set_constant_values_prg</span> <span class="o">=</span> \
                <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgram</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Set_Plant_Constant_Values&#39;</span><span class="p">)</span>
            <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">set_constant_values_prg_body</span><span class="p">)</span>

        <span class="c1"># program for supply water temperature control in the plot</span>
        <span class="n">determine_plant_swt_prg</span> <span class="o">=</span> <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgram</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">swt_prg_name</span> <span class="o">=</span> <span class="s1">&#39;Determine_</span><span class="si">{}</span><span class="s1">_Supply_Water_Temperature&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plant_water_loop_name</span><span class="p">)</span>
        <span class="n">determine_plant_swt_prg</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">swt_prg_name</span><span class="p">)</span>
        <span class="n">determine_plant_swt_prg_body</span> <span class="o">=</span> \
            <span class="s1">&#39;SET SWT_Increase = 1,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET SWT_Decrease = 1,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET SWT_upper_limit = </span><span class="si">{swt_upper_limit}</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET SWT_lower_limit = </span><span class="si">{swt_lower_limit}</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;IF </span><span class="si">{zone_demand_var}</span><span class="s1"> </span><span class="si">{swt_inc_cond_var}</span><span class="s1"> &amp;&amp; (@Mod CurrentTime 1) == 0,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl = </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl + SWT_Increase,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ELSEIF </span><span class="si">{zone_demand_var}</span><span class="s1"> </span><span class="si">{swt_dec_cond_var}</span><span class="s1"> &amp;&amp; (@Mod CurrentTime 1) == 0,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl = </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl - SWT_Decrease,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ELSE,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl = </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ENDIF,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;IF </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl &gt; SWT_upper_limit,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl = SWT_upper_limit</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ENDIF,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;IF </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl &lt; SWT_lower_limit,</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;SET </span><span class="si">{loop_name}</span><span class="s1">_supply_water_ctrl = SWT_lower_limit</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="s1">&#39;ENDIF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">swt_upper_limit</span><span class="o">=</span><span class="n">swt_upper_limit</span><span class="p">,</span> <span class="n">swt_lower_limit</span><span class="o">=</span><span class="n">swt_lower_limit</span><span class="p">,</span>
                <span class="n">zone_demand_var</span><span class="o">=</span><span class="n">zone_demand_var</span><span class="p">,</span> <span class="n">loop_name</span><span class="o">=</span><span class="n">plant_water_loop_name</span><span class="p">,</span>
                <span class="n">swt_inc_cond_var</span><span class="o">=</span><span class="n">swt_inc_condition_var</span><span class="p">,</span> <span class="n">swt_dec_cond_var</span><span class="o">=</span><span class="n">swt_dec_condition_var</span>
            <span class="p">)</span>
        <span class="n">determine_plant_swt_prg</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">determine_plant_swt_prg_body</span><span class="p">)</span>

        <span class="c1"># create EMS program manager objects</span>
        <span class="n">programs_at_beginning_of_timestep</span> <span class="o">=</span> \
            <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgramCallingManager</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">prg_man_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Demand_Based_Supply_Water_Temperature_At_Beginning_&#39;</span>\
            <span class="s1">&#39;Of_Timestep&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plant_water_loop_name</span><span class="p">)</span>
        <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">prg_man_name</span><span class="p">)</span>
        <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">setCallingPoint</span><span class="p">(</span><span class="s1">&#39;BeginTimestepBeforePredictor&#39;</span><span class="p">)</span>
        <span class="n">programs_at_beginning_of_timestep</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">determine_plant_swt_prg</span><span class="p">)</span>

        <span class="n">initialize_constant_parameters</span> <span class="o">=</span> \
            <span class="n">model</span><span class="o">.</span><span class="n">getEnergyManagementSystemProgramCallingManagerByName</span><span class="p">(</span>
                <span class="s1">&#39;Initialize_Constant_Parameters&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">initialize_constant_parameters</span> <span class="o">=</span> <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="c1"># add program if it does not exist in manager</span>
            <span class="n">existing_program_names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">prg</span> <span class="ow">in</span> <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">programs</span><span class="p">():</span>
                <span class="n">existing_program_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prg</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_program_names</span><span class="p">:</span>
                <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">set_constant_values_prg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initialize_constant_parameters</span> <span class="o">=</span> \
                <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgramCallingManager</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s1">&#39;Initialize_Constant_Parameters&#39;</span><span class="p">)</span>
            <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">setCallingPoint</span><span class="p">(</span><span class="s1">&#39;BeginNewEnvironment&#39;</span><span class="p">)</span>
            <span class="n">initialize_constant_parameters</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">set_constant_values_prg</span><span class="p">)</span>

        <span class="n">initialize_constant_parameters_after_warmup</span> <span class="o">=</span> \
            <span class="n">model</span><span class="o">.</span><span class="n">getEnergyManagementSystemProgramCallingManagerByName</span><span class="p">(</span>
                <span class="s1">&#39;Initialize_Constant_Parameters_After_Warmup&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
            <span class="n">initialize_constant_parameters_after_warmup</span> <span class="o">=</span> \
                <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="c1"># add program if it does not exist in manager</span>
            <span class="n">existing_program_names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">prg</span> <span class="ow">in</span> <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">programs</span><span class="p">():</span>
                <span class="n">existing_program_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prg</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">set_constant_values_prg</span><span class="o">.</span><span class="n">nameString</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_program_names</span><span class="p">:</span>
                <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">set_constant_values_prg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initialize_constant_parameters_after_warmup</span> <span class="o">=</span> \
                <span class="n">openstudio_model</span><span class="o">.</span><span class="n">EnergyManagementSystemProgramCallingManager</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                <span class="s1">&#39;Initialize_Constant_Parameters_After_Warmup&#39;</span><span class="p">)</span>
            <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">setCallingPoint</span><span class="p">(</span>
                <span class="s1">&#39;AfterNewEnvironmentWarmUpIsComplete&#39;</span><span class="p">)</span>
            <span class="n">initialize_constant_parameters_after_warmup</span><span class="o">.</span><span class="n">addProgram</span><span class="p">(</span><span class="n">set_constant_values_prg</span><span class="p">)</span></div>



<div class="viewcode-block" id="model_get_or_add_chilled_water_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_chilled_water_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="s1">&#39;WaterCooled&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get existing chilled water loop or add a new one if there isn&#39;t one already.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        cool_fuel: [String] the cooling fuel. Valid choices are Electricity,</span>
<span class="sd">            DistrictCooling, and HeatPump.</span>
<span class="sd">        chilled_water_loop_cooling_type: [String] Archetype for chilled water</span>
<span class="sd">            loops, AirCooled or WaterCooled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># retrieve the existing chilled water loop or add a new one if necessary</span>
    <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Chilled Water Loop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Chilled Water Loop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_add_chw_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chw_pumping_type</span><span class="o">=</span><span class="s1">&#39;const_pri&#39;</span><span class="p">,</span> <span class="n">cooling_fuel</span><span class="o">=</span><span class="n">cool_fuel</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;HeatPump&#39;</span><span class="p">:</span>
            <span class="n">condenser_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_ambient_water_loop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_add_chw_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">chw_pumping_type</span><span class="o">=</span><span class="s1">&#39;const_pri_var_sec&#39;</span><span class="p">,</span>
                <span class="n">chiller_cooling_type</span><span class="o">=</span><span class="s1">&#39;WaterCooled&#39;</span><span class="p">,</span>
                <span class="n">chiller_compressor_type</span><span class="o">=</span><span class="s1">&#39;Rotary Screw&#39;</span><span class="p">,</span>
                <span class="n">condenser_water_loop</span><span class="o">=</span><span class="n">condenser_water_loop</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chilled_water_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;AirCooled&#39;</span><span class="p">:</span>
                <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_add_chw_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">chw_pumping_type</span><span class="o">=</span><span class="s1">&#39;const_pri&#39;</span><span class="p">,</span>
                    <span class="n">chiller_cooling_type</span><span class="o">=</span><span class="s1">&#39;AirCooled&#39;</span><span class="p">,</span> <span class="n">cooling_fuel</span><span class="o">=</span><span class="n">cool_fuel</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fan_type</span> <span class="o">=</span> <span class="s1">&#39;Variable Speed Fan&#39;</span>
                <span class="n">condenser_water_loop</span> <span class="o">=</span> <span class="n">model_add_cw_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">cooling_tower_type</span><span class="o">=</span><span class="s1">&#39;Open Cooling Tower&#39;</span><span class="p">,</span>
                    <span class="n">cooling_tower_fan_type</span><span class="o">=</span><span class="s1">&#39;Propeller or Axial&#39;</span><span class="p">,</span>
                    <span class="n">cooling_tower_capacity_control</span><span class="o">=</span><span class="n">fan_type</span><span class="p">,</span>
                    <span class="n">number_of_cells_per_tower</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_cooling_towers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_add_chw_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">chw_pumping_type</span><span class="o">=</span><span class="s1">&#39;const_pri_var_sec&#39;</span><span class="p">,</span>
                    <span class="n">chiller_cooling_type</span><span class="o">=</span><span class="s1">&#39;WaterCooled&#39;</span><span class="p">,</span>
                    <span class="n">chiller_compressor_type</span><span class="o">=</span><span class="s1">&#39;Rotary Screw&#39;</span><span class="p">,</span>
                    <span class="n">condenser_water_loop</span><span class="o">=</span><span class="n">condenser_water_loop</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No cool_fuel specified.&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">chilled_water_loop</span></div>



<div class="viewcode-block" id="model_get_or_add_hot_water_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_hot_water_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_get_or_add_hot_water_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;HighTemperature&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get existing hot water loop or add a new one if there isn&#39;t one already.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        heat_fuel: [String] the heating fuel. Valid choices are NaturalGas,</span>
<span class="sd">            Electricity, DistrictHeating, DistrictHeatingWater, DistrictHeatingSteam.</span>
<span class="sd">        hot_water_loop_type: [String] Archetype for hot water loops.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">heat_fuel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Hot water loop fuel type is None. Cannot add hot water loop.&#39;</span><span class="p">)</span>

    <span class="n">make_new_hot_water_loop</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># retrieve the existing hot water loop or add a new one if not of the correct type</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Hot Water Loop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Hot Water Loop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">design_loop_exit_temperature</span> <span class="o">=</span> \
            <span class="n">hot_water_loop</span><span class="o">.</span><span class="n">sizingPlant</span><span class="p">()</span><span class="o">.</span><span class="n">designLoopExitTemperature</span><span class="p">()</span>
        <span class="n">design_loop_exit_temperature</span> <span class="o">=</span> \
            <span class="n">TEMPERATURE</span><span class="o">.</span><span class="n">to_unit</span><span class="p">([</span><span class="n">design_loop_exit_temperature</span><span class="p">],</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># check that the loop is the correct archetype</span>
        <span class="k">if</span> <span class="n">hot_water_loop_type</span> <span class="o">==</span> <span class="s1">&#39;HighTemperature&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">design_loop_exit_temperature</span> <span class="o">&gt;</span> <span class="mf">130.0</span><span class="p">:</span>
                <span class="n">make_new_hot_water_loop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">hot_water_loop_type</span> <span class="o">==</span> <span class="s1">&#39;LowTemperature&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">design_loop_exit_temperature</span> <span class="o">&lt;=</span> <span class="mf">130.0</span><span class="p">:</span>
                <span class="n">make_new_hot_water_loop</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">make_new_hot_water_loop</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hot_water_loop_type</span> <span class="o">==</span> <span class="s1">&#39;HighTemperature&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_add_hw_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">heat_fuel</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">hot_water_loop_type</span> <span class="o">==</span> <span class="s1">&#39;LowTemperature&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_add_hw_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">heat_fuel</span><span class="p">,</span> <span class="n">dsgn_sup_wtr_temp</span><span class="o">=</span><span class="mf">120.0</span><span class="p">,</span>
                <span class="n">boiler_draft_type</span><span class="o">=</span><span class="s1">&#39;Condensing&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Hot water loop archetype </span><span class="si">{}</span><span class="s1"> not recognized.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hot_water_loop</span></div>



<div class="viewcode-block" id="model_get_or_add_ambient_water_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_ambient_water_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_get_or_add_ambient_water_loop</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the existing ambient water loop or add a new one if there isn&#39;t one already.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># retrieve the existing hot water loop or add a new one if necessary</span>
    <span class="n">exist_loop</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Ambient Loop&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exist_loop</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">ambient_water_loop</span> <span class="o">=</span> <span class="n">exist_loop</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ambient_water_loop</span> <span class="o">=</span> <span class="n">model_add_district_ambient_loop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ambient_water_loop</span></div>



<div class="viewcode-block" id="model_get_or_add_ground_hx_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_ground_hx_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_get_or_add_ground_hx_loop</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the existing ground heat exchanger loop or add a new one if there isn&#39;t one.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># retrieve the existing ground HX loop or add a new one if necessary</span>
    <span class="n">exist_loop</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Ground HX Loop&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exist_loop</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">ground_hx_loop</span> <span class="o">=</span> <span class="n">exist_loop</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ground_hx_loop</span> <span class="o">=</span> <span class="n">model_add_ground_hx_loop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ground_hx_loop</span></div>



<div class="viewcode-block" id="model_get_or_add_heat_pump_loop">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_get_or_add_heat_pump_loop">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_get_or_add_heat_pump_loop</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
        <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="s1">&#39;EvaporativeFluidCooler&#39;</span><span class="p">):</span>
    <span class="c1"># retrieve the existing heat pump loop or add a new one if necessary</span>
    <span class="n">exist_loop</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getPlantLoopByName</span><span class="p">(</span><span class="s1">&#39;Heat Pump Loop&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exist_loop</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
        <span class="n">heat_pump_loop</span> <span class="o">=</span> <span class="n">exist_loop</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">heat_pump_loop</span> <span class="o">=</span> <span class="n">model_add_hp_loop</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">heating_fuel</span><span class="o">=</span><span class="n">heat_fuel</span><span class="p">,</span> <span class="n">cooling_fuel</span><span class="o">=</span><span class="n">cool_fuel</span><span class="p">,</span>
            <span class="n">cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">heat_pump_loop</span></div>



<div class="viewcode-block" id="model_add_hvac_system">
<a class="viewcode-back" href="../../../../honeybee_openstudio.hvac.standards.hvac_systems.html#honeybee_openstudio.hvac.standards.hvac_systems.model_add_hvac_system">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">model_add_hvac_system</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">system_type</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
        <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;HighTemperature&#39;</span><span class="p">,</span>
        <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="s1">&#39;WaterCooled&#39;</span><span class="p">,</span>
        <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="s1">&#39;EvaporativeFluidCooler&#39;</span><span class="p">,</span>
        <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span>
        <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="s1">&#39;CyclingFan&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add the a system type to the zones based on the specified template.</span>

<span class="sd">    For multi-zone system types, add one system per story.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: [OpenStudio::Model::Model] OpenStudio model object.</span>
<span class="sd">        system_type: [String] The system type.</span>
<span class="sd">        main_heat_fuel: [String] Main heating fuel used for air loops and plant loops.</span>
<span class="sd">        zone_heat_fuel: [String] Zone heating fuel for zone hvac equipment and</span>
<span class="sd">            terminal units.</span>
<span class="sd">        cool_fuel: [String] Cooling fuel used for air loops, plant loops, and</span>
<span class="sd">            zone equipment.</span>
<span class="sd">        zones: [Array&lt;OpenStudio::Model::ThermalZone&gt;] array of thermal zones</span>
<span class="sd">            served by the system.</span>
<span class="sd">        hot_water_loop_type: [String] Archetype for hot water loops. Either</span>
<span class="sd">            HighTemperature (180F supply) (default) or LowTemperature (120F supply).</span>
<span class="sd">            Only used if HVAC system has a hot water loop.</span>
<span class="sd">        chilled_water_loop_cooling_type [String] Archetype for chilled water loops.</span>
<span class="sd">            Only used if HVAC system has a chilled water loop and cool_fuel</span>
<span class="sd">            is Electricity. Options are.</span>

<span class="sd">            * AirCooled</span>
<span class="sd">            * WaterCooled</span>

<span class="sd">        heat_pump_loop_cooling_type: [String] the type of cooling equipment for</span>
<span class="sd">            heat pump loops if not DistrictCooling. Valid options are.</span>

<span class="sd">            * CoolingTower</span>
<span class="sd">            * CoolingTowerSingleSpeed</span>
<span class="sd">            * CoolingTowerTwoSpeed</span>
<span class="sd">            * CoolingTowerVariableSpeed</span>
<span class="sd">            * FluidCooler</span>
<span class="sd">            * FluidCoolerSingleSpeed</span>
<span class="sd">            * FluidCoolerTwoSpeed</span>
<span class="sd">            * EvaporativeFluidCooler</span>
<span class="sd">            * EvaporativeFluidCoolerSingleSpeed</span>
<span class="sd">            * EvaporativeFluidCoolerTwoSpeed</span>

<span class="sd">        air_loop_heating_type: [String] type of heating coil serving main air loop.</span>
<span class="sd">            Options are.</span>

<span class="sd">            * Gas</span>
<span class="sd">            * DX</span>
<span class="sd">            * Water</span>

<span class="sd">        air_loop_cooling_type: [String] type of cooling coil serving main air loop.</span>
<span class="sd">            Options are.</span>

<span class="sd">            * DX</span>
<span class="sd">            * Water</span>

<span class="sd">        zone_equipment_ventilation: [Boolean] toggle whether to include outdoor air</span>
<span class="sd">            ventilation on zone equipment including as fan coil units, VRF terminals,</span>
<span class="sd">            or water source heat pumps.</span>
<span class="sd">        fan_coil_capacity_control_method: [String] Only applicable to Fan Coil</span>
<span class="sd">            system type. Capacity control method for the fan coil. If VariableFan,</span>
<span class="sd">            the fan will be VariableVolume. Options are.</span>

<span class="sd">            * ConstantFanVariableFlow</span>
<span class="sd">            * CyclingFan</span>
<span class="sd">            * VariableFanVariableFlow</span>
<span class="sd">            * VariableFanConstantFlow.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Returns True if successful, False if not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># enforce defaults if fields are None</span>
    <span class="k">if</span> <span class="n">hot_water_loop_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hot_water_loop_type</span> <span class="o">=</span> <span class="s1">&#39;HighTemperature&#39;</span>
    <span class="k">if</span> <span class="n">chilled_water_loop_cooling_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">chilled_water_loop_cooling_type</span> <span class="o">=</span> <span class="s1">&#39;WaterCooled&#39;</span>
    <span class="k">if</span> <span class="n">heat_pump_loop_cooling_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">heat_pump_loop_cooling_type</span> <span class="o">=</span> <span class="s1">&#39;EvaporativeFluidCooler&#39;</span>
    <span class="k">if</span> <span class="n">air_loop_heating_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">air_loop_heating_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
    <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">air_loop_cooling_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
    <span class="k">if</span> <span class="n">zone_equipment_ventilation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zone_equipment_ventilation</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">fan_coil_capacity_control_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fan_coil_capacity_control_method</span> <span class="o">=</span> <span class="s1">&#39;CyclingFan&#39;</span>

    <span class="c1"># don&#39;t do anything if there are no zones</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zones</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># add the different types of systems</span>
    <span class="n">air_loop</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PTAC&#39;</span><span class="p">:</span>
        <span class="n">water_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="n">water_types</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">zone_heat_fuel</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">model_add_ptac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;Single Speed DX AC&#39;</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">heating_type</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;Cycling&#39;</span><span class="p">,</span>
            <span class="n">ventilation</span><span class="o">=</span><span class="n">zone_equipment_ventilation</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PTHP&#39;</span><span class="p">:</span>
        <span class="n">model_add_pthp</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;Cycling&#39;</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="n">zone_equipment_ventilation</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PSZ-AC&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">supplemental_heating_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
            <span class="k">if</span> <span class="n">air_loop_heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
                <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">):</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
            <span class="n">supplemental_heating_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">,</span> <span class="s1">&#39;ASHP&#39;</span><span class="p">):</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
            <span class="n">supplemental_heating_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">supplemental_heating_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">zone_heat_fuel</span>
            <span class="n">supplemental_heating_type</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">)</span>
            <span class="n">cooling_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">cooling_type</span> <span class="o">=</span> <span class="s1">&#39;Single Speed DX AC&#39;</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_psz_ac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">cooling_type</span><span class="o">=</span><span class="n">cooling_type</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">heating_type</span><span class="p">,</span>
            <span class="n">supplemental_heating_type</span><span class="o">=</span><span class="n">supplemental_heating_type</span><span class="p">,</span>
            <span class="n">fan_location</span><span class="o">=</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">,</span> <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;ConstantVolume&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PSZ-HP&#39;</span><span class="p">:</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_psz_ac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;PSZ-HP&#39;</span><span class="p">,</span> <span class="n">cooling_type</span><span class="o">=</span><span class="s1">&#39;Single Speed Heat Pump&#39;</span><span class="p">,</span>
            <span class="n">heating_type</span><span class="o">=</span><span class="s1">&#39;Single Speed Heat Pump&#39;</span><span class="p">,</span> <span class="n">supplemental_heating_type</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span>
            <span class="n">fan_location</span><span class="o">=</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">,</span> <span class="n">fan_type</span><span class="o">=</span><span class="s1">&#39;ConstantVolume&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PSZ-VAV&#39;</span><span class="p">:</span>
        <span class="n">supplemental_heating_type</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;Electricity&#39;</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_psz_vav</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">system_name</span><span class="o">=</span><span class="s1">&#39;PSZ-VAV&#39;</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">main_heat_fuel</span><span class="p">,</span>
            <span class="n">supplemental_heating_type</span><span class="o">=</span><span class="n">supplemental_heating_type</span><span class="p">,</span>
            <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oa_damper_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;VRF&#39;</span><span class="p">:</span>
        <span class="n">model_add_vrf</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="n">zone_equipment_ventilation</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Fan Coil&#39;</span><span class="p">:</span>
        <span class="n">water_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="n">water_types</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">cool_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">):</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">model_add_four_pipe_fan_coil</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span>
            <span class="n">ventilation</span><span class="o">=</span><span class="n">zone_equipment_ventilation</span><span class="p">,</span>
            <span class="n">capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Radiant Slab&#39;</span><span class="p">:</span>
        <span class="n">water_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="n">water_types</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">cool_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">):</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">model_add_low_temp_radiant</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Baseboards&#39;</span><span class="p">:</span>
        <span class="n">water_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="n">water_types</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Baseboards must have heating_type specified.&#39;</span><span class="p">)</span>
        <span class="n">model_add_baseboard</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Unit Heaters&#39;</span><span class="p">:</span>
        <span class="n">model_add_unitheater</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">hvac_op_sch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fan_control_type</span><span class="o">=</span><span class="s1">&#39;ConstantVolume&#39;</span><span class="p">,</span>
            <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">main_heat_fuel</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;High Temp Radiant&#39;</span><span class="p">:</span>
        <span class="n">model_add_high_temp_radiant</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">combustion_efficiency</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Window AC&#39;</span><span class="p">:</span>
        <span class="n">model_add_window_ac</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential AC&#39;</span><span class="p">:</span>
        <span class="n">model_add_furnace_central_ac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Forced Air Furnace&#39;</span><span class="p">:</span>
        <span class="n">model_add_furnace_central_ac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">heating_type</span><span class="o">=</span><span class="n">main_heat_fuel</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential Forced Air Furnace&#39;</span><span class="p">:</span>
        <span class="n">model_add_furnace_central_ac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential Forced Air Furnace with AC&#39;</span><span class="p">:</span>
        <span class="n">model_add_furnace_central_ac</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential Air Source Heat Pump&#39;</span><span class="p">:</span>
        <span class="n">heating</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">cooling</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">cool_fuel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">model_add_central_air_source_heat_pump</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating</span><span class="o">=</span><span class="n">heating</span><span class="p">,</span> <span class="n">cooling</span><span class="o">=</span><span class="n">cooling</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential Minisplit Heat Pumps&#39;</span><span class="p">:</span>
        <span class="n">model_add_minisplit_hp</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;VAV Reheat&#39;</span><span class="p">:</span>
        <span class="n">water_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;HeatPump&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="n">water_types</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">hot_water_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">zone_heat_fuel</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">):</span>
                <span class="n">reheat_type</span> <span class="o">=</span> <span class="s1">&#39;NaturalGas&#39;</span>
            <span class="k">elif</span> <span class="n">zone_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
                <span class="n">reheat_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;zone_heat_fuel &quot;</span><span class="si">{}</span><span class="s1">&quot; is not supported with main_heat_fuel &quot;</span><span class="si">{}</span><span class="s1">&quot; &#39;</span> \
                    <span class="s1">&#39;for a &quot;VAV Reheat&quot; system type.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                       <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reheat_type</span> <span class="o">=</span> <span class="s1">&#39;Water&#39;</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_vav_reheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">heating_type</span><span class="p">,</span> <span class="n">reheat_type</span><span class="o">=</span><span class="n">reheat_type</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;VAV No Reheat&#39;</span><span class="p">:</span>
        <span class="n">water_types</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;HeatPump&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;DistrictHeatingWater&#39;</span><span class="p">,</span> <span class="s1">&#39;DistrictHeatingSteam&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">in</span> <span class="n">water_types</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">heating_type</span> <span class="o">=</span> <span class="s1">&#39;Electricity&#39;</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_vav_reheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="n">heating_type</span><span class="p">,</span> <span class="n">reheat_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;VAV Gas Reheat&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_vav_reheat</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">heating_type</span><span class="o">=</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span> <span class="n">reheat_type</span><span class="o">=</span><span class="s1">&#39;NaturalGas&#39;</span><span class="p">,</span>
            <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span> <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span>
            <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PVAV Reheat&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">air_loop_heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">heating_type</span> <span class="o">=</span> <span class="n">main_heat_fuel</span>

        <span class="k">if</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>

        <span class="n">electric_reheat</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">zone_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_pvav</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">heating_type</span><span class="o">=</span><span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">electric_reheat</span><span class="o">=</span><span class="n">electric_reheat</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;PVAV PFP Boxes&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_pvav_pfp_boxes</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;VAV PFP Boxes&#39;</span><span class="p">:</span>
        <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
            <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_vav_pfp_boxes</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">fan_efficiency</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">fan_motor_efficiency</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">fan_pressure_rise</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Water Source Heat Pumps&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;DistrictHeating&#39;</span> <span class="ow">in</span> <span class="n">main_heat_fuel</span> <span class="ow">and</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;DistrictCooling&#39;</span><span class="p">)</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AmbientLoop&#39;</span> <span class="ow">and</span> <span class="n">cool_fuel</span> <span class="o">==</span> <span class="s1">&#39;AmbientLoop&#39;</span><span class="p">):</span>
            <span class="n">condenser_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_ambient_water_loop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condenser_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_heat_pump_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">)</span>

        <span class="n">model_add_water_source_hp</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">condenser_loop</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="n">zone_equipment_ventilation</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Ground Source Heat Pumps&#39;</span><span class="p">:</span>
        <span class="n">condenser_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_ground_hx_loop</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">model_add_water_source_hp</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">condenser_loop</span><span class="p">,</span> <span class="n">ventilation</span><span class="o">=</span><span class="n">zone_equipment_ventilation</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;DOAS Cold Supply&#39;</span><span class="p">:</span>
        <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
            <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_doas_cold_supply</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;DOAS&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">air_loop_heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;air_loop_heating_type &quot;</span><span class="si">{}</span><span class="s1">&quot; is not supported with main_heat_fuel &#39;</span> \
                    <span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; for a &quot;DOAS&quot; system type.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">air_loop_heating_type</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_doas</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span> <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span>
            <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;DOAS with DCV&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">air_loop_heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_doas</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">doas_type</span><span class="o">=</span><span class="s1">&#39;DOASVAV&#39;</span><span class="p">,</span> <span class="n">demand_control_ventilation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;DOAS with Economizing&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">air_loop_heating_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">main_heat_fuel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">main_heat_fuel</span> <span class="o">==</span> <span class="s1">&#39;AirSourceHeatPump&#39;</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="s1">&#39;LowTemperature&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_hot_water_loop</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hot_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">air_loop_cooling_type</span> <span class="o">==</span> <span class="s1">&#39;Water&#39;</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="n">model_get_or_add_chilled_water_loop</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chilled_water_loop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_doas</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
            <span class="n">hot_water_loop</span><span class="o">=</span><span class="n">hot_water_loop</span><span class="p">,</span> <span class="n">chilled_water_loop</span><span class="o">=</span><span class="n">chilled_water_loop</span><span class="p">,</span>
            <span class="n">doas_type</span><span class="o">=</span><span class="s1">&#39;DOASVAV&#39;</span><span class="p">,</span> <span class="n">econo_ctrl_mthd</span><span class="o">=</span><span class="s1">&#39;FixedDryBulb&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;ERVs&#39;</span><span class="p">:</span>
        <span class="n">model_add_zone_erv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential ERVs&#39;</span><span class="p">:</span>
        <span class="n">model_add_residential_erv</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Residential Ventilators&#39;</span><span class="p">:</span>
        <span class="n">model_add_residential_ventilator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">system_type</span> <span class="o">==</span> <span class="s1">&#39;Evaporative Cooler&#39;</span><span class="p">:</span>
        <span class="n">model_add_evap_cooler</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zones</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Combination Systems</span>
        <span class="k">if</span> <span class="s1">&#39;with DOAS with DCV&#39;</span> <span class="ow">in</span> <span class="n">system_type</span><span class="p">:</span>
            <span class="c1"># add DOAS DCV system</span>
            <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_hvac_system</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;DOAS with DCV&#39;</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
                <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">,</span>
                <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="n">air_loop_heating_type</span><span class="p">,</span>
                <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="n">air_loop_cooling_type</span><span class="p">,</span>
                <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>
            <span class="c1"># add paired system type</span>
            <span class="n">paired_system_type</span> <span class="o">=</span> <span class="n">system_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; with DOAS with DCV&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">model_add_hvac_system</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">paired_system_type</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
                <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">,</span>
                <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="n">air_loop_heating_type</span><span class="p">,</span>
                <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="n">air_loop_cooling_type</span><span class="p">,</span>
                <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;with DOAS&#39;</span> <span class="ow">in</span> <span class="n">system_type</span><span class="p">:</span>
            <span class="c1"># add DOAS system</span>
            <span class="n">air_loop</span> <span class="o">=</span> <span class="n">model_add_hvac_system</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;DOAS&#39;</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
                <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">,</span>
                <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="n">air_loop_heating_type</span><span class="p">,</span>
                <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="n">air_loop_cooling_type</span><span class="p">,</span>
                <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>
            <span class="c1"># add paired system type</span>
            <span class="n">paired_system_type</span> <span class="o">=</span> <span class="n">system_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; with DOAS&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">model_add_hvac_system</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">paired_system_type</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
                <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">,</span>
                <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="n">air_loop_heating_type</span><span class="p">,</span>
                <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="n">air_loop_cooling_type</span><span class="p">,</span>
                <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;with ERVs&#39;</span> <span class="ow">in</span> <span class="n">system_type</span><span class="p">:</span>
            <span class="c1"># add DOAS system</span>
            <span class="n">model_add_hvac_system</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;ERVs&#39;</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
                <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">,</span>
                <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="n">air_loop_heating_type</span><span class="p">,</span>
                <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="n">air_loop_cooling_type</span><span class="p">,</span>
                <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>
            <span class="c1"># add paired system type</span>
            <span class="n">paired_system_type</span> <span class="o">=</span> <span class="n">system_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; with ERVs&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">model_add_hvac_system</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="n">paired_system_type</span><span class="p">,</span> <span class="n">main_heat_fuel</span><span class="p">,</span> <span class="n">zone_heat_fuel</span><span class="p">,</span> <span class="n">cool_fuel</span><span class="p">,</span> <span class="n">zones</span><span class="p">,</span>
                <span class="n">hot_water_loop_type</span><span class="o">=</span><span class="n">hot_water_loop_type</span><span class="p">,</span>
                <span class="n">chilled_water_loop_cooling_type</span><span class="o">=</span><span class="n">chilled_water_loop_cooling_type</span><span class="p">,</span>
                <span class="n">heat_pump_loop_cooling_type</span><span class="o">=</span><span class="n">heat_pump_loop_cooling_type</span><span class="p">,</span>
                <span class="n">air_loop_heating_type</span><span class="o">=</span><span class="n">air_loop_heating_type</span><span class="p">,</span>
                <span class="n">air_loop_cooling_type</span><span class="o">=</span><span class="n">air_loop_cooling_type</span><span class="p">,</span>
                <span class="n">zone_equipment_ventilation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">fan_coil_capacity_control_method</span><span class="o">=</span><span class="n">fan_coil_capacity_control_method</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;HVAC system type &quot;</span><span class="si">{}</span><span class="s1">&quot; not recognized&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">system_type</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">air_loop</span></div>

</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2025, Ladybug Tools.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.0.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>